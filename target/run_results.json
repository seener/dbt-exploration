{"results": [{"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_accepted_values(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "accepted_values", "kwargs": {"values": ["English", "Italian", "Japanese", "Mandarin", "French", "German"], "column_name": "language", "model": "{{ ref('customer_profile') }}"}}, "database": "dvd_rental", "schema": "dev", "fqn": ["dbt_play", "schema_test", "accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German"], "unique_id": "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German", "package_name": "dbt_play", "root_path": "/Users/sean/Projects/dbt_play", "path": "schema_test/accepted_values_customer_profile_0dc01593316e4746b1e419f6783ac6a5.sql", "original_file_path": "models/schema.yml", "name": "accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German", "resource_type": "test", "alias": "accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["customer_profile"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values"], "nodes": ["model.dbt_play.customer_profile"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/dbt_play/models/schema.yml/schema_test/accepted_values_customer_profile_0dc01593316e4746b1e419f6783ac6a5.sql", "compiled": true, "compiled_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        language as value_field\n\n    from \"dvd_rental\".\"dev\".\"customer_profile\"\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'English','Italian','Japanese','Mandarin','French','German'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        language as value_field\n\n    from \"dvd_rental\".\"dev\".\"customer_profile\"\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'English','Italian','Japanese','Mandarin','French','German'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "column_name": "language"}, "error": null, "status": 0.0, "execution_time": 0.06545400619506836, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-08-12T20:30:45.914849Z", "completed_at": "2020-08-12T20:30:45.964531Z"}, {"name": "execute", "started_at": "2020-08-12T20:30:45.965266Z", "completed_at": "2020-08-12T20:30:45.978292Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_accepted_values(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "accepted_values", "kwargs": {"values": ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"], "column_name": "last_initial", "model": "{{ ref('customer_profile') }}"}}, "database": "dvd_rental", "schema": "dev", "fqn": ["dbt_play", "schema_test", "accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z"], "unique_id": "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z", "package_name": "dbt_play", "root_path": "/Users/sean/Projects/dbt_play", "path": "schema_test/accepted_values_customer_profile_8e3627ed04f8bcacd0fa7e5231e981ea.sql", "original_file_path": "models/schema.yml", "name": "accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z", "resource_type": "test", "alias": "accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["customer_profile"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_accepted_values"], "nodes": ["model.dbt_play.customer_profile"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/dbt_play/models/schema.yml/schema_test/accepted_values_customer_profile_8e3627ed04f8bcacd0fa7e5231e981ea.sql", "compiled": true, "compiled_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        last_initial as value_field\n\n    from \"dvd_rental\".\"dev\".\"customer_profile\"\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\n\nwith all_values as (\n\n    select distinct\n        last_initial as value_field\n\n    from \"dvd_rental\".\"dev\".\"customer_profile\"\n\n),\n\nvalidation_errors as (\n\n    select\n        value_field\n\n    from all_values\n    where value_field not in (\n        'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'\n    )\n)\n\nselect count(*) as validation_errors\nfrom validation_errors\n\n", "column_name": "last_initial"}, "error": null, "status": 0.0, "execution_time": 0.05560708045959473, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-08-12T20:30:45.981654Z", "completed_at": "2020-08-12T20:30:46.020634Z"}, {"name": "execute", "started_at": "2020-08-12T20:30:46.021127Z", "completed_at": "2020-08-12T20:30:46.035206Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "active", "model": "{{ ref('customer_profile') }}"}}, "database": "dvd_rental", "schema": "dev", "fqn": ["dbt_play", "schema_test", "not_null_customer_profile_active"], "unique_id": "test.dbt_play.not_null_customer_profile_active", "package_name": "dbt_play", "root_path": "/Users/sean/Projects/dbt_play", "path": "schema_test/not_null_customer_profile_active.sql", "original_file_path": "models/schema.yml", "name": "not_null_customer_profile_active", "resource_type": "test", "alias": "not_null_customer_profile_active", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["customer_profile"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.dbt_play.customer_profile"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/dbt_play/models/schema.yml/schema_test/not_null_customer_profile_active.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"dvd_rental\".\"dev\".\"customer_profile\"\nwhere active is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"dvd_rental\".\"dev\".\"customer_profile\"\nwhere active is null\n\n", "column_name": "active"}, "error": null, "status": 0.0, "execution_time": 0.03005695343017578, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-08-12T20:30:46.038010Z", "completed_at": "2020-08-12T20:30:46.052715Z"}, {"name": "execute", "started_at": "2020-08-12T20:30:46.053388Z", "completed_at": "2020-08-12T20:30:46.065798Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_not_null(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "not_null", "kwargs": {"column_name": "customer_id", "model": "{{ ref('customer_profile') }}"}}, "database": "dvd_rental", "schema": "dev", "fqn": ["dbt_play", "schema_test", "not_null_customer_profile_customer_id"], "unique_id": "test.dbt_play.not_null_customer_profile_customer_id", "package_name": "dbt_play", "root_path": "/Users/sean/Projects/dbt_play", "path": "schema_test/not_null_customer_profile_customer_id.sql", "original_file_path": "models/schema.yml", "name": "not_null_customer_profile_customer_id", "resource_type": "test", "alias": "not_null_customer_profile_customer_id", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["customer_profile"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_not_null"], "nodes": ["model.dbt_play.customer_profile"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/dbt_play/models/schema.yml/schema_test/not_null_customer_profile_customer_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"dvd_rental\".\"dev\".\"customer_profile\"\nwhere customer_id is null\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom \"dvd_rental\".\"dev\".\"customer_profile\"\nwhere customer_id is null\n\n", "column_name": "customer_id"}, "error": null, "status": 0.0, "execution_time": 0.02757096290588379, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-08-12T20:30:46.069471Z", "completed_at": "2020-08-12T20:30:46.081371Z"}, {"name": "execute", "started_at": "2020-08-12T20:30:46.081771Z", "completed_at": "2020-08-12T20:30:46.095372Z"}], "fail": null, "warn": null, "skip": false}, {"node": {"raw_sql": "{{ config(severity='ERROR') }}{{ test_unique(**_dbt_schema_test_kwargs) }}", "test_metadata": {"namespace": null, "name": "unique", "kwargs": {"column_name": "customer_id", "model": "{{ ref('customer_profile') }}"}}, "database": "dvd_rental", "schema": "dev", "fqn": ["dbt_play", "schema_test", "unique_customer_profile_customer_id"], "unique_id": "test.dbt_play.unique_customer_profile_customer_id", "package_name": "dbt_play", "root_path": "/Users/sean/Projects/dbt_play", "path": "schema_test/unique_customer_profile_customer_id.sql", "original_file_path": "models/schema.yml", "name": "unique_customer_profile_customer_id", "resource_type": "test", "alias": "unique_customer_profile_customer_id", "config": {"enabled": true, "materialized": "table", "persist_docs": {}, "post-hook": [], "pre-hook": [], "vars": {}, "quoting": {}, "column_types": {}, "tags": [], "severity": "ERROR"}, "tags": ["schema"], "refs": [["customer_profile"]], "sources": [], "depends_on": {"macros": ["macro.dbt.test_unique"], "nodes": ["model.dbt_play.customer_profile"]}, "description": "", "columns": {}, "meta": {}, "docs": {"show": true}, "patch_path": null, "build_path": "target/compiled/dbt_play/models/schema.yml/schema_test/unique_customer_profile_customer_id.sql", "compiled": true, "compiled_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        customer_id\n\n    from \"dvd_rental\".\"dev\".\"customer_profile\"\n    where customer_id is not null\n    group by customer_id\n    having count(*) > 1\n\n) validation_errors\n\n", "extra_ctes_injected": true, "extra_ctes": [], "injected_sql": "\n\n\n\nselect count(*) as validation_errors\nfrom (\n\n    select\n        customer_id\n\n    from \"dvd_rental\".\"dev\".\"customer_profile\"\n    where customer_id is not null\n    group by customer_id\n    having count(*) > 1\n\n) validation_errors\n\n", "column_name": "customer_id"}, "error": null, "status": 0.0, "execution_time": 0.03401589393615723, "thread_id": "Thread-1", "timing": [{"name": "compile", "started_at": "2020-08-12T20:30:46.098345Z", "completed_at": "2020-08-12T20:30:46.113717Z"}, {"name": "execute", "started_at": "2020-08-12T20:30:46.114087Z", "completed_at": "2020-08-12T20:30:46.129391Z"}], "fail": null, "warn": null, "skip": false}], "generated_at": "2020-08-12T20:30:46.231566Z", "elapsed_time": 1.0903499126434326}