2020-08-12 18:34:12.352629 (MainThread): Running with dbt=0.17.2
2020-08-12 18:34:12.463215 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 18:34:12.465735 (MainThread): Tracking: tracking
2020-08-12 18:34:12.488869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1fb857d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1fc22e90>]}
2020-08-12 18:34:12.529901 (MainThread): Partial parsing not enabled
2020-08-12 18:34:12.533301 (MainThread): Parsing macros/core.sql
2020-08-12 18:34:12.542891 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 18:34:12.559153 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 18:34:12.562374 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 18:34:12.586850 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 18:34:12.629854 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 18:34:12.661273 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 18:34:12.664789 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 18:34:12.674619 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 18:34:12.695553 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 18:34:12.705768 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 18:34:12.715486 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 18:34:12.723676 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 18:34:12.725419 (MainThread): Parsing macros/etc/query.sql
2020-08-12 18:34:12.727805 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 18:34:12.730849 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 18:34:12.744983 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 18:34:12.748219 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 18:34:12.750907 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 18:34:12.827674 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 18:34:12.829988 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 18:34:12.831881 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 18:34:12.833628 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 18:34:12.836900 (MainThread): Parsing macros/catalog.sql
2020-08-12 18:34:12.840834 (MainThread): Parsing macros/relations.sql
2020-08-12 18:34:12.844045 (MainThread): Parsing macros/adapters.sql
2020-08-12 18:34:12.883349 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 18:34:12.913327 (MainThread): Partial parsing not enabled
2020-08-12 18:34:12.959137 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:34:12.959321 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:34:12.995845 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 18:34:12.996023 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:34:13.010140 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:34:13.010359 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:34:13.023028 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:34:13.023212 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:34:13.170907 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 18:34:13.171932 (MainThread): 
2020-08-12 18:34:13.172695 (MainThread): Acquiring new postgres connection "master".
2020-08-12 18:34:13.172863 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:34:13.183380 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 18:34:13.184462 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 18:34:13.210019 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 18:34:13.210441 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 18:34:13.224911 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.01 seconds
2020-08-12 18:34:13.230599 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 18:34:13.236905 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 18:34:13.237152 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 18:34:13.244060 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 18:34:13.244380 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 18:34:13.253471 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 18:34:13.253713 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 18:34:13.253830 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 18:34:13.259585 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2020-08-12 18:34:13.260021 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 18:34:13.260321 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 18:34:13.270589 (MainThread): Using postgres connection "master".
2020-08-12 18:34:13.270767 (MainThread): On master: BEGIN
2020-08-12 18:34:13.280590 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 18:34:13.280770 (MainThread): Using postgres connection "master".
2020-08-12 18:34:13.280868 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 18:34:13.641342 (MainThread): SQL status: SELECT 37 in 0.36 seconds
2020-08-12 18:34:13.692922 (MainThread): On master: ROLLBACK
2020-08-12 18:34:13.693395 (MainThread): Using postgres connection "master".
2020-08-12 18:34:13.693514 (MainThread): On master: BEGIN
2020-08-12 18:34:13.693840 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:34:13.693959 (MainThread): On master: COMMIT
2020-08-12 18:34:13.694063 (MainThread): Using postgres connection "master".
2020-08-12 18:34:13.694151 (MainThread): On master: COMMIT
2020-08-12 18:34:13.694372 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:34:13.694535 (MainThread): On master: Close
2020-08-12 18:34:13.694923 (MainThread): 14:34:13 | Concurrency: 1 threads (target='dev')
2020-08-12 18:34:13.695107 (MainThread): 14:34:13 | 
2020-08-12 18:34:13.698441 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 18:34:13.699823 (Thread-1): 14:34:13 | 1 of 4 START view model dev.customer................................. [RUN]
2020-08-12 18:34:13.700573 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 18:34:13.700895 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:34:13.701139 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 18:34:13.752841 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 18:34:13.754816 (Thread-1): finished collecting timing info
2020-08-12 18:34:13.813986 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:34:13.814172 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 18:34:13.825069 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 18:34:13.827939 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:34:13.828087 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 18:34:13.828509 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:34:13.834667 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 18:34:13.835455 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:34:13.835583 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 18:34:13.835997 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:34:13.836131 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:34:13.836231 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 18:34:13.872098 (Thread-1): SQL status: CREATE VIEW in 0.04 seconds
2020-08-12 18:34:13.880807 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:34:13.880999 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 18:34:13.882745 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:34:13.891354 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 18:34:13.891535 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:34:13.891633 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 18:34:13.893800 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:34:13.898165 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:34:13.898419 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 18:34:13.898779 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:34:13.901449 (Thread-1): finished collecting timing info
2020-08-12 18:34:13.901735 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 18:34:13.902338 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15d2ad68-5a53-4628-b0b7-83ed761e02cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa2040c450>]}
2020-08-12 18:34:13.903699 (Thread-1): 14:34:13 | 1 of 4 OK created view model dev.customer............................ [CREATE VIEW in 0.20s]
2020-08-12 18:34:13.903902 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 18:34:13.904173 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 18:34:13.905488 (Thread-1): 14:34:13 | 2 of 4 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 18:34:13.906164 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:34:13.906315 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:34:13.906517 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 18:34:13.915399 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 18:34:13.918364 (Thread-1): finished collecting timing info
2020-08-12 18:34:13.948441 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:34:13.948649 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 18:34:13.973614 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 18:34:13.983565 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:34:13.983755 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 18:34:13.984121 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:34:13.988046 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 18:34:13.988714 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:34:13.988951 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 18:34:13.989503 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:34:13.990051 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:34:13.990262 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 18:34:13.996250 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 18:34:13.999618 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:34:13.999804 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 18:34:14.000399 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:34:14.001597 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 18:34:14.001719 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:34:14.001812 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 18:34:14.008491 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 18:34:14.011193 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:34:14.011380 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 18:34:14.011765 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:34:14.018303 (Thread-1): finished collecting timing info
2020-08-12 18:34:14.018943 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 18:34:14.020695 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15d2ad68-5a53-4628-b0b7-83ed761e02cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa202efc90>]}
2020-08-12 18:34:14.029177 (Thread-1): 14:34:14 | 2 of 4 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.11s]
2020-08-12 18:34:14.029477 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 18:34:14.032562 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 18:34:14.035339 (Thread-1): 14:34:14 | 3 of 4 START table model dev.customer_profile........................ [RUN]
2020-08-12 18:34:14.035962 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:34:14.036133 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:34:14.036294 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 18:34:14.082536 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 18:34:14.083615 (Thread-1): finished collecting timing info
2020-08-12 18:34:14.188929 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:34:14.189303 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 18:34:14.200453 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 18:34:14.205240 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:34:14.205466 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 18:34:14.205873 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 18:34:14.222072 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 18:34:14.223435 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:34:14.224082 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 18:34:14.226725 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:34:14.227046 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:34:14.227365 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer_profile as (
    SELECT 
        customer_rental_summary.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        customer_rental_summary.first_rental,
        customer_rental_summary.last_rental,
        customer_rental_summary.num_rental,
        customer_rental_summary.period_days,
        customer_life_time_value.life_time_value
    FROM customer_rental_summary
    INNER JOIN customer_life_time_value USING(customer_id)
    INNER JOIN customer USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 18:34:14.232000 (Thread-1): Postgres error: relation "customer_rental_summary" does not exist
LINE 18:     FROM customer_rental_summary
                  ^

2020-08-12 18:34:14.232332 (Thread-1): On model.dbt_play.customer_profile: ROLLBACK
2020-08-12 18:34:14.233069 (Thread-1): finished collecting timing info
2020-08-12 18:34:14.233643 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 18:34:14.234176 (Thread-1): Database Error in model customer_profile (models/customer_profile.sql)
  relation "customer_rental_summary" does not exist
  LINE 18:     FROM customer_rental_summary
                    ^
  compiled SQL at target/run/dbt_play/models/customer_profile.sql
Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 77, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "customer_rental_summary" does not exist
LINE 18:     FROM customer_rental_summary
                  ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 122, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 85, in add_query
    return connection, cursor
  File "/Users/sean/opt/anaconda3/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_profile (models/customer_profile.sql)
  relation "customer_rental_summary" does not exist
  LINE 18:     FROM customer_rental_summary
                    ^
  compiled SQL at target/run/dbt_play/models/customer_profile.sql
2020-08-12 18:34:14.243672 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15d2ad68-5a53-4628-b0b7-83ed761e02cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa20404b50>]}
2020-08-12 18:34:14.245816 (Thread-1): 14:34:14 | 3 of 4 ERROR creating table model dev.customer_profile............... [ERROR in 0.21s]
2020-08-12 18:34:14.246048 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 18:34:14.246214 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 18:34:14.247489 (Thread-1): 14:34:14 | 4 of 4 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 18:34:14.247865 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:34:14.247969 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:34:14.248076 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 18:34:14.260016 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 18:34:14.260940 (Thread-1): finished collecting timing info
2020-08-12 18:34:14.276670 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:34:14.277166 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 18:34:14.427544 (Thread-1): SQL status: DROP VIEW in 0.15 seconds
2020-08-12 18:34:14.433050 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:34:14.433321 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 18:34:14.434320 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:34:14.437113 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 18:34:14.437948 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:34:14.438157 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 18:34:14.438793 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:34:14.439006 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:34:14.439170 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 18:34:14.461898 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 18:34:14.467790 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:34:14.468079 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 18:34:14.470278 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:34:14.472588 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 18:34:14.472943 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:34:14.473137 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 18:34:14.480704 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 18:34:14.482786 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:34:14.482923 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 18:34:14.483271 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:34:14.486145 (Thread-1): finished collecting timing info
2020-08-12 18:34:14.486450 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 18:34:14.487171 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15d2ad68-5a53-4628-b0b7-83ed761e02cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa204335d0>]}
2020-08-12 18:34:14.488771 (Thread-1): 14:34:14 | 4 of 4 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.24s]
2020-08-12 18:34:14.489026 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 18:34:14.544101 (MainThread): Acquiring new postgres connection "master".
2020-08-12 18:34:14.544317 (MainThread): Opening a new connection, currently in state closed
2020-08-12 18:34:14.544483 (MainThread): Using postgres connection "master".
2020-08-12 18:34:14.544592 (MainThread): On master: BEGIN
2020-08-12 18:34:14.554013 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 18:34:14.554273 (MainThread): On master: COMMIT
2020-08-12 18:34:14.554395 (MainThread): Using postgres connection "master".
2020-08-12 18:34:14.554497 (MainThread): On master: COMMIT
2020-08-12 18:34:14.554789 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:34:14.554948 (MainThread): On master: Close
2020-08-12 18:34:14.555425 (MainThread): 14:34:14 | 
2020-08-12 18:34:14.555674 (MainThread): 14:34:14 | Finished running 3 view models, 1 table model in 1.38s.
2020-08-12 18:34:14.555892 (MainThread): Connection 'master' was properly closed.
2020-08-12 18:34:14.556039 (MainThread): Connection 'model.dbt_play.customer_rental_summary' was properly closed.
2020-08-12 18:34:14.572918 (MainThread): 
2020-08-12 18:34:14.573147 (MainThread): Completed with 1 error and 0 warnings:
2020-08-12 18:34:14.573396 (MainThread): 
2020-08-12 18:34:14.573576 (MainThread): Database Error in model customer_profile (models/customer_profile.sql)
2020-08-12 18:34:14.573844 (MainThread):   relation "customer_rental_summary" does not exist
2020-08-12 18:34:14.574042 (MainThread):   LINE 18:     FROM customer_rental_summary
2020-08-12 18:34:14.574224 (MainThread):                     ^
2020-08-12 18:34:14.574535 (MainThread):   compiled SQL at target/run/dbt_play/models/customer_profile.sql
2020-08-12 18:34:14.574759 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-08-12 18:34:14.575001 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa204e3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa204e39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa20459b50>]}
2020-08-12 18:34:14.575235 (MainThread): Flushing usage events
2020-08-12 18:41:53.816957 (MainThread): Running with dbt=0.17.2
2020-08-12 18:41:54.382451 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 18:41:54.386966 (MainThread): Tracking: tracking
2020-08-12 18:41:54.490737 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa199017d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa198f1dd0>]}
2020-08-12 18:41:55.041215 (MainThread): Partial parsing not enabled
2020-08-12 18:41:55.075422 (MainThread): Parsing macros/core.sql
2020-08-12 18:41:55.136176 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 18:41:55.220668 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 18:41:55.236574 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 18:41:55.373832 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 18:41:55.648170 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 18:41:55.893212 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 18:41:55.920804 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 18:41:55.970680 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 18:41:56.086915 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 18:41:56.133439 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 18:41:56.188839 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 18:41:56.226100 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 18:41:56.236585 (MainThread): Parsing macros/etc/query.sql
2020-08-12 18:41:56.243217 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 18:41:56.254238 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 18:41:56.334901 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 18:41:56.382678 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 18:41:56.415735 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 18:41:56.820671 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 18:41:56.828939 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 18:41:56.838111 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 18:41:56.846000 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 18:41:56.860138 (MainThread): Parsing macros/catalog.sql
2020-08-12 18:41:56.879935 (MainThread): Parsing macros/relations.sql
2020-08-12 18:41:56.889698 (MainThread): Parsing macros/adapters.sql
2020-08-12 18:41:57.042713 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 18:41:57.176296 (MainThread): Partial parsing not enabled
2020-08-12 18:41:57.432927 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:41:57.433859 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:41:57.691322 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 18:41:57.691864 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:41:57.752997 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:41:57.753577 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:41:57.815037 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:41:57.815702 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:41:58.555402 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 18:41:58.562052 (MainThread): 
2020-08-12 18:41:58.565944 (MainThread): Acquiring new postgres connection "master".
2020-08-12 18:41:58.566797 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:41:58.632528 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 18:41:58.633541 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 18:41:58.710491 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 18:41:58.711457 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 18:41:58.755386 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.04 seconds
2020-08-12 18:41:58.771771 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 18:41:58.806897 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 18:41:58.807970 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 18:41:58.839443 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 18:41:58.839981 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 18:41:58.872212 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.03 seconds
2020-08-12 18:41:58.872764 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 18:41:58.873317 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 18:41:58.890080 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.02 seconds
2020-08-12 18:41:58.906142 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 18:41:58.907266 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 18:41:58.958911 (MainThread): Using postgres connection "master".
2020-08-12 18:41:58.960467 (MainThread): On master: BEGIN
2020-08-12 18:41:58.991764 (MainThread): SQL status: BEGIN in 0.03 seconds
2020-08-12 18:41:58.992470 (MainThread): Using postgres connection "master".
2020-08-12 18:41:58.994468 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 18:42:00.999244 (MainThread): SQL status: SELECT 43 in 2.00 seconds
2020-08-12 18:42:01.247288 (MainThread): On master: ROLLBACK
2020-08-12 18:42:01.248599 (MainThread): Using postgres connection "master".
2020-08-12 18:42:01.249109 (MainThread): On master: BEGIN
2020-08-12 18:42:01.251663 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:01.252332 (MainThread): On master: COMMIT
2020-08-12 18:42:01.252897 (MainThread): Using postgres connection "master".
2020-08-12 18:42:01.253300 (MainThread): On master: COMMIT
2020-08-12 18:42:01.254221 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:01.254788 (MainThread): On master: Close
2020-08-12 18:42:01.256404 (MainThread): 14:42:01 | Concurrency: 1 threads (target='dev')
2020-08-12 18:42:01.257182 (MainThread): 14:42:01 | 
2020-08-12 18:42:01.272320 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 18:42:01.278108 (Thread-1): 14:42:01 | 1 of 4 START view model dev.customer................................. [RUN]
2020-08-12 18:42:01.279461 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 18:42:01.279885 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:42:01.280352 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 18:42:01.457222 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 18:42:01.459627 (Thread-1): finished collecting timing info
2020-08-12 18:42:01.662393 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:01.663005 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 18:42:01.697618 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2020-08-12 18:42:01.713132 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:01.713716 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 18:42:01.715226 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:42:01.744993 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 18:42:01.746903 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:01.747422 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 18:42:01.748563 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:01.749019 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:01.749407 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 18:42:01.769237 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 18:42:01.812604 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:01.813262 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 18:42:01.815955 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:01.825702 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:01.826528 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 18:42:01.830485 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:01.872146 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 18:42:01.872749 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:01.873238 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 18:42:01.877898 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:01.893188 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:01.895194 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 18:42:01.910867 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 18:42:01.922359 (Thread-1): finished collecting timing info
2020-08-12 18:42:01.923495 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 18:42:01.928464 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7224376-e399-4e84-8b02-f083ef985a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fd090>]}
2020-08-12 18:42:01.938658 (Thread-1): 14:42:01 | 1 of 4 OK created view model dev.customer............................ [CREATE VIEW in 0.65s]
2020-08-12 18:42:01.939601 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 18:42:01.940771 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 18:42:01.949285 (Thread-1): 14:42:01 | 2 of 4 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 18:42:01.951761 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:01.952384 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:42:01.952943 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 18:42:02.055750 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 18:42:02.059108 (Thread-1): finished collecting timing info
2020-08-12 18:42:02.107409 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:02.109125 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 18:42:02.146554 (Thread-1): SQL status: DROP VIEW in 0.04 seconds
2020-08-12 18:42:02.155817 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:02.157097 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 18:42:02.162692 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 18:42:02.170266 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 18:42:02.173146 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:02.174233 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 18:42:02.175803 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:02.176971 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:02.177469 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 18:42:02.189659 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 18:42:02.218502 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:02.219266 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 18:42:02.222177 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:02.236394 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:02.237483 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 18:42:02.240184 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:02.247555 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 18:42:02.248120 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:02.248518 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 18:42:02.251830 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:02.278721 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:02.279264 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 18:42:02.284714 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 18:42:02.310451 (Thread-1): finished collecting timing info
2020-08-12 18:42:02.312196 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 18:42:02.316247 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7224376-e399-4e84-8b02-f083ef985a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a070e50>]}
2020-08-12 18:42:02.322838 (Thread-1): 14:42:02 | 2 of 4 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.36s]
2020-08-12 18:42:02.323857 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 18:42:02.329779 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 18:42:02.350661 (Thread-1): 14:42:02 | 3 of 4 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 18:42:02.352621 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:02.353301 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:42:02.356203 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 18:42:02.527364 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 18:42:02.530871 (Thread-1): finished collecting timing info
2020-08-12 18:42:02.619937 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:02.620858 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 18:42:02.667445 (Thread-1): SQL status: DROP VIEW in 0.05 seconds
2020-08-12 18:42:02.683516 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:02.684223 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 18:42:02.685487 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:42:02.699266 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 18:42:02.702053 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:02.702579 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 18:42:02.703763 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:02.704264 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:02.705510 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 18:42:02.726281 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 18:42:02.749236 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:02.750096 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 18:42:02.752589 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:02.763554 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:02.764874 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 18:42:02.767229 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:02.773718 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 18:42:02.774695 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:02.776119 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 18:42:02.779152 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:02.786961 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:02.787492 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 18:42:02.791938 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:42:02.804720 (Thread-1): finished collecting timing info
2020-08-12 18:42:02.806257 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 18:42:02.810364 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7224376-e399-4e84-8b02-f083ef985a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a12f2d0>]}
2020-08-12 18:42:02.815425 (Thread-1): 14:42:02 | 3 of 4 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.46s]
2020-08-12 18:42:02.816418 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 18:42:02.819533 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 18:42:02.824983 (Thread-1): 14:42:02 | 4 of 4 START table model dev.customer_profile........................ [RUN]
2020-08-12 18:42:02.828016 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:02.828658 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:42:02.829111 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 18:42:02.920752 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 18:42:02.922864 (Thread-1): finished collecting timing info
2020-08-12 18:42:03.087277 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:03.087933 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 18:42:03.122281 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2020-08-12 18:42:03.139820 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:03.140582 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 18:42:03.146527 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 18:42:03.203293 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 18:42:03.206919 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:03.207609 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 18:42:03.211823 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:03.212788 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:03.213286 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
)
customer_profile as (
    SELECT 
        rental.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.num_rental,
        rental.period_days,
        ltv.life_time_value
    FROM rental
    INNER JOIN ltv USING(customer_id)
    INNER JOIN customer USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 18:42:03.214937 (Thread-1): Postgres error: syntax error at or near "customer_profile"
LINE 15: customer_profile as (
         ^

2020-08-12 18:42:03.215616 (Thread-1): On model.dbt_play.customer_profile: ROLLBACK
2020-08-12 18:42:03.218594 (Thread-1): finished collecting timing info
2020-08-12 18:42:03.219760 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 18:42:03.221507 (Thread-1): Database Error in model customer_profile (models/customer_profile.sql)
  syntax error at or near "customer_profile"
  LINE 15: customer_profile as (
           ^
  compiled SQL at target/run/dbt_play/models/customer_profile.sql
Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 77, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "customer_profile"
LINE 15: customer_profile as (
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 122, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 85, in add_query
    return connection, cursor
  File "/Users/sean/opt/anaconda3/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_profile (models/customer_profile.sql)
  syntax error at or near "customer_profile"
  LINE 15: customer_profile as (
           ^
  compiled SQL at target/run/dbt_play/models/customer_profile.sql
2020-08-12 18:42:03.264554 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7224376-e399-4e84-8b02-f083ef985a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a0fd310>]}
2020-08-12 18:42:03.273493 (Thread-1): 14:42:03 | 4 of 4 ERROR creating table model dev.customer_profile............... [ERROR in 0.44s]
2020-08-12 18:42:03.274358 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 18:42:03.289976 (MainThread): Acquiring new postgres connection "master".
2020-08-12 18:42:03.290782 (MainThread): Opening a new connection, currently in state closed
2020-08-12 18:42:03.291604 (MainThread): Using postgres connection "master".
2020-08-12 18:42:03.292264 (MainThread): On master: BEGIN
2020-08-12 18:42:03.350219 (MainThread): SQL status: BEGIN in 0.06 seconds
2020-08-12 18:42:03.350822 (MainThread): On master: COMMIT
2020-08-12 18:42:03.351335 (MainThread): Using postgres connection "master".
2020-08-12 18:42:03.352067 (MainThread): On master: COMMIT
2020-08-12 18:42:03.353270 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:03.353863 (MainThread): On master: Close
2020-08-12 18:42:03.355239 (MainThread): 14:42:03 | 
2020-08-12 18:42:03.355920 (MainThread): 14:42:03 | Finished running 3 view models, 1 table model in 4.79s.
2020-08-12 18:42:03.356717 (MainThread): Connection 'master' was properly closed.
2020-08-12 18:42:03.357976 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 18:42:03.465224 (MainThread): 
2020-08-12 18:42:03.466710 (MainThread): Completed with 1 error and 0 warnings:
2020-08-12 18:42:03.467595 (MainThread): 
2020-08-12 18:42:03.469441 (MainThread): Database Error in model customer_profile (models/customer_profile.sql)
2020-08-12 18:42:03.471051 (MainThread):   syntax error at or near "customer_profile"
2020-08-12 18:42:03.472308 (MainThread):   LINE 15: customer_profile as (
2020-08-12 18:42:03.473142 (MainThread):            ^
2020-08-12 18:42:03.473911 (MainThread):   compiled SQL at target/run/dbt_play/models/customer_profile.sql
2020-08-12 18:42:03.474775 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2020-08-12 18:42:03.477155 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa19eeeb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a17e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a17e1d0>]}
2020-08-12 18:42:03.478901 (MainThread): Flushing usage events
2020-08-12 18:42:29.341574 (MainThread): Running with dbt=0.17.2
2020-08-12 18:42:30.226679 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 18:42:30.234919 (MainThread): Tracking: tracking
2020-08-12 18:42:30.325346 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa226ac650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc87750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa2269c0d0>]}
2020-08-12 18:42:30.490656 (MainThread): Partial parsing not enabled
2020-08-12 18:42:30.506819 (MainThread): Parsing macros/core.sql
2020-08-12 18:42:30.545787 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 18:42:30.611275 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 18:42:30.622152 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 18:42:30.791485 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 18:42:31.015372 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 18:42:31.177022 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 18:42:31.385999 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 18:42:31.521020 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 18:42:31.705555 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 18:42:31.811660 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 18:42:32.044610 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 18:42:32.113645 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 18:42:32.124972 (MainThread): Parsing macros/etc/query.sql
2020-08-12 18:42:32.137728 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 18:42:32.152856 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 18:42:32.258633 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 18:42:32.278535 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 18:42:32.289688 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 18:42:32.761952 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 18:42:32.779166 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 18:42:32.786573 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 18:42:32.798322 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 18:42:32.828212 (MainThread): Parsing macros/catalog.sql
2020-08-12 18:42:32.874062 (MainThread): Parsing macros/relations.sql
2020-08-12 18:42:32.886570 (MainThread): Parsing macros/adapters.sql
2020-08-12 18:42:33.065254 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 18:42:33.228047 (MainThread): Partial parsing not enabled
2020-08-12 18:42:33.464342 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:33.464954 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:42:33.680271 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 18:42:33.680876 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:42:33.752227 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:33.752955 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:42:33.826183 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:33.826896 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:42:34.521271 (MainThread): Found 4 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 18:42:34.525867 (MainThread): 
2020-08-12 18:42:34.528216 (MainThread): Acquiring new postgres connection "master".
2020-08-12 18:42:34.529124 (MainThread): Opening a new connection, currently in state init
2020-08-12 18:42:34.726092 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 18:42:34.727270 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 18:42:34.928594 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 18:42:34.929387 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 18:42:35.024404 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.09 seconds
2020-08-12 18:42:35.056461 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 18:42:35.109522 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 18:42:35.110438 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 18:42:35.167972 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 18:42:35.168768 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 18:42:35.221831 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.05 seconds
2020-08-12 18:42:35.222869 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 18:42:35.223612 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 18:42:35.254346 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.03 seconds
2020-08-12 18:42:35.286191 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 18:42:35.287729 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 18:42:35.357089 (MainThread): Using postgres connection "master".
2020-08-12 18:42:35.357676 (MainThread): On master: BEGIN
2020-08-12 18:42:35.390728 (MainThread): SQL status: BEGIN in 0.03 seconds
2020-08-12 18:42:35.391354 (MainThread): Using postgres connection "master".
2020-08-12 18:42:35.391775 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 18:42:37.075336 (MainThread): SQL status: SELECT 43 in 1.68 seconds
2020-08-12 18:42:37.361246 (MainThread): On master: ROLLBACK
2020-08-12 18:42:37.367447 (MainThread): Using postgres connection "master".
2020-08-12 18:42:37.368442 (MainThread): On master: BEGIN
2020-08-12 18:42:37.371017 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:37.372233 (MainThread): On master: COMMIT
2020-08-12 18:42:37.372805 (MainThread): Using postgres connection "master".
2020-08-12 18:42:37.374350 (MainThread): On master: COMMIT
2020-08-12 18:42:37.375405 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:37.376250 (MainThread): On master: Close
2020-08-12 18:42:37.377924 (MainThread): 14:42:37 | Concurrency: 1 threads (target='dev')
2020-08-12 18:42:37.379498 (MainThread): 14:42:37 | 
2020-08-12 18:42:37.390307 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 18:42:37.395661 (Thread-1): 14:42:37 | 1 of 4 START view model dev.customer................................. [RUN]
2020-08-12 18:42:37.397754 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 18:42:37.398568 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:42:37.399594 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 18:42:37.574040 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 18:42:37.575781 (Thread-1): finished collecting timing info
2020-08-12 18:42:37.812710 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:37.813493 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 18:42:37.860514 (Thread-1): SQL status: DROP VIEW in 0.05 seconds
2020-08-12 18:42:37.877728 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:37.878342 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 18:42:37.880183 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:42:37.907041 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 18:42:37.910022 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:37.910554 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 18:42:37.911792 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:37.912292 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:37.912705 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 18:42:37.935630 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 18:42:37.994807 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:37.995430 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 18:42:38.000353 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:38.013201 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:38.013789 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 18:42:38.015895 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:38.055078 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 18:42:38.055908 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:38.056351 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 18:42:38.059602 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:38.080549 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 18:42:38.081147 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 18:42:38.086400 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:42:38.102627 (Thread-1): finished collecting timing info
2020-08-12 18:42:38.104289 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 18:42:38.107524 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5e7c81f-d365-42d6-9472-98fb8b502649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22b35a90>]}
2020-08-12 18:42:38.112591 (Thread-1): 14:42:38 | 1 of 4 OK created view model dev.customer............................ [CREATE VIEW in 0.71s]
2020-08-12 18:42:38.113693 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 18:42:38.114994 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 18:42:38.120084 (Thread-1): 14:42:38 | 2 of 4 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 18:42:38.122986 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:38.123492 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:42:38.123934 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 18:42:38.188185 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 18:42:38.190506 (Thread-1): finished collecting timing info
2020-08-12 18:42:38.242774 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:38.245094 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 18:42:38.278807 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2020-08-12 18:42:38.289312 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:38.289903 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 18:42:38.291026 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:42:38.297355 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 18:42:38.302254 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:38.302940 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 18:42:38.305337 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:38.306034 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:38.306482 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 18:42:38.319318 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 18:42:38.342019 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:38.342628 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 18:42:38.344586 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:38.354527 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:38.355129 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 18:42:38.356897 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:38.361777 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 18:42:38.362282 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:38.362687 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 18:42:38.367880 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:38.382862 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 18:42:38.383620 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 18:42:38.387844 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:42:38.400491 (Thread-1): finished collecting timing info
2020-08-12 18:42:38.402153 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 18:42:38.408010 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5e7c81f-d365-42d6-9472-98fb8b502649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22d9d210>]}
2020-08-12 18:42:38.413057 (Thread-1): 14:42:38 | 2 of 4 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.28s]
2020-08-12 18:42:38.413810 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 18:42:38.414808 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 18:42:38.420860 (Thread-1): 14:42:38 | 3 of 4 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 18:42:38.422726 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:38.423317 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:42:38.423861 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 18:42:38.476043 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 18:42:38.478698 (Thread-1): finished collecting timing info
2020-08-12 18:42:38.524379 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:38.525131 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 18:42:38.569329 (Thread-1): SQL status: DROP VIEW in 0.04 seconds
2020-08-12 18:42:38.581892 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:38.582525 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 18:42:38.584050 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:42:38.590993 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 18:42:38.593062 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:38.593726 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 18:42:38.595703 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:38.597201 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:38.597930 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 18:42:38.616478 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 18:42:38.636573 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:38.637161 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 18:42:38.640063 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:38.649380 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:38.649974 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 18:42:38.652266 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:38.658757 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 18:42:38.660123 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:38.660830 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 18:42:38.664034 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:38.674209 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 18:42:38.675016 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 18:42:38.679335 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 18:42:38.698706 (Thread-1): finished collecting timing info
2020-08-12 18:42:38.700200 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 18:42:38.704167 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5e7c81f-d365-42d6-9472-98fb8b502649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22f7be10>]}
2020-08-12 18:42:38.712608 (Thread-1): 14:42:38 | 3 of 4 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.28s]
2020-08-12 18:42:38.713387 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 18:42:38.714842 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 18:42:38.721353 (Thread-1): 14:42:38 | 4 of 4 START table model dev.customer_profile........................ [RUN]
2020-08-12 18:42:38.723685 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:38.724460 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 18:42:38.726428 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 18:42:38.839933 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 18:42:38.845535 (Thread-1): finished collecting timing info
2020-08-12 18:42:39.010736 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:39.011366 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 18:42:39.048450 (Thread-1): SQL status: DROP TABLE in 0.04 seconds
2020-08-12 18:42:39.060025 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:39.060605 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 18:42:39.061900 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 18:42:39.100575 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 18:42:39.103715 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:39.104709 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 18:42:39.105878 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 18:42:39.106579 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:39.107274 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
customer_profile as (
    SELECT 
        rental.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.num_rental,
        rental.period_days,
        ltv.life_time_value
    FROM rental
    INNER JOIN ltv USING(customer_id)
    INNER JOIN customer USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 18:42:39.222461 (Thread-1): SQL status: SELECT 599 in 0.11 seconds
2020-08-12 18:42:39.236777 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:39.237360 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 18:42:39.240284 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 18:42:39.244989 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 18:42:39.245527 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:39.245954 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 18:42:39.252482 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 18:42:39.262575 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 18:42:39.263798 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 18:42:39.265095 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 18:42:39.279085 (Thread-1): finished collecting timing info
2020-08-12 18:42:39.280350 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 18:42:39.283327 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5e7c81f-d365-42d6-9472-98fb8b502649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22e57f10>]}
2020-08-12 18:42:39.290546 (Thread-1): 14:42:39 | 4 of 4 OK created table model dev.customer_profile................... [SELECT 599 in 0.56s]
2020-08-12 18:42:39.291380 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 18:42:39.311498 (MainThread): Acquiring new postgres connection "master".
2020-08-12 18:42:39.312114 (MainThread): Opening a new connection, currently in state closed
2020-08-12 18:42:39.312746 (MainThread): Using postgres connection "master".
2020-08-12 18:42:39.313186 (MainThread): On master: BEGIN
2020-08-12 18:42:39.370490 (MainThread): SQL status: BEGIN in 0.06 seconds
2020-08-12 18:42:39.371167 (MainThread): On master: COMMIT
2020-08-12 18:42:39.371678 (MainThread): Using postgres connection "master".
2020-08-12 18:42:39.372121 (MainThread): On master: COMMIT
2020-08-12 18:42:39.373267 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 18:42:39.374194 (MainThread): On master: Close
2020-08-12 18:42:39.376006 (MainThread): 14:42:39 | 
2020-08-12 18:42:39.376729 (MainThread): 14:42:39 | Finished running 3 view models, 1 table model in 4.85s.
2020-08-12 18:42:39.377612 (MainThread): Connection 'master' was properly closed.
2020-08-12 18:42:39.378210 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 18:42:39.468524 (MainThread): 
2020-08-12 18:42:39.469599 (MainThread): Completed successfully
2020-08-12 18:42:39.470398 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2020-08-12 18:42:39.472615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22ed2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22e2ca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22e8fa50>]}
2020-08-12 18:42:39.473972 (MainThread): Flushing usage events
2020-08-12 19:01:31.145829 (MainThread): Running with dbt=0.17.2
2020-08-12 19:01:31.232479 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 19:01:31.234220 (MainThread): Tracking: tracking
2020-08-12 19:01:31.254421 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa164a20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a89750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16496f50>]}
2020-08-12 19:01:31.279713 (MainThread): Partial parsing not enabled
2020-08-12 19:01:31.282387 (MainThread): Parsing macros/core.sql
2020-08-12 19:01:31.291944 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 19:01:31.302724 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 19:01:31.305044 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 19:01:31.327048 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 19:01:31.366442 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 19:01:31.395263 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 19:01:31.397894 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 19:01:31.405743 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 19:01:31.425256 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 19:01:31.434499 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 19:01:31.443178 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 19:01:31.449886 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 19:01:31.451140 (MainThread): Parsing macros/etc/query.sql
2020-08-12 19:01:31.452605 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 19:01:31.454693 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 19:01:31.467624 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 19:01:31.470113 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 19:01:31.472107 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 19:01:31.539494 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 19:01:31.540928 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 19:01:31.542021 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 19:01:31.543440 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 19:01:31.547711 (MainThread): Parsing macros/catalog.sql
2020-08-12 19:01:31.551225 (MainThread): Parsing macros/relations.sql
2020-08-12 19:01:31.553612 (MainThread): Parsing macros/adapters.sql
2020-08-12 19:01:31.580538 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 19:01:31.605724 (MainThread): Partial parsing not enabled
2020-08-12 19:01:31.649163 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:31.649339 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:31.686535 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:01:31.686961 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:31.698570 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:31.698762 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:31.710487 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:31.710699 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:31.724551 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:31.724739 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:31.850170 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 19:01:31.851456 (MainThread): 
2020-08-12 19:01:31.851971 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:01:31.852144 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:31.867402 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 19:01:31.867827 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 19:01:31.883523 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 19:01:31.883731 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 19:01:31.894915 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.01 seconds
2020-08-12 19:01:31.898116 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 19:01:31.907077 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 19:01:31.907294 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 19:01:31.913749 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:01:31.913920 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 19:01:31.921874 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:01:31.922088 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:01:31.922210 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 19:01:31.926317 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2020-08-12 19:01:31.930979 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 19:01:31.931373 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 19:01:31.945650 (MainThread): Using postgres connection "master".
2020-08-12 19:01:31.945852 (MainThread): On master: BEGIN
2020-08-12 19:01:31.955735 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:01:31.955930 (MainThread): Using postgres connection "master".
2020-08-12 19:01:31.956041 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 19:01:32.257868 (MainThread): SQL status: SELECT 43 in 0.30 seconds
2020-08-12 19:01:32.312693 (MainThread): On master: ROLLBACK
2020-08-12 19:01:32.313168 (MainThread): Using postgres connection "master".
2020-08-12 19:01:32.313298 (MainThread): On master: BEGIN
2020-08-12 19:01:32.313644 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:32.313849 (MainThread): On master: COMMIT
2020-08-12 19:01:32.313978 (MainThread): Using postgres connection "master".
2020-08-12 19:01:32.314089 (MainThread): On master: COMMIT
2020-08-12 19:01:32.314350 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:32.314516 (MainThread): On master: Close
2020-08-12 19:01:32.314942 (MainThread): 15:01:32 | Concurrency: 1 threads (target='dev')
2020-08-12 19:01:32.315301 (MainThread): 15:01:32 | 
2020-08-12 19:01:32.317291 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 19:01:32.319335 (Thread-1): 15:01:32 | 1 of 5 START view model dev.customer................................. [RUN]
2020-08-12 19:01:32.321018 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:01:32.321456 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:32.321619 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 19:01:32.341187 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 19:01:32.342838 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.377953 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:32.378144 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 19:01:32.386473 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:01:32.389320 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:32.389463 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:01:32.389830 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:32.395684 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 19:01:32.396269 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:32.396395 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 19:01:32.396757 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:32.396870 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:32.396965 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 19:01:32.425483 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2020-08-12 19:01:32.436528 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:32.436722 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 19:01:32.437470 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:32.440004 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:32.440144 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 19:01:32.440738 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:32.448935 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:01:32.449116 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:32.449216 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:01:32.449995 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:32.454545 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:32.454741 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:01:32.456421 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:32.459436 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.459784 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 19:01:32.460437 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a7952e-0367-47da-ad6f-889ff1188f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16a47810>]}
2020-08-12 19:01:32.461682 (Thread-1): 15:01:32 | 1 of 5 OK created view model dev.customer............................ [CREATE VIEW in 0.14s]
2020-08-12 19:01:32.461926 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 19:01:32.462188 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 19:01:32.463321 (Thread-1): 15:01:32 | 2 of 5 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 19:01:32.463802 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:32.463949 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:32.464066 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 19:01:32.475922 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:01:32.476670 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.485247 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:32.485465 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 19:01:32.496622 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:01:32.499382 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:32.499733 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:01:32.500131 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:32.501685 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:01:32.502456 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:32.502625 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 19:01:32.502995 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:32.503109 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:32.503206 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 19:01:32.512911 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:01:32.520486 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:32.520681 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 19:01:32.521440 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:32.524233 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:32.524390 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 19:01:32.524994 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:32.526246 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:01:32.526388 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:32.526487 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:01:32.532332 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:01:32.535385 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:32.535647 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:01:32.537119 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:32.540168 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.540537 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 19:01:32.541581 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a7952e-0367-47da-ad6f-889ff1188f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16c81d90>]}
2020-08-12 19:01:32.543391 (Thread-1): 15:01:32 | 2 of 5 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.08s]
2020-08-12 19:01:32.543736 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 19:01:32.543970 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 19:01:32.545326 (Thread-1): 15:01:32 | 3 of 5 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 19:01:32.545773 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:32.546054 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:32.546229 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 19:01:32.561765 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:01:32.562747 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.569984 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:32.570339 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 19:01:32.581308 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:01:32.584475 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:32.584677 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:01:32.585221 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:32.586713 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:01:32.587242 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:32.587358 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 19:01:32.587706 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:32.587829 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:32.587928 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 19:01:32.606330 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 19:01:32.611817 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:32.612015 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 19:01:32.612865 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:32.615678 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:32.615899 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 19:01:32.616782 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:32.618215 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:01:32.618451 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:32.618629 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:01:32.619538 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:32.621551 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:32.621683 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:01:32.623229 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:32.626103 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.626479 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 19:01:32.627565 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a7952e-0367-47da-ad6f-889ff1188f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16ce0790>]}
2020-08-12 19:01:32.629053 (Thread-1): 15:01:32 | 3 of 5 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.08s]
2020-08-12 19:01:32.629323 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 19:01:32.629582 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 19:01:32.630820 (Thread-1): 15:01:32 | 4 of 5 START view model dev.customer_language_preference............. [RUN]
2020-08-12 19:01:32.631417 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:32.631590 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:32.631713 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 19:01:32.641906 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:01:32.642431 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.649583 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:32.649777 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 19:01:32.660401 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:01:32.663168 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:32.663328 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:01:32.663748 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:32.665139 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:01:32.665850 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:32.666029 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 19:01:32.666496 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:32.666657 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:32.666766 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with customer_language_preference as (
    SELECT DISTINCT ON (r.customer_id)
        r.customer_id,
        l.name as language
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film  f ON i.film_id = f.film_id 
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    GROUP BY r.customer_id, l.name
    ORDER BY r.customer_id ASC, COUNT(*) DESC;
)
  );

2020-08-12 19:01:32.667248 (Thread-1): Postgres error: syntax error at or near ";"
LINE 13:     ORDER BY r.customer_id ASC, COUNT(*) DESC;
                                                      ^

2020-08-12 19:01:32.667390 (Thread-1): On model.dbt_play.customer_language_preference: ROLLBACK
2020-08-12 19:01:32.667652 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.668000 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 19:01:32.668662 (Thread-1): Database Error in model customer_language_preference (models/staging/customer_language_preference.sql)
  syntax error at or near ";"
  LINE 13:     ORDER BY r.customer_id ASC, COUNT(*) DESC;
                                                        ^
  compiled SQL at target/run/dbt_play/models/staging/customer_language_preference.sql
Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 77, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 13:     ORDER BY r.customer_id ASC, COUNT(*) DESC;
                                                      ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 122, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 85, in add_query
    return connection, cursor
  File "/Users/sean/opt/anaconda3/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_language_preference (models/staging/customer_language_preference.sql)
  syntax error at or near ";"
  LINE 13:     ORDER BY r.customer_id ASC, COUNT(*) DESC;
                                                        ^
  compiled SQL at target/run/dbt_play/models/staging/customer_language_preference.sql
2020-08-12 19:01:32.671572 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a7952e-0367-47da-ad6f-889ff1188f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16c4e350>]}
2020-08-12 19:01:32.672815 (Thread-1): 15:01:32 | 4 of 5 ERROR creating view model dev.customer_language_preference.... [ERROR in 0.04s]
2020-08-12 19:01:32.673022 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 19:01:32.673261 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 19:01:32.674791 (Thread-1): 15:01:32 | 5 of 5 START table model dev.customer_profile........................ [RUN]
2020-08-12 19:01:32.675370 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:32.675493 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:32.675605 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 19:01:32.687214 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:01:32.688154 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.719206 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:32.719405 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 19:01:32.727359 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 19:01:32.729651 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:32.729781 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:01:32.730187 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:01:32.736816 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:01:32.737363 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:32.737480 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 19:01:32.737839 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:32.737948 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:32.738040 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
customer_profile as (
    SELECT 
        rental.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.num_rental,
        rental.period_days,
        ltv.life_time_value
    FROM rental
    INNER JOIN ltv USING(customer_id)
    INNER JOIN customer USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 19:01:32.782909 (Thread-1): SQL status: SELECT 599 in 0.04 seconds
2020-08-12 19:01:32.787022 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:32.787170 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile" rename to "customer_profile__dbt_backup"
2020-08-12 19:01:32.787701 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:32.790428 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:32.790607 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 19:01:32.791224 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:32.792611 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:01:32.792736 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:32.792832 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:01:32.795422 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:32.797932 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:32.798111 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:01:32.801459 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:01:32.805507 (Thread-1): finished collecting timing info
2020-08-12 19:01:32.805953 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 19:01:32.806689 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a7952e-0367-47da-ad6f-889ff1188f92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16d6d610>]}
2020-08-12 19:01:32.807922 (Thread-1): 15:01:32 | 5 of 5 OK created table model dev.customer_profile................... [SELECT 599 in 0.13s]
2020-08-12 19:01:32.808174 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 19:01:32.826762 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:01:32.826969 (MainThread): Opening a new connection, currently in state closed
2020-08-12 19:01:32.827133 (MainThread): Using postgres connection "master".
2020-08-12 19:01:32.827244 (MainThread): On master: BEGIN
2020-08-12 19:01:32.835350 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:01:32.835575 (MainThread): On master: COMMIT
2020-08-12 19:01:32.835699 (MainThread): Using postgres connection "master".
2020-08-12 19:01:32.835808 (MainThread): On master: COMMIT
2020-08-12 19:01:32.836059 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:32.836370 (MainThread): On master: Close
2020-08-12 19:01:32.837019 (MainThread): 15:01:32 | 
2020-08-12 19:01:32.837322 (MainThread): 15:01:32 | Finished running 4 view models, 1 table model in 0.99s.
2020-08-12 19:01:32.837556 (MainThread): Connection 'master' was properly closed.
2020-08-12 19:01:32.837712 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 19:01:32.860282 (MainThread): 
2020-08-12 19:01:32.860511 (MainThread): Completed with 1 error and 0 warnings:
2020-08-12 19:01:32.860643 (MainThread): 
2020-08-12 19:01:32.860791 (MainThread): Database Error in model customer_language_preference (models/staging/customer_language_preference.sql)
2020-08-12 19:01:32.860928 (MainThread):   syntax error at or near ";"
2020-08-12 19:01:32.861064 (MainThread):   LINE 13:     ORDER BY r.customer_id ASC, COUNT(*) DESC;
2020-08-12 19:01:32.861186 (MainThread):                                                         ^
2020-08-12 19:01:32.861305 (MainThread):   compiled SQL at target/run/dbt_play/models/staging/customer_language_preference.sql
2020-08-12 19:01:32.861439 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-08-12 19:01:32.861698 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16ca6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16cc7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16dafdd0>]}
2020-08-12 19:01:32.861949 (MainThread): Flushing usage events
2020-08-12 19:01:56.845880 (MainThread): Running with dbt=0.17.2
2020-08-12 19:01:56.926070 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 19:01:56.927201 (MainThread): Tracking: tracking
2020-08-12 19:01:56.946852 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa169d9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fc0750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa169d3d10>]}
2020-08-12 19:01:56.986087 (MainThread): Partial parsing not enabled
2020-08-12 19:01:56.990227 (MainThread): Parsing macros/core.sql
2020-08-12 19:01:56.999407 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 19:01:57.010152 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 19:01:57.012329 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 19:01:57.035352 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 19:01:57.077516 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 19:01:57.105026 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 19:01:57.107742 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 19:01:57.117166 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 19:01:57.135408 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 19:01:57.144655 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 19:01:57.153514 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 19:01:57.160835 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 19:01:57.162173 (MainThread): Parsing macros/etc/query.sql
2020-08-12 19:01:57.163457 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 19:01:57.165446 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 19:01:57.177351 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 19:01:57.179812 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 19:01:57.181841 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 19:01:57.251010 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 19:01:57.252560 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 19:01:57.253979 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 19:01:57.256199 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 19:01:57.259085 (MainThread): Parsing macros/catalog.sql
2020-08-12 19:01:57.261977 (MainThread): Parsing macros/relations.sql
2020-08-12 19:01:57.263658 (MainThread): Parsing macros/adapters.sql
2020-08-12 19:01:57.293570 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 19:01:57.318910 (MainThread): Partial parsing not enabled
2020-08-12 19:01:57.360130 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:57.360302 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:57.397837 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:01:57.398061 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:57.410092 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:57.410263 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:57.422384 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:57.422560 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:57.435380 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:57.435638 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:57.578301 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 19:01:57.579353 (MainThread): 
2020-08-12 19:01:57.579743 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:01:57.579896 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:01:57.592397 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 19:01:57.592878 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 19:01:57.610939 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 19:01:57.611135 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 19:01:57.625992 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.01 seconds
2020-08-12 19:01:57.630930 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 19:01:57.641854 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 19:01:57.642103 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 19:01:57.651493 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:01:57.651677 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 19:01:57.661583 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:01:57.661771 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:01:57.661888 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 19:01:57.665947 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.00 seconds
2020-08-12 19:01:57.671614 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 19:01:57.672024 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 19:01:57.683891 (MainThread): Using postgres connection "master".
2020-08-12 19:01:57.684063 (MainThread): On master: BEGIN
2020-08-12 19:01:57.691398 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:01:57.691577 (MainThread): Using postgres connection "master".
2020-08-12 19:01:57.691680 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 19:01:58.008451 (MainThread): SQL status: SELECT 43 in 0.32 seconds
2020-08-12 19:01:58.069262 (MainThread): On master: ROLLBACK
2020-08-12 19:01:58.069670 (MainThread): Using postgres connection "master".
2020-08-12 19:01:58.069829 (MainThread): On master: BEGIN
2020-08-12 19:01:58.070212 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:58.070392 (MainThread): On master: COMMIT
2020-08-12 19:01:58.070531 (MainThread): Using postgres connection "master".
2020-08-12 19:01:58.070681 (MainThread): On master: COMMIT
2020-08-12 19:01:58.071058 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:58.071214 (MainThread): On master: Close
2020-08-12 19:01:58.071593 (MainThread): 15:01:58 | Concurrency: 1 threads (target='dev')
2020-08-12 19:01:58.071768 (MainThread): 15:01:58 | 
2020-08-12 19:01:58.073839 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 19:01:58.075217 (Thread-1): 15:01:58 | 1 of 5 START view model dev.customer................................. [RUN]
2020-08-12 19:01:58.075628 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:01:58.075741 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:58.075870 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 19:01:58.096566 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 19:01:58.097208 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.149434 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:58.149632 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 19:01:58.158259 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:01:58.161249 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:58.161394 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:01:58.161758 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:58.167198 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 19:01:58.167820 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:58.167946 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 19:01:58.168333 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:58.168452 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:58.168551 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 19:01:58.174777 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:01:58.186587 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:58.186770 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 19:01:58.187810 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:58.190670 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:58.190860 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 19:01:58.191475 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:58.199627 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:01:58.199811 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:58.199911 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:01:58.200814 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:58.204537 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:01:58.204694 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:01:58.206508 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:58.209319 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.209630 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 19:01:58.210332 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd00944-624e-4030-9ba6-f1c5cd626c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa170bc390>]}
2020-08-12 19:01:58.211703 (Thread-1): 15:01:58 | 1 of 5 OK created view model dev.customer............................ [CREATE VIEW in 0.13s]
2020-08-12 19:01:58.211956 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 19:01:58.212225 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 19:01:58.213378 (Thread-1): 15:01:58 | 2 of 5 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 19:01:58.213830 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:58.213968 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:58.214088 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 19:01:58.222795 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:01:58.223494 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.231058 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:58.231258 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 19:01:58.244837 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:01:58.249745 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:58.250141 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:01:58.250519 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:58.252104 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:01:58.252687 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:58.252807 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 19:01:58.253244 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:58.253409 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:58.253516 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 19:01:58.258180 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:01:58.264454 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:58.264657 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 19:01:58.265386 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:58.270031 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:58.270771 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 19:01:58.278590 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2020-08-12 19:01:58.280067 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:01:58.280275 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:58.280385 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:01:58.281146 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:58.283124 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:01:58.283260 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:01:58.284618 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:58.287520 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.287828 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 19:01:58.288584 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd00944-624e-4030-9ba6-f1c5cd626c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa16fd3e10>]}
2020-08-12 19:01:58.289993 (Thread-1): 15:01:58 | 2 of 5 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.07s]
2020-08-12 19:01:58.290232 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 19:01:58.290498 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 19:01:58.291667 (Thread-1): 15:01:58 | 3 of 5 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 19:01:58.292070 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:58.292200 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:58.292317 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 19:01:58.299057 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:01:58.301214 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.313034 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:58.313337 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 19:01:58.328096 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:01:58.330564 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:58.330705 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:01:58.331037 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:58.332550 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:01:58.333107 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:58.333234 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 19:01:58.333622 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:58.333738 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:58.333834 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 19:01:58.338861 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:01:58.343614 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:58.343986 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 19:01:58.344873 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:58.347800 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:58.347983 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 19:01:58.348622 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:58.349828 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:01:58.349957 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:58.350056 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:01:58.356836 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:01:58.359126 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:01:58.359326 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:01:58.360709 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:58.364398 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.364731 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 19:01:58.365373 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd00944-624e-4030-9ba6-f1c5cd626c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1721b490>]}
2020-08-12 19:01:58.366604 (Thread-1): 15:01:58 | 3 of 5 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.07s]
2020-08-12 19:01:58.366843 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 19:01:58.367121 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 19:01:58.368686 (Thread-1): 15:01:58 | 4 of 5 START view model dev.customer_language_preference............. [RUN]
2020-08-12 19:01:58.369219 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:58.369362 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:58.369540 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 19:01:58.379040 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:01:58.382626 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.393074 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:58.393268 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 19:01:58.412321 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 19:01:58.414953 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:58.415115 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:01:58.415469 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:58.417148 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:01:58.417779 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:58.417986 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 19:01:58.418889 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:58.419325 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:58.419525 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with customer_language_preference as (
    SELECT DISTINCT ON (r.customer_id)
        r.customer_id,
        l.name as language
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film  f ON i.film_id = f.film_id 
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    GROUP BY r.customer_id, l.name
    ORDER BY r.customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 19:01:58.425443 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:01:58.428189 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:58.428333 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 19:01:58.429525 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:58.431041 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:01:58.431179 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:58.431287 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:01:58.438360 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:01:58.443126 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:01:58.443355 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:01:58.443821 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:01:58.447712 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.448076 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 19:01:58.448957 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd00944-624e-4030-9ba6-f1c5cd626c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1725b5d0>]}
2020-08-12 19:01:58.450329 (Thread-1): 15:01:58 | 4 of 5 OK created view model dev.customer_language_preference........ [CREATE VIEW in 0.08s]
2020-08-12 19:01:58.450588 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 19:01:58.450888 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 19:01:58.452133 (Thread-1): 15:01:58 | 5 of 5 START table model dev.customer_profile........................ [RUN]
2020-08-12 19:01:58.452542 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:58.452668 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:01:58.452795 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 19:01:58.466949 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:01:58.467748 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.501033 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:58.501224 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 19:01:58.513430 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 19:01:58.516182 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:58.516333 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:01:58.516669 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:01:58.523449 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:01:58.524137 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:58.524281 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 19:01:58.524671 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:01:58.524784 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:58.524879 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
customer_profile as (
    SELECT 
        rental.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.num_rental,
        rental.period_days,
        ltv.life_time_value
    FROM rental
    INNER JOIN ltv USING(customer_id)
    INNER JOIN customer USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 19:01:58.557991 (Thread-1): SQL status: SELECT 599 in 0.03 seconds
2020-08-12 19:01:58.562726 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:58.562904 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile" rename to "customer_profile__dbt_backup"
2020-08-12 19:01:58.563421 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:58.566600 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:58.566793 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 19:01:58.568509 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:01:58.569975 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:01:58.570164 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:58.570282 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:01:58.571191 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:58.573109 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:01:58.573328 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:01:58.575696 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:01:58.579058 (Thread-1): finished collecting timing info
2020-08-12 19:01:58.579493 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 19:01:58.580216 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0dd00944-624e-4030-9ba6-f1c5cd626c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa17251050>]}
2020-08-12 19:01:58.581430 (Thread-1): 15:01:58 | 5 of 5 OK created table model dev.customer_profile................... [SELECT 599 in 0.13s]
2020-08-12 19:01:58.581718 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 19:01:58.594305 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:01:58.594547 (MainThread): Opening a new connection, currently in state closed
2020-08-12 19:01:58.594863 (MainThread): Using postgres connection "master".
2020-08-12 19:01:58.595055 (MainThread): On master: BEGIN
2020-08-12 19:01:58.607788 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:01:58.608071 (MainThread): On master: COMMIT
2020-08-12 19:01:58.608339 (MainThread): Using postgres connection "master".
2020-08-12 19:01:58.608518 (MainThread): On master: COMMIT
2020-08-12 19:01:58.609010 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:01:58.609284 (MainThread): On master: Close
2020-08-12 19:01:58.610132 (MainThread): 15:01:58 | 
2020-08-12 19:01:58.610330 (MainThread): 15:01:58 | Finished running 4 view models, 1 table model in 1.03s.
2020-08-12 19:01:58.610534 (MainThread): Connection 'master' was properly closed.
2020-08-12 19:01:58.610686 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 19:01:58.628347 (MainThread): 
2020-08-12 19:01:58.629249 (MainThread): Completed successfully
2020-08-12 19:01:58.629934 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-12 19:01:58.630600 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066c0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa172517d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa172be950>]}
2020-08-12 19:01:58.630973 (MainThread): Flushing usage events
2020-08-12 19:03:19.956748 (MainThread): Running with dbt=0.17.2
2020-08-12 19:03:20.040358 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 19:03:20.043525 (MainThread): Tracking: tracking
2020-08-12 19:03:20.061252 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22860690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22832a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa63710>]}
2020-08-12 19:03:20.091140 (MainThread): Partial parsing not enabled
2020-08-12 19:03:20.093468 (MainThread): Parsing macros/core.sql
2020-08-12 19:03:20.101467 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 19:03:20.112016 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 19:03:20.114173 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 19:03:20.136689 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 19:03:20.177451 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 19:03:20.205248 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 19:03:20.209298 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 19:03:20.218035 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 19:03:20.236092 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 19:03:20.245212 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 19:03:20.254244 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 19:03:20.260577 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 19:03:20.261762 (MainThread): Parsing macros/etc/query.sql
2020-08-12 19:03:20.263030 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 19:03:20.265343 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 19:03:20.277322 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 19:03:20.279906 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 19:03:20.282079 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 19:03:20.349966 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 19:03:20.351534 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 19:03:20.352681 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 19:03:20.354267 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 19:03:20.358320 (MainThread): Parsing macros/catalog.sql
2020-08-12 19:03:20.361596 (MainThread): Parsing macros/relations.sql
2020-08-12 19:03:20.363517 (MainThread): Parsing macros/adapters.sql
2020-08-12 19:03:20.392922 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 19:03:20.417286 (MainThread): Partial parsing not enabled
2020-08-12 19:03:20.460533 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:20.460716 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:03:20.523230 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:03:20.523427 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:03:20.545184 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:20.545474 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:03:20.562501 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:20.562689 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:03:20.579754 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:20.580034 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:03:20.718177 (MainThread): Found 5 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 19:03:20.719154 (MainThread): 
2020-08-12 19:03:20.719560 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:03:20.719691 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:03:20.729755 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 19:03:20.730064 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 19:03:20.748142 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 19:03:20.748320 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 19:03:20.758936 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.01 seconds
2020-08-12 19:03:20.763816 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 19:03:20.772525 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 19:03:20.772769 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 19:03:20.779636 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:03:20.779815 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 19:03:20.787295 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:03:20.787493 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:03:20.787605 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 19:03:20.791903 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.00 seconds
2020-08-12 19:03:20.796790 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 19:03:20.797300 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 19:03:20.808572 (MainThread): Using postgres connection "master".
2020-08-12 19:03:20.808742 (MainThread): On master: BEGIN
2020-08-12 19:03:20.818059 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:03:20.818302 (MainThread): Using postgres connection "master".
2020-08-12 19:03:20.818474 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 19:03:21.155776 (MainThread): SQL status: SELECT 47 in 0.34 seconds
2020-08-12 19:03:21.213613 (MainThread): On master: ROLLBACK
2020-08-12 19:03:21.214046 (MainThread): Using postgres connection "master".
2020-08-12 19:03:21.214198 (MainThread): On master: BEGIN
2020-08-12 19:03:21.214590 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:03:21.214728 (MainThread): On master: COMMIT
2020-08-12 19:03:21.214837 (MainThread): Using postgres connection "master".
2020-08-12 19:03:21.214930 (MainThread): On master: COMMIT
2020-08-12 19:03:21.215173 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:03:21.215316 (MainThread): On master: Close
2020-08-12 19:03:21.215737 (MainThread): 15:03:21 | Concurrency: 1 threads (target='dev')
2020-08-12 19:03:21.215939 (MainThread): 15:03:21 | 
2020-08-12 19:03:21.217877 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 19:03:21.219303 (Thread-1): 15:03:21 | 1 of 5 START view model dev.customer................................. [RUN]
2020-08-12 19:03:21.219733 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:03:21.219843 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:03:21.219973 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 19:03:21.237086 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 19:03:21.237642 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.283779 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:03:21.284029 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 19:03:21.292742 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:03:21.295385 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:03:21.295527 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:03:21.295873 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:03:21.301369 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 19:03:21.302037 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:03:21.302194 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 19:03:21.302599 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:03:21.302729 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:03:21.302835 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 19:03:21.306182 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:03:21.315082 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:03:21.315272 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 19:03:21.315983 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.318340 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:03:21.318475 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 19:03:21.319193 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.327384 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:03:21.327601 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:03:21.327745 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:03:21.328627 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:03:21.333019 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:03:21.333209 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:03:21.334627 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:03:21.337647 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.337984 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 19:03:21.338973 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce8c46d8-5e57-4c0b-9137-4463bda09345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22bc9f90>]}
2020-08-12 19:03:21.341002 (Thread-1): 15:03:21 | 1 of 5 OK created view model dev.customer............................ [CREATE VIEW in 0.12s]
2020-08-12 19:03:21.341334 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 19:03:21.341620 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 19:03:21.343506 (Thread-1): 15:03:21 | 2 of 5 START view model dev.customer_language_preference............. [RUN]
2020-08-12 19:03:21.343922 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:21.344034 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:03:21.344148 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 19:03:21.352321 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:03:21.354274 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.370712 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:21.371002 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 19:03:21.387547 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 19:03:21.389986 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:21.390174 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:03:21.390595 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:03:21.393160 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:03:21.393920 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:21.394202 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 19:03:21.395161 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:03:21.395746 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:21.396219 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with customer_language_preference as (
    SELECT DISTINCT ON (r.customer_id)
        r.customer_id,
        l.name as language
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film  f ON i.film_id = f.film_id 
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    GROUP BY r.customer_id, l.name
    ORDER BY r.customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 19:03:21.402943 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:03:21.407819 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:21.408065 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference" rename to "customer_language_preference__dbt_backup"
2020-08-12 19:03:21.408786 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.412167 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:21.412350 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 19:03:21.413186 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.414994 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:03:21.415203 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:21.415303 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:03:21.420738 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:03:21.422833 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:03:21.422951 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:03:21.424334 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:03:21.427122 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.427578 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 19:03:21.429077 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce8c46d8-5e57-4c0b-9137-4463bda09345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22c837d0>]}
2020-08-12 19:03:21.431480 (Thread-1): 15:03:21 | 2 of 5 OK created view model dev.customer_language_preference........ [CREATE VIEW in 0.08s]
2020-08-12 19:03:21.431805 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 19:03:21.432020 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 19:03:21.433392 (Thread-1): 15:03:21 | 3 of 5 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 19:03:21.433813 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:21.433933 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:03:21.434044 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 19:03:21.439754 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:03:21.440329 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.448483 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:21.448680 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 19:03:21.465445 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 19:03:21.469256 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:21.469433 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:03:21.469877 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:03:21.471364 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:03:21.471876 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:21.471988 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 19:03:21.472324 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:03:21.472444 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:21.472540 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 19:03:21.476191 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:03:21.480305 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:21.480459 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 19:03:21.481087 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.483691 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:21.483868 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 19:03:21.484413 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.485745 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:03:21.485888 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:21.485994 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:03:21.492624 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:03:21.495789 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:03:21.495989 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:03:21.497391 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:03:21.501039 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.501402 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 19:03:21.502115 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce8c46d8-5e57-4c0b-9137-4463bda09345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22c6db90>]}
2020-08-12 19:03:21.503661 (Thread-1): 15:03:21 | 3 of 5 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.07s]
2020-08-12 19:03:21.503989 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 19:03:21.504249 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 19:03:21.505872 (Thread-1): 15:03:21 | 4 of 5 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 19:03:21.506316 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:21.506456 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:03:21.506601 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 19:03:21.515801 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:03:21.516577 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.523511 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:21.523679 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 19:03:21.535521 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:03:21.543212 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:21.543641 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:03:21.544944 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:03:21.549815 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:03:21.552212 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:21.552503 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 19:03:21.553060 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:03:21.553303 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:21.553481 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 19:03:21.558268 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:03:21.563527 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:21.563703 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 19:03:21.564403 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.566955 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:21.567136 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 19:03:21.567829 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.569397 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:03:21.569534 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:21.569638 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:03:21.576220 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:03:21.578836 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:03:21.578988 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:03:21.581242 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:03:21.584273 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.584655 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 19:03:21.585789 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce8c46d8-5e57-4c0b-9137-4463bda09345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22d55250>]}
2020-08-12 19:03:21.587562 (Thread-1): 15:03:21 | 4 of 5 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.08s]
2020-08-12 19:03:21.587831 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 19:03:21.588305 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 19:03:21.589551 (Thread-1): 15:03:21 | 5 of 5 START table model dev.customer_profile........................ [RUN]
2020-08-12 19:03:21.589975 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:21.590133 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:03:21.590297 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 19:03:21.604966 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:03:21.605486 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.639364 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:21.639543 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 19:03:21.647725 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 19:03:21.651072 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:21.651247 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:03:21.651650 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:03:21.658469 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:03:21.659104 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:21.659255 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 19:03:21.659675 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:03:21.659828 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:21.659940 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
lang as (
    SELECT * FROM "dvd_rental"."dev"."customer_language_preference"
),
customer_profile as (
    SELECT 
        rental.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.num_rental,
        rental.period_days,
        ltv.life_time_value,
        lang.language
    FROM rental
    INNER JOIN ltv USING(customer_id)
    INNER JOIN customer USING(customer_id)
    INNER JOIN lang USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 19:03:21.722717 (Thread-1): SQL status: SELECT 599 in 0.06 seconds
2020-08-12 19:03:21.728321 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:21.728492 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile" rename to "customer_profile__dbt_backup"
2020-08-12 19:03:21.728996 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.731463 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:21.731604 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 19:03:21.732492 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:03:21.733785 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:03:21.733919 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:21.734016 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:03:21.735125 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:03:21.736905 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:03:21.737028 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:03:21.739276 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:03:21.742970 (Thread-1): finished collecting timing info
2020-08-12 19:03:21.743479 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 19:03:21.744279 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce8c46d8-5e57-4c0b-9137-4463bda09345', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22a444d0>]}
2020-08-12 19:03:21.745729 (Thread-1): 15:03:21 | 5 of 5 OK created table model dev.customer_profile................... [SELECT 599 in 0.15s]
2020-08-12 19:03:21.746024 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 19:03:21.848121 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:03:21.848492 (MainThread): Opening a new connection, currently in state closed
2020-08-12 19:03:21.848861 (MainThread): Using postgres connection "master".
2020-08-12 19:03:21.849137 (MainThread): On master: BEGIN
2020-08-12 19:03:21.861598 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:03:21.861914 (MainThread): On master: COMMIT
2020-08-12 19:03:21.862100 (MainThread): Using postgres connection "master".
2020-08-12 19:03:21.862282 (MainThread): On master: COMMIT
2020-08-12 19:03:21.862734 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:03:21.862982 (MainThread): On master: Close
2020-08-12 19:03:21.863646 (MainThread): 15:03:21 | 
2020-08-12 19:03:21.863943 (MainThread): 15:03:21 | Finished running 4 view models, 1 table model in 1.14s.
2020-08-12 19:03:21.864134 (MainThread): Connection 'master' was properly closed.
2020-08-12 19:03:21.864264 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 19:03:21.884903 (MainThread): 
2020-08-12 19:03:21.885123 (MainThread): Completed successfully
2020-08-12 19:03:21.885263 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-12 19:03:21.885503 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22c0f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22c7af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22c7aa50>]}
2020-08-12 19:03:21.885727 (MainThread): Flushing usage events
2020-08-12 19:39:15.470810 (MainThread): Running with dbt=0.17.2
2020-08-12 19:39:15.555665 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 19:39:15.557705 (MainThread): Tracking: tracking
2020-08-12 19:39:15.576364 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa17a49050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105028710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa17a394d0>]}
2020-08-12 19:39:15.602935 (MainThread): Partial parsing not enabled
2020-08-12 19:39:15.605283 (MainThread): Parsing macros/core.sql
2020-08-12 19:39:15.611337 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 19:39:15.623471 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 19:39:15.625717 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 19:39:15.648404 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 19:39:15.689164 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 19:39:15.717219 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 19:39:15.719715 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 19:39:15.729081 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 19:39:15.750125 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 19:39:15.760063 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 19:39:15.768563 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 19:39:15.775190 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 19:39:15.776401 (MainThread): Parsing macros/etc/query.sql
2020-08-12 19:39:15.777864 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 19:39:15.780023 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 19:39:15.792742 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 19:39:15.795619 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 19:39:15.797846 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 19:39:15.868036 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 19:39:15.869642 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 19:39:15.871124 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 19:39:15.872906 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 19:39:15.877193 (MainThread): Parsing macros/catalog.sql
2020-08-12 19:39:15.880789 (MainThread): Parsing macros/relations.sql
2020-08-12 19:39:15.882588 (MainThread): Parsing macros/adapters.sql
2020-08-12 19:39:15.909325 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 19:39:15.934316 (MainThread): Partial parsing not enabled
2020-08-12 19:39:15.978224 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:15.978473 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:39:16.017008 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.017186 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:39:16.031250 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:16.031420 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:39:16.045130 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:39:16.045361 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:39:16.058947 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:16.059121 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:39:16.070957 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 19:39:16.071135 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:39:16.084500 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:16.084671 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:39:16.223430 (MainThread): Found 7 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 19:39:16.224646 (MainThread): 
2020-08-12 19:39:16.225149 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:39:16.225313 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:39:16.239207 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 19:39:16.239653 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 19:39:16.254320 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 19:39:16.254663 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 19:39:16.270367 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.02 seconds
2020-08-12 19:39:16.273887 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 19:39:16.286878 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 19:39:16.287118 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 19:39:16.295814 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:39:16.296006 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 19:39:16.304610 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:39:16.304827 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:39:16.304943 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 19:39:16.310818 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.01 seconds
2020-08-12 19:39:16.316093 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 19:39:16.316494 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 19:39:16.335318 (MainThread): Using postgres connection "master".
2020-08-12 19:39:16.335491 (MainThread): On master: BEGIN
2020-08-12 19:39:16.344527 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:39:16.344817 (MainThread): Using postgres connection "master".
2020-08-12 19:39:16.345020 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 19:39:16.676372 (MainThread): SQL status: SELECT 47 in 0.33 seconds
2020-08-12 19:39:16.732117 (MainThread): On master: ROLLBACK
2020-08-12 19:39:16.732534 (MainThread): Using postgres connection "master".
2020-08-12 19:39:16.732676 (MainThread): On master: BEGIN
2020-08-12 19:39:16.733040 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:39:16.733187 (MainThread): On master: COMMIT
2020-08-12 19:39:16.733318 (MainThread): Using postgres connection "master".
2020-08-12 19:39:16.733430 (MainThread): On master: COMMIT
2020-08-12 19:39:16.733705 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:39:16.733864 (MainThread): On master: Close
2020-08-12 19:39:16.734442 (MainThread): 15:39:16 | Concurrency: 1 threads (target='dev')
2020-08-12 19:39:16.734720 (MainThread): 15:39:16 | 
2020-08-12 19:39:16.737407 (Thread-1): Began running node model.dbt_play.rental_payment
2020-08-12 19:39:16.739356 (Thread-1): 15:39:16 | 1 of 7 START view model dev.rental_payment........................... [RUN]
2020-08-12 19:39:16.739793 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:39:16.739974 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:39:16.740176 (Thread-1): Compiling model.dbt_play.rental_payment
2020-08-12 19:39:16.764136 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_payment"
2020-08-12 19:39:16.766885 (Thread-1): finished collecting timing info
2020-08-12 19:39:16.804713 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:39:16.804898 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_tmp" cascade
2020-08-12 19:39:16.813557 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:39:16.816422 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:39:16.816580 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 19:39:16.817032 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:16.822920 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_payment"
2020-08-12 19:39:16.823546 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:39:16.823675 (Thread-1): On model.dbt_play.rental_payment: BEGIN
2020-08-12 19:39:16.824052 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:39:16.824184 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:39:16.824287 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */

  create view "dvd_rental"."dev"."rental_payment__dbt_tmp" as (
    with rental_payment as(
    SELECT 
        rental_id, 
        sum(amount) as amount 
    FROM dvd_rental.public.payment 
    GROUP BY rental_id
)

SELECT * FROM rental_payment
  );

2020-08-12 19:39:16.835306 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:39:16.843537 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:39:16.843762 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment__dbt_tmp" rename to "rental_payment"
2020-08-12 19:39:16.844399 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:16.852170 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 19:39:16.852370 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:39:16.852491 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 19:39:16.853886 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:39:16.858436 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:39:16.858611 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 19:39:16.858955 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:16.861435 (Thread-1): finished collecting timing info
2020-08-12 19:39:16.861708 (Thread-1): On model.dbt_play.rental_payment: Close
2020-08-12 19:39:16.862683 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f479b62-999f-435e-852f-966b2278af8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa18168f10>]}
2020-08-12 19:39:16.864603 (Thread-1): 15:39:16 | 1 of 7 OK created view model dev.rental_payment...................... [CREATE VIEW in 0.12s]
2020-08-12 19:39:16.864883 (Thread-1): Finished running node model.dbt_play.rental_payment
2020-08-12 19:39:16.865173 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 19:39:16.866757 (Thread-1): 15:39:16 | 2 of 7 START view model dev.customer................................. [RUN]
2020-08-12 19:39:16.867811 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.868148 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:39:16.868411 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 19:39:16.879400 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 19:39:16.880243 (Thread-1): finished collecting timing info
2020-08-12 19:39:16.887105 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.887314 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 19:39:16.900691 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:39:16.905436 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.905896 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:39:16.907514 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:16.909450 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 19:39:16.910182 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.910343 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 19:39:16.910721 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:39:16.910884 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.911004 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 19:39:16.930212 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 19:39:16.935275 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.935473 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 19:39:16.936254 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:16.939661 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.939866 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 19:39:16.940553 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:16.941814 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:39:16.941954 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.942053 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:39:16.942844 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:39:16.945250 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:39:16.945471 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:39:16.947014 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:16.950375 (Thread-1): finished collecting timing info
2020-08-12 19:39:16.950744 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 19:39:16.952085 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f479b62-999f-435e-852f-966b2278af8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa18027490>]}
2020-08-12 19:39:16.953835 (Thread-1): 15:39:16 | 2 of 7 OK created view model dev.customer............................ [CREATE VIEW in 0.08s]
2020-08-12 19:39:16.954096 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 19:39:16.954380 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 19:39:16.956473 (Thread-1): 15:39:16 | 3 of 7 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 19:39:16.957106 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:16.957467 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:39:16.957655 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 19:39:16.963065 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:39:16.963699 (Thread-1): finished collecting timing info
2020-08-12 19:39:16.971037 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:16.971242 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 19:39:16.984488 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:39:16.988035 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:16.988659 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:39:16.989620 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:16.992209 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:39:16.993870 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:16.994638 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 19:39:16.995296 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:39:16.995530 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:16.995661 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 19:39:17.000069 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:39:17.005238 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:17.005441 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 19:39:17.006074 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:17.008597 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:17.008737 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 19:39:17.009369 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:17.010583 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:39:17.010712 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:17.010811 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:39:17.016899 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:39:17.019202 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:39:17.019346 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:39:17.020720 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:17.023832 (Thread-1): finished collecting timing info
2020-08-12 19:39:17.024151 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 19:39:17.024807 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f479b62-999f-435e-852f-966b2278af8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa182a7410>]}
2020-08-12 19:39:17.026498 (Thread-1): 15:39:17 | 3 of 7 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.07s]
2020-08-12 19:39:17.026763 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 19:39:17.027020 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 19:39:17.028607 (Thread-1): 15:39:17 | 4 of 7 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 19:39:17.029243 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:17.029440 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:39:17.029599 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 19:39:17.041519 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:39:17.042753 (Thread-1): finished collecting timing info
2020-08-12 19:39:17.052523 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:17.052768 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 19:39:17.077734 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 19:39:17.082503 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:17.082772 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:39:17.083470 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:17.087077 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:39:17.088602 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:17.089290 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 19:39:17.090881 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:39:17.092075 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:17.092813 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 19:39:17.111183 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 19:39:17.118078 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:17.118286 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 19:39:17.119142 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:17.123781 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:17.124041 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 19:39:17.126354 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:17.129643 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:39:17.130087 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:17.130326 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:39:17.132296 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:39:17.135851 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:39:17.136028 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:39:17.140383 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:17.143947 (Thread-1): finished collecting timing info
2020-08-12 19:39:17.144335 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 19:39:17.145341 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f479b62-999f-435e-852f-966b2278af8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa182ca290>]}
2020-08-12 19:39:17.147461 (Thread-1): 15:39:17 | 4 of 7 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.12s]
2020-08-12 19:39:17.147749 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 19:39:17.148004 (Thread-1): Began running node model.dbt_play.rental_details
2020-08-12 19:39:17.150615 (Thread-1): 15:39:17 | 5 of 7 START view model dev.rental_details........................... [RUN]
2020-08-12 19:39:17.151226 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 19:39:17.151436 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:39:17.151610 (Thread-1): Compiling model.dbt_play.rental_details
2020-08-12 19:39:17.166603 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_details"
2020-08-12 19:39:17.167438 (Thread-1): finished collecting timing info
2020-08-12 19:39:17.188031 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:39:17.188329 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_tmp" cascade
2020-08-12 19:39:17.227831 (Thread-1): SQL status: DROP VIEW in 0.04 seconds
2020-08-12 19:39:17.246371 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:39:17.246697 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 19:39:17.247158 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:17.248646 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_details"
2020-08-12 19:39:17.249202 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:39:17.249329 (Thread-1): On model.dbt_play.rental_details: BEGIN
2020-08-12 19:39:17.249697 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:39:17.249820 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:39:17.249920 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */

  create view "dvd_rental"."dev"."rental_details__dbt_tmp" as (
    with rental_payment as (
    SELECT * FROM "dvd_rental"."dev"."rental_payment"
),
rental_details as(
    SELECT
        r.rental_id,
        r.customer_id,
        r.rental_date,
        CASE WHEN r.return_date is null THEN FALSE ELSE TRUE END as returned,
        CASE WHEN date_part('day', return_date - rental_date) > f.rental_duration THEN TRUE ELSE FALSE END as late,
        CASE WHEN rental_payment.amount is null THEN FALSE WHEN rental_payment.amount <= 0 THEN FALSE ELSE TRUE END as paid,
        f.title as film_title,
        f.rating as film_rating,
        l.name as film_language,
        c.name as film_category,
        CASE WHEN rental_payment.amount is null THEN 0 ELSE rental_payment.amount END as payment_amount
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film f ON i.film_id = f.film_id
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    INNER JOIN dvd_rental.public.film_category fc ON f.film_id = fc.film_id
    INNER JOIN dvd_rental.public.category c ON fc.category_id = c.category_id
    LEFT JOIN rental_payment ON r.rental_id = rental_payment.rental_id
)

SELECT * FROM rental_details
  );

2020-08-12 19:39:17.262075 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:39:17.265480 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:39:17.265705 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
alter table "dvd_rental"."dev"."rental_details__dbt_tmp" rename to "rental_details"
2020-08-12 19:39:17.266568 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:17.268087 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 19:39:17.268281 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:39:17.268429 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 19:39:17.276150 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:39:17.282341 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:39:17.282631 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 19:39:17.283481 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:17.291699 (Thread-1): finished collecting timing info
2020-08-12 19:39:17.292152 (Thread-1): On model.dbt_play.rental_details: Close
2020-08-12 19:39:17.293084 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f479b62-999f-435e-852f-966b2278af8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa182ca150>]}
2020-08-12 19:39:17.295895 (Thread-1): 15:39:17 | 5 of 7 OK created view model dev.rental_details...................... [CREATE VIEW in 0.14s]
2020-08-12 19:39:17.296255 (Thread-1): Finished running node model.dbt_play.rental_details
2020-08-12 19:39:17.309287 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 19:39:17.311514 (Thread-1): 15:39:17 | 6 of 7 START view model dev.customer_language_preference............. [RUN]
2020-08-12 19:39:17.312795 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:17.313229 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:39:17.315084 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 19:39:17.346798 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:39:17.347707 (Thread-1): finished collecting timing info
2020-08-12 19:39:17.363218 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:17.363436 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 19:39:17.371982 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:39:17.380716 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:17.381550 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:39:17.382120 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:17.384460 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:39:17.385320 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:17.385556 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 19:39:17.386821 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:39:17.388248 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:17.389257 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_language_preference as (
    SELECT DISTINCT ON (customer_id)
        customer_id,
        film_language as language
    FROM rental_details
    GROUP BY customer_id, film_language
    ORDER BY customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 19:39:17.404644 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:39:17.411060 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:17.411240 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference" rename to "customer_language_preference__dbt_backup"
2020-08-12 19:39:17.412278 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:17.414915 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:17.415060 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 19:39:17.415665 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:17.417135 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:39:17.417288 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:17.417398 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:39:17.418142 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:39:17.476745 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:39:17.477072 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:39:17.479218 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:39:17.484126 (Thread-1): finished collecting timing info
2020-08-12 19:39:17.484907 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 19:39:17.485990 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f479b62-999f-435e-852f-966b2278af8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa17e94050>]}
2020-08-12 19:39:17.488421 (Thread-1): 15:39:17 | 6 of 7 OK created view model dev.customer_language_preference........ [CREATE VIEW in 0.17s]
2020-08-12 19:39:17.488727 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 19:39:17.489321 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 19:39:17.491715 (Thread-1): 15:39:17 | 7 of 7 START table model dev.customer_profile........................ [RUN]
2020-08-12 19:39:17.492220 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:17.492340 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:39:17.492452 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 19:39:17.507423 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:39:17.508542 (Thread-1): finished collecting timing info
2020-08-12 19:39:17.556014 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:17.556273 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 19:39:17.565778 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 19:39:17.569736 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:17.570129 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:39:17.570597 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:39:17.580539 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:39:17.581394 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:17.581588 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 19:39:17.582019 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:39:17.582181 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:17.582324 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
lang as (
    SELECT * FROM "dvd_rental"."dev"."customer_language_preference"
),
customer_profile as (
    SELECT 
        rental.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.num_rental,
        rental.period_days,
        ltv.life_time_value,
        lang.language
    FROM rental
    INNER JOIN ltv USING(customer_id)
    INNER JOIN customer USING(customer_id)
    INNER JOIN lang USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 19:39:17.663306 (Thread-1): SQL status: SELECT 599 in 0.08 seconds
2020-08-12 19:39:17.667955 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:17.668130 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile" rename to "customer_profile__dbt_backup"
2020-08-12 19:39:17.668678 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:17.671424 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:17.671605 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 19:39:17.672472 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:39:17.673891 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:39:17.674069 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:17.674175 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:39:17.675139 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:39:17.677525 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:39:17.677707 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:39:17.680645 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:39:17.684311 (Thread-1): finished collecting timing info
2020-08-12 19:39:17.684772 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 19:39:17.685885 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f479b62-999f-435e-852f-966b2278af8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa17ed0050>]}
2020-08-12 19:39:17.688211 (Thread-1): 15:39:17 | 7 of 7 OK created table model dev.customer_profile................... [SELECT 599 in 0.19s]
2020-08-12 19:39:17.688642 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 19:39:17.700572 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:39:17.700958 (MainThread): Opening a new connection, currently in state closed
2020-08-12 19:39:17.701517 (MainThread): Using postgres connection "master".
2020-08-12 19:39:17.701877 (MainThread): On master: BEGIN
2020-08-12 19:39:17.714504 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:39:17.714725 (MainThread): On master: COMMIT
2020-08-12 19:39:17.714850 (MainThread): Using postgres connection "master".
2020-08-12 19:39:17.714960 (MainThread): On master: COMMIT
2020-08-12 19:39:17.715260 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:39:17.715426 (MainThread): On master: Close
2020-08-12 19:39:17.715917 (MainThread): 15:39:17 | 
2020-08-12 19:39:17.716092 (MainThread): 15:39:17 | Finished running 6 view models, 1 table model in 1.49s.
2020-08-12 19:39:17.716265 (MainThread): Connection 'master' was properly closed.
2020-08-12 19:39:17.716393 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 19:39:17.755394 (MainThread): 
2020-08-12 19:39:17.755679 (MainThread): Completed successfully
2020-08-12 19:39:17.755886 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2020-08-12 19:39:17.756172 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa17edb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa17fcb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa181a1b50>]}
2020-08-12 19:39:17.756471 (MainThread): Flushing usage events
2020-08-12 19:52:27.605103 (MainThread): Running with dbt=0.17.2
2020-08-12 19:52:27.725978 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 19:52:27.728600 (MainThread): Tracking: tracking
2020-08-12 19:52:27.762110 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d1bb890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d13c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d1ab190>]}
2020-08-12 19:52:27.804479 (MainThread): Partial parsing not enabled
2020-08-12 19:52:27.806901 (MainThread): Parsing macros/core.sql
2020-08-12 19:52:27.817136 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 19:52:27.829055 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 19:52:27.831723 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 19:52:27.853696 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 19:52:27.896819 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 19:52:27.925369 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 19:52:27.928022 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 19:52:27.937067 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 19:52:27.957199 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 19:52:27.966929 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 19:52:27.976176 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 19:52:27.985593 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 19:52:27.987265 (MainThread): Parsing macros/etc/query.sql
2020-08-12 19:52:27.988746 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 19:52:27.990774 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 19:52:28.003322 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 19:52:28.005812 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 19:52:28.007915 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 19:52:28.102061 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 19:52:28.104555 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 19:52:28.107419 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 19:52:28.113233 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 19:52:28.118774 (MainThread): Parsing macros/catalog.sql
2020-08-12 19:52:28.123941 (MainThread): Parsing macros/relations.sql
2020-08-12 19:52:28.127493 (MainThread): Parsing macros/adapters.sql
2020-08-12 19:52:28.156908 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 19:52:28.188759 (MainThread): Partial parsing not enabled
2020-08-12 19:52:28.235864 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:52:28.236038 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:52:28.290543 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:52:28.290719 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:52:28.303592 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:28.303770 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:52:28.317680 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:28.317892 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:52:28.329567 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:28.329733 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:52:28.348367 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 19:52:28.348566 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:52:28.363735 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:52:28.363907 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:52:28.383860 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:52:28.384052 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:52:28.533669 (MainThread): Found 8 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 19:52:28.535316 (MainThread): 
2020-08-12 19:52:28.536169 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:52:28.536452 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:52:28.555863 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 19:52:28.556135 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 19:52:28.570515 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 19:52:28.570700 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 19:52:28.581680 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.01 seconds
2020-08-12 19:52:28.584617 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 19:52:28.597572 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 19:52:28.597787 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 19:52:28.605267 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:52:28.605455 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 19:52:28.613285 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:52:28.613574 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:52:28.613763 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 19:52:28.617893 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.00 seconds
2020-08-12 19:52:28.625182 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 19:52:28.625565 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 19:52:28.640507 (MainThread): Using postgres connection "master".
2020-08-12 19:52:28.640679 (MainThread): On master: BEGIN
2020-08-12 19:52:28.648161 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:52:28.648478 (MainThread): Using postgres connection "master".
2020-08-12 19:52:28.649138 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 19:52:29.028452 (MainThread): SQL status: SELECT 52 in 0.38 seconds
2020-08-12 19:52:29.090626 (MainThread): On master: ROLLBACK
2020-08-12 19:52:29.091043 (MainThread): Using postgres connection "master".
2020-08-12 19:52:29.091168 (MainThread): On master: BEGIN
2020-08-12 19:52:29.091564 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:52:29.091697 (MainThread): On master: COMMIT
2020-08-12 19:52:29.091808 (MainThread): Using postgres connection "master".
2020-08-12 19:52:29.091901 (MainThread): On master: COMMIT
2020-08-12 19:52:29.092143 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:52:29.092283 (MainThread): On master: Close
2020-08-12 19:52:29.092745 (MainThread): 15:52:29 | Concurrency: 1 threads (target='dev')
2020-08-12 19:52:29.092951 (MainThread): 15:52:29 | 
2020-08-12 19:52:29.095876 (Thread-1): Began running node model.dbt_play.rental_payment
2020-08-12 19:52:29.097993 (Thread-1): 15:52:29 | 1 of 8 START view model dev.rental_payment........................... [RUN]
2020-08-12 19:52:29.098578 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:29.098794 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:52:29.099018 (Thread-1): Compiling model.dbt_play.rental_payment
2020-08-12 19:52:29.125395 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_payment"
2020-08-12 19:52:29.126024 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.162411 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:29.162590 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_tmp" cascade
2020-08-12 19:52:29.172592 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:52:29.175326 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:29.175489 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 19:52:29.175856 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.182721 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_payment"
2020-08-12 19:52:29.183394 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:29.183512 (Thread-1): On model.dbt_play.rental_payment: BEGIN
2020-08-12 19:52:29.183875 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:52:29.183984 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:29.184079 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */

  create view "dvd_rental"."dev"."rental_payment__dbt_tmp" as (
    with rental_payment as(
    SELECT 
        rental_id, 
        sum(amount) as amount 
    FROM dvd_rental.public.payment 
    GROUP BY rental_id
)

SELECT * FROM rental_payment
  );

2020-08-12 19:52:29.187410 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:52:29.197797 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:29.197986 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment" rename to "rental_payment__dbt_backup"
2020-08-12 19:52:29.198590 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.200897 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:29.201031 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment__dbt_tmp" rename to "rental_payment"
2020-08-12 19:52:29.201640 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.209462 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 19:52:29.209659 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:29.209761 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 19:52:29.210841 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:52:29.214817 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:52:29.214980 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 19:52:29.217637 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.220660 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.220972 (Thread-1): On model.dbt_play.rental_payment: Close
2020-08-12 19:52:29.221591 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d29382-aca3-46e2-bf57-f69515c56955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d85fd50>]}
2020-08-12 19:52:29.222825 (Thread-1): 15:52:29 | 1 of 8 OK created view model dev.rental_payment...................... [CREATE VIEW in 0.12s]
2020-08-12 19:52:29.223070 (Thread-1): Finished running node model.dbt_play.rental_payment
2020-08-12 19:52:29.223291 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 19:52:29.224473 (Thread-1): 15:52:29 | 2 of 8 START view model dev.customer................................. [RUN]
2020-08-12 19:52:29.224976 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:52:29.225145 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:52:29.225270 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 19:52:29.233357 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 19:52:29.234000 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.240944 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:52:29.241129 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 19:52:29.254875 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:52:29.257377 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:52:29.257526 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:52:29.257885 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.259101 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 19:52:29.259684 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:52:29.259813 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 19:52:29.260166 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:52:29.260308 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:52:29.260429 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 19:52:29.267186 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:52:29.271682 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:52:29.271865 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 19:52:29.272529 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.275014 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:52:29.275145 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 19:52:29.275911 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.277259 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:52:29.277406 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:52:29.277629 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:52:29.284394 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:52:29.286570 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:52:29.286736 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:52:29.288435 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.292034 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.292589 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 19:52:29.293477 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d29382-aca3-46e2-bf57-f69515c56955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d85fd50>]}
2020-08-12 19:52:29.296043 (Thread-1): 15:52:29 | 2 of 8 OK created view model dev.customer............................ [CREATE VIEW in 0.07s]
2020-08-12 19:52:29.296469 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 19:52:29.296754 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 19:52:29.298776 (Thread-1): 15:52:29 | 3 of 8 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 19:52:29.299235 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:29.299384 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:52:29.299521 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 19:52:29.307237 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:52:29.307730 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.322001 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:29.322200 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 19:52:29.332097 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:52:29.337392 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:29.337576 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:52:29.337943 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.339289 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:52:29.339887 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:29.340081 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 19:52:29.340549 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:52:29.340688 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:29.340798 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 19:52:29.344588 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:52:29.351873 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:29.352173 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 19:52:29.352888 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.355752 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:29.355943 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 19:52:29.356870 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.358723 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:52:29.358945 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:29.359103 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:52:29.365780 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:52:29.369163 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:52:29.369360 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:52:29.370650 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.374035 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.374345 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 19:52:29.374959 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d29382-aca3-46e2-bf57-f69515c56955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d9bf810>]}
2020-08-12 19:52:29.376158 (Thread-1): 15:52:29 | 3 of 8 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.08s]
2020-08-12 19:52:29.376398 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 19:52:29.376720 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 19:52:29.378782 (Thread-1): 15:52:29 | 4 of 8 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 19:52:29.379243 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:29.379448 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:52:29.379773 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 19:52:29.387406 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:52:29.388284 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.400068 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:29.400683 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 19:52:29.411781 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:52:29.419885 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:29.420074 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:52:29.420452 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.421810 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:52:29.422282 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:29.422397 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 19:52:29.422749 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:52:29.422877 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:29.422976 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 19:52:29.427617 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:52:29.431779 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:29.431946 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 19:52:29.432659 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.435121 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:29.435297 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 19:52:29.435983 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.437328 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:52:29.437481 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:29.437580 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:52:29.444783 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:52:29.447139 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:52:29.447308 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:52:29.449019 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.452203 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.452646 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 19:52:29.453377 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d29382-aca3-46e2-bf57-f69515c56955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d90f890>]}
2020-08-12 19:52:29.454860 (Thread-1): 15:52:29 | 4 of 8 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.07s]
2020-08-12 19:52:29.455182 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 19:52:29.455476 (Thread-1): Began running node model.dbt_play.rental_details
2020-08-12 19:52:29.457280 (Thread-1): 15:52:29 | 5 of 8 START view model dev.rental_details........................... [RUN]
2020-08-12 19:52:29.457911 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 19:52:29.458122 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:52:29.458300 (Thread-1): Compiling model.dbt_play.rental_details
2020-08-12 19:52:29.473370 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_details"
2020-08-12 19:52:29.474104 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.492721 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:52:29.493025 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_tmp" cascade
2020-08-12 19:52:29.505791 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:52:29.509232 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:52:29.509619 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 19:52:29.510675 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.513139 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_details"
2020-08-12 19:52:29.514043 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:52:29.514266 (Thread-1): On model.dbt_play.rental_details: BEGIN
2020-08-12 19:52:29.514806 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:52:29.515003 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:52:29.515122 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */

  create view "dvd_rental"."dev"."rental_details__dbt_tmp" as (
    with rental_payment as (
    SELECT * FROM "dvd_rental"."dev"."rental_payment"
),
rental_details as(
    SELECT
        r.rental_id,
        r.customer_id,
        r.rental_date,
        CASE WHEN r.return_date is null THEN FALSE ELSE TRUE END as returned,
        CASE WHEN date_part('day', return_date - rental_date) > f.rental_duration THEN TRUE ELSE FALSE END as late,
        CASE WHEN rental_payment.amount is null THEN FALSE WHEN rental_payment.amount <= 0 THEN FALSE ELSE TRUE END as paid,
        f.title as film_title,
        f.rating as film_rating,
        l.name as film_language,
        c.name as film_category,
        CASE WHEN rental_payment.amount is null THEN 0 ELSE rental_payment.amount END as payment_amount
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film f ON i.film_id = f.film_id
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    INNER JOIN dvd_rental.public.film_category fc ON f.film_id = fc.film_id
    INNER JOIN dvd_rental.public.category c ON fc.category_id = c.category_id
    LEFT JOIN rental_payment ON r.rental_id = rental_payment.rental_id
)

SELECT * FROM rental_details
  );

2020-08-12 19:52:29.522713 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:52:29.525630 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:52:29.525816 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
alter table "dvd_rental"."dev"."rental_details__dbt_tmp" rename to "rental_details"
2020-08-12 19:52:29.526787 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.528266 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 19:52:29.528461 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:52:29.528572 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 19:52:29.535119 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:52:29.537255 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:52:29.537454 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 19:52:29.537798 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.541090 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.541458 (Thread-1): On model.dbt_play.rental_details: Close
2020-08-12 19:52:29.542499 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d29382-aca3-46e2-bf57-f69515c56955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d7cb690>]}
2020-08-12 19:52:29.544168 (Thread-1): 15:52:29 | 5 of 8 OK created view model dev.rental_details...................... [CREATE VIEW in 0.08s]
2020-08-12 19:52:29.544408 (Thread-1): Finished running node model.dbt_play.rental_details
2020-08-12 19:52:29.544914 (Thread-1): Began running node model.dbt_play.customer_behaviour
2020-08-12 19:52:29.546671 (Thread-1): 15:52:29 | 6 of 8 START view model dev.customer_behaviour....................... [RUN]
2020-08-12 19:52:29.547299 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:52:29.547531 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:52:29.547737 (Thread-1): Compiling model.dbt_play.customer_behaviour
2020-08-12 19:52:29.566939 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 19:52:29.570084 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.589528 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:52:29.589801 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_tmp" cascade
2020-08-12 19:52:29.599746 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:52:29.650887 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:52:29.651074 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 19:52:29.651471 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.652796 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 19:52:29.653339 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:52:29.653482 (Thread-1): On model.dbt_play.customer_behaviour: BEGIN
2020-08-12 19:52:29.653855 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:52:29.653980 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:52:29.654084 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */

  create view "dvd_rental"."dev"."customer_behaviour__dbt_tmp" as (
    with rental_details as (
    SELECT 
        customerid,
        returned,
        late, 
        paid
    FROM "dvd_rental"."dev"."rental_details"
),
customer_behaviour as(
    SELECT 
        customer_id, 
        sum(cast(returned as int)) as return_num, 
        sum(cast(late as int)) as late_num, 
        sum(cast(paid as int)) as paid_num 
    FROM rental_details 
    GROUP BY customer_id
)

SELECT * FROM customer_behaviour
  );

2020-08-12 19:52:29.655621 (Thread-1): Postgres error: column "customerid" does not exist
LINE 6:         customerid,
                ^
HINT:  Perhaps you meant to reference the column "rental_details.customer_id".

2020-08-12 19:52:29.655810 (Thread-1): On model.dbt_play.customer_behaviour: ROLLBACK
2020-08-12 19:52:29.656081 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.656392 (Thread-1): On model.dbt_play.customer_behaviour: Close
2020-08-12 19:52:29.656766 (Thread-1): Database Error in model customer_behaviour (models/staging/customer_behaviour.sql)
  column "customerid" does not exist
  LINE 6:         customerid,
                  ^
  HINT:  Perhaps you meant to reference the column "rental_details.customer_id".
  compiled SQL at target/run/dbt_play/models/staging/customer_behaviour.sql
Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 77, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "customerid" does not exist
LINE 6:         customerid,
                ^
HINT:  Perhaps you meant to reference the column "rental_details.customer_id".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 122, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 85, in add_query
    return connection, cursor
  File "/Users/sean/opt/anaconda3/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_behaviour (models/staging/customer_behaviour.sql)
  column "customerid" does not exist
  LINE 6:         customerid,
                  ^
  HINT:  Perhaps you meant to reference the column "rental_details.customer_id".
  compiled SQL at target/run/dbt_play/models/staging/customer_behaviour.sql
2020-08-12 19:52:29.659145 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d29382-aca3-46e2-bf57-f69515c56955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d877610>]}
2020-08-12 19:52:29.660406 (Thread-1): 15:52:29 | 6 of 8 ERROR creating view model dev.customer_behaviour.............. [ERROR in 0.11s]
2020-08-12 19:52:29.660589 (Thread-1): Finished running node model.dbt_play.customer_behaviour
2020-08-12 19:52:29.660840 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 19:52:29.662686 (Thread-1): 15:52:29 | 7 of 8 START view model dev.customer_language_preference............. [RUN]
2020-08-12 19:52:29.663144 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:52:29.663295 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:52:29.663605 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 19:52:29.676210 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:52:29.678314 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.689932 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:52:29.690122 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 19:52:29.703556 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:52:29.707347 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:52:29.707527 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:52:29.707955 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.709327 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:52:29.710196 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:52:29.710452 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 19:52:29.710822 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:52:29.710943 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:52:29.711043 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_language_preference as (
    SELECT DISTINCT ON (customer_id)
        customer_id,
        film_language as language
    FROM rental_details
    GROUP BY customer_id, film_language
    ORDER BY customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 19:52:29.718092 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:52:29.720760 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:52:29.721012 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 19:52:29.721656 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:52:29.723145 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:52:29.723324 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:52:29.723427 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:52:29.729623 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:52:29.732119 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:52:29.732306 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:52:29.732652 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:52:29.735447 (Thread-1): finished collecting timing info
2020-08-12 19:52:29.735820 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 19:52:29.736541 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95d29382-aca3-46e2-bf57-f69515c56955', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d877a90>]}
2020-08-12 19:52:29.737885 (Thread-1): 15:52:29 | 7 of 8 OK created view model dev.customer_language_preference........ [CREATE VIEW in 0.07s]
2020-08-12 19:52:29.738137 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 19:52:29.738562 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 19:52:29.738744 (Thread-1): 15:52:29 | 8 of 8 SKIP relation dev.customer_profile............................ [SKIP]
2020-08-12 19:52:29.738887 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 19:52:29.755721 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:52:29.755944 (MainThread): Opening a new connection, currently in state closed
2020-08-12 19:52:29.756115 (MainThread): Using postgres connection "master".
2020-08-12 19:52:29.756231 (MainThread): On master: BEGIN
2020-08-12 19:52:29.767183 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:52:29.767558 (MainThread): On master: COMMIT
2020-08-12 19:52:29.767692 (MainThread): Using postgres connection "master".
2020-08-12 19:52:29.767815 (MainThread): On master: COMMIT
2020-08-12 19:52:29.768119 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:52:29.768379 (MainThread): On master: Close
2020-08-12 19:52:29.768877 (MainThread): 15:52:29 | 
2020-08-12 19:52:29.769060 (MainThread): 15:52:29 | Finished running 7 view models, 1 table model in 1.23s.
2020-08-12 19:52:29.769242 (MainThread): Connection 'master' was properly closed.
2020-08-12 19:52:29.769382 (MainThread): Connection 'model.dbt_play.customer_language_preference' was properly closed.
2020-08-12 19:52:29.800585 (MainThread): 
2020-08-12 19:52:29.801252 (MainThread): Completed with 1 error and 0 warnings:
2020-08-12 19:52:29.801902 (MainThread): 
2020-08-12 19:52:29.802583 (MainThread): Database Error in model customer_behaviour (models/staging/customer_behaviour.sql)
2020-08-12 19:52:29.802737 (MainThread):   column "customerid" does not exist
2020-08-12 19:52:29.802853 (MainThread):   LINE 6:         customerid,
2020-08-12 19:52:29.802978 (MainThread):                   ^
2020-08-12 19:52:29.803085 (MainThread):   HINT:  Perhaps you meant to reference the column "rental_details.customer_id".
2020-08-12 19:52:29.803198 (MainThread):   compiled SQL at target/run/dbt_play/models/staging/customer_behaviour.sql
2020-08-12 19:52:29.803330 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=1 TOTAL=8
2020-08-12 19:52:29.803538 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d766450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d1b1590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d869650>]}
2020-08-12 19:52:29.803768 (MainThread): Flushing usage events
2020-08-12 19:53:16.470946 (MainThread): Running with dbt=0.17.2
2020-08-12 19:53:16.545702 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 19:53:16.547339 (MainThread): Tracking: tracking
2020-08-12 19:53:16.565999 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa14043190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014a4450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014a4490>]}
2020-08-12 19:53:16.605203 (MainThread): Partial parsing not enabled
2020-08-12 19:53:16.607491 (MainThread): Parsing macros/core.sql
2020-08-12 19:53:16.614470 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 19:53:16.625743 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 19:53:16.627983 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 19:53:16.652425 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 19:53:16.694159 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 19:53:16.721281 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 19:53:16.723865 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 19:53:16.732053 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 19:53:16.750376 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 19:53:16.765138 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 19:53:16.774517 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 19:53:16.780695 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 19:53:16.781862 (MainThread): Parsing macros/etc/query.sql
2020-08-12 19:53:16.783352 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 19:53:16.786340 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 19:53:16.799144 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 19:53:16.801965 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 19:53:16.804036 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 19:53:16.871681 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 19:53:16.873275 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 19:53:16.874385 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 19:53:16.875688 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 19:53:16.878880 (MainThread): Parsing macros/catalog.sql
2020-08-12 19:53:16.882088 (MainThread): Parsing macros/relations.sql
2020-08-12 19:53:16.884204 (MainThread): Parsing macros/adapters.sql
2020-08-12 19:53:16.912705 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 19:53:16.936449 (MainThread): Partial parsing not enabled
2020-08-12 19:53:16.978720 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:53:16.978888 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:53:17.018793 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:53:17.018958 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:53:17.032136 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:17.032301 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:53:17.044331 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.044505 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:53:17.056074 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:17.056249 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:53:17.068518 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 19:53:17.068770 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:53:17.083114 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:53:17.083292 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:53:17.098628 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:53:17.098812 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:53:17.236584 (MainThread): Found 8 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 19:53:17.238011 (MainThread): 
2020-08-12 19:53:17.238743 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:53:17.238907 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:53:17.255309 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 19:53:17.256056 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 19:53:17.276203 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 19:53:17.276393 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 19:53:17.288139 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.01 seconds
2020-08-12 19:53:17.293812 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 19:53:17.305389 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 19:53:17.305604 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 19:53:17.313247 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:53:17.313432 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 19:53:17.320988 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:53:17.321172 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:53:17.321280 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 19:53:17.325908 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.00 seconds
2020-08-12 19:53:17.333125 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 19:53:17.333508 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 19:53:17.348428 (MainThread): Using postgres connection "master".
2020-08-12 19:53:17.348596 (MainThread): On master: BEGIN
2020-08-12 19:53:17.356322 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:53:17.356527 (MainThread): Using postgres connection "master".
2020-08-12 19:53:17.356645 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 19:53:17.746220 (MainThread): SQL status: SELECT 52 in 0.39 seconds
2020-08-12 19:53:17.843944 (MainThread): On master: ROLLBACK
2020-08-12 19:53:17.844349 (MainThread): Using postgres connection "master".
2020-08-12 19:53:17.844474 (MainThread): On master: BEGIN
2020-08-12 19:53:17.844810 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:53:17.844955 (MainThread): On master: COMMIT
2020-08-12 19:53:17.845079 (MainThread): Using postgres connection "master".
2020-08-12 19:53:17.845185 (MainThread): On master: COMMIT
2020-08-12 19:53:17.845420 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:53:17.845582 (MainThread): On master: Close
2020-08-12 19:53:17.846007 (MainThread): 15:53:17 | Concurrency: 1 threads (target='dev')
2020-08-12 19:53:17.846437 (MainThread): 15:53:17 | 
2020-08-12 19:53:17.848425 (Thread-1): Began running node model.dbt_play.rental_payment
2020-08-12 19:53:17.850410 (Thread-1): 15:53:17 | 1 of 8 START view model dev.rental_payment........................... [RUN]
2020-08-12 19:53:17.851043 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.851906 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:53:17.852833 (Thread-1): Compiling model.dbt_play.rental_payment
2020-08-12 19:53:17.873651 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_payment"
2020-08-12 19:53:17.874839 (Thread-1): finished collecting timing info
2020-08-12 19:53:17.912942 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.913178 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_tmp" cascade
2020-08-12 19:53:17.922101 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:53:17.925940 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.926122 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 19:53:17.926507 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:17.931669 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_payment"
2020-08-12 19:53:17.932272 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.932419 (Thread-1): On model.dbt_play.rental_payment: BEGIN
2020-08-12 19:53:17.932805 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:53:17.932931 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.933037 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */

  create view "dvd_rental"."dev"."rental_payment__dbt_tmp" as (
    with rental_payment as(
    SELECT 
        rental_id, 
        sum(amount) as amount 
    FROM dvd_rental.public.payment 
    GROUP BY rental_id
)

SELECT * FROM rental_payment
  );

2020-08-12 19:53:17.936466 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:53:17.946276 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.946488 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment" rename to "rental_payment__dbt_backup"
2020-08-12 19:53:17.947211 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:17.950049 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.950254 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment__dbt_tmp" rename to "rental_payment"
2020-08-12 19:53:17.950876 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:17.962697 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 19:53:17.962883 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.962983 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 19:53:17.963648 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:53:17.967637 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:53:17.967819 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 19:53:17.971301 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:17.974048 (Thread-1): finished collecting timing info
2020-08-12 19:53:17.974398 (Thread-1): On model.dbt_play.rental_payment: Close
2020-08-12 19:53:17.975079 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f36e55-5342-4bcc-b4e1-4550d998ae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa146cf850>]}
2020-08-12 19:53:17.976294 (Thread-1): 15:53:17 | 1 of 8 OK created view model dev.rental_payment...................... [CREATE VIEW in 0.12s]
2020-08-12 19:53:17.976898 (Thread-1): Finished running node model.dbt_play.rental_payment
2020-08-12 19:53:17.977163 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 19:53:17.978888 (Thread-1): 15:53:17 | 2 of 8 START view model dev.customer................................. [RUN]
2020-08-12 19:53:17.979472 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:53:17.979662 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:53:17.979791 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 19:53:18.000349 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 19:53:18.001070 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.013138 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:53:18.013440 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 19:53:18.022489 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:53:18.025382 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:53:18.025549 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:53:18.026204 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.027937 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 19:53:18.028510 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:53:18.028629 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 19:53:18.028991 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:53:18.029106 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:53:18.029208 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 19:53:18.033135 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:53:18.037637 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:53:18.037793 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 19:53:18.038491 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:18.041524 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:53:18.041688 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 19:53:18.042368 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:18.043800 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:53:18.043972 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:53:18.044093 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:53:18.050854 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:53:18.053888 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:53:18.054105 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:53:18.055799 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.059502 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.059892 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 19:53:18.060614 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f36e55-5342-4bcc-b4e1-4550d998ae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa140491d0>]}
2020-08-12 19:53:18.062086 (Thread-1): 15:53:18 | 2 of 8 OK created view model dev.customer............................ [CREATE VIEW in 0.08s]
2020-08-12 19:53:18.062363 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 19:53:18.062622 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 19:53:18.063910 (Thread-1): 15:53:18 | 3 of 8 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 19:53:18.064385 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:18.064522 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:53:18.064648 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 19:53:18.076370 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:53:18.076919 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.083482 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:18.083620 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 19:53:18.095241 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:53:18.097944 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:18.098123 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:53:18.098523 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.099885 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:53:18.100399 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:18.100630 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 19:53:18.101233 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:53:18.101366 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:18.101465 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 19:53:18.104650 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:53:18.108890 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:18.109079 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 19:53:18.109745 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:18.112655 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:18.112825 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 19:53:18.113353 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:18.114700 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:53:18.114824 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:18.114920 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:53:18.121348 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:53:18.124685 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:53:18.124923 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:53:18.126841 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.129581 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.129852 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 19:53:18.130559 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f36e55-5342-4bcc-b4e1-4550d998ae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1487d590>]}
2020-08-12 19:53:18.132096 (Thread-1): 15:53:18 | 3 of 8 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.07s]
2020-08-12 19:53:18.132351 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 19:53:18.132636 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 19:53:18.133759 (Thread-1): 15:53:18 | 4 of 8 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 19:53:18.134254 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:18.134390 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:53:18.134506 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 19:53:18.142241 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:53:18.142833 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.149367 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:18.149512 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 19:53:18.163035 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:53:18.165579 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:18.165716 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:53:18.166081 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.167753 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:53:18.169549 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:18.169838 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 19:53:18.170590 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:53:18.170808 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:18.170925 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 19:53:18.177469 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:53:18.182203 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:18.182395 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 19:53:18.183173 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:18.187735 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:18.187937 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 19:53:18.188924 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:18.190667 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:53:18.190817 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:18.190915 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:53:18.196366 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:53:18.199083 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:53:18.199221 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:53:18.200685 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.203722 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.204109 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 19:53:18.205458 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f36e55-5342-4bcc-b4e1-4550d998ae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa14861f10>]}
2020-08-12 19:53:18.207136 (Thread-1): 15:53:18 | 4 of 8 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.07s]
2020-08-12 19:53:18.207359 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 19:53:18.207670 (Thread-1): Began running node model.dbt_play.rental_details
2020-08-12 19:53:18.209557 (Thread-1): 15:53:18 | 5 of 8 START view model dev.rental_details........................... [RUN]
2020-08-12 19:53:18.210185 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 19:53:18.210512 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:53:18.210728 (Thread-1): Compiling model.dbt_play.rental_details
2020-08-12 19:53:18.226925 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_details"
2020-08-12 19:53:18.227503 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.236093 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:53:18.236305 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_tmp" cascade
2020-08-12 19:53:18.246702 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:53:18.249775 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:53:18.249960 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 19:53:18.250361 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.253235 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_details"
2020-08-12 19:53:18.253819 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:53:18.253938 (Thread-1): On model.dbt_play.rental_details: BEGIN
2020-08-12 19:53:18.254315 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:53:18.254430 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:53:18.254527 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */

  create view "dvd_rental"."dev"."rental_details__dbt_tmp" as (
    with rental_payment as (
    SELECT * FROM "dvd_rental"."dev"."rental_payment"
),
rental_details as(
    SELECT
        r.rental_id,
        r.customer_id,
        r.rental_date,
        CASE WHEN r.return_date is null THEN FALSE ELSE TRUE END as returned,
        CASE WHEN date_part('day', return_date - rental_date) > f.rental_duration THEN TRUE ELSE FALSE END as late,
        CASE WHEN rental_payment.amount is null THEN FALSE WHEN rental_payment.amount <= 0 THEN FALSE ELSE TRUE END as paid,
        f.title as film_title,
        f.rating as film_rating,
        l.name as film_language,
        c.name as film_category,
        CASE WHEN rental_payment.amount is null THEN 0 ELSE rental_payment.amount END as payment_amount
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film f ON i.film_id = f.film_id
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    INNER JOIN dvd_rental.public.film_category fc ON f.film_id = fc.film_id
    INNER JOIN dvd_rental.public.category c ON fc.category_id = c.category_id
    LEFT JOIN rental_payment ON r.rental_id = rental_payment.rental_id
)

SELECT * FROM rental_details
  );

2020-08-12 19:53:18.261539 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:53:18.264159 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:53:18.264291 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
alter table "dvd_rental"."dev"."rental_details__dbt_tmp" rename to "rental_details"
2020-08-12 19:53:18.265366 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:18.266684 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 19:53:18.266837 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:53:18.266935 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 19:53:18.273582 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:53:18.275889 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:53:18.276057 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 19:53:18.276481 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.279313 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.279618 (Thread-1): On model.dbt_play.rental_details: Close
2020-08-12 19:53:18.280335 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f36e55-5342-4bcc-b4e1-4550d998ae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa146c0890>]}
2020-08-12 19:53:18.281595 (Thread-1): 15:53:18 | 5 of 8 OK created view model dev.rental_details...................... [CREATE VIEW in 0.07s]
2020-08-12 19:53:18.281815 (Thread-1): Finished running node model.dbt_play.rental_details
2020-08-12 19:53:18.282311 (Thread-1): Began running node model.dbt_play.customer_behaviour
2020-08-12 19:53:18.283625 (Thread-1): 15:53:18 | 6 of 8 START view model dev.customer_behaviour....................... [RUN]
2020-08-12 19:53:18.284115 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:53:18.284238 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:53:18.284350 (Thread-1): Compiling model.dbt_play.customer_behaviour
2020-08-12 19:53:18.297269 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 19:53:18.297783 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.312369 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:53:18.312554 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_tmp" cascade
2020-08-12 19:53:18.323628 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:53:18.375455 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:53:18.375729 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 19:53:18.376108 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.377610 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 19:53:18.378170 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:53:18.378300 (Thread-1): On model.dbt_play.customer_behaviour: BEGIN
2020-08-12 19:53:18.378679 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:53:18.378823 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:53:18.378934 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */

  create view "dvd_rental"."dev"."customer_behaviour__dbt_tmp" as (
    with rental_details as (
    SELECT 
        customer_id,
        returned,
        late, 
        paid
    FROM "dvd_rental"."dev"."rental_details"
),
customer_behaviour as(
    SELECT 
        customer_id, 
        sum(cast(returned as int)) as return_num, 
        sum(cast(late as int)) as late_num, 
        sum(cast(paid as int)) as paid_num 
    FROM rental_details 
    GROUP BY customer_id
)

SELECT * FROM customer_behaviour
  );

2020-08-12 19:53:18.382734 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:53:18.385753 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:53:18.385939 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
alter table "dvd_rental"."dev"."customer_behaviour__dbt_tmp" rename to "customer_behaviour"
2020-08-12 19:53:18.386715 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:18.389382 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 19:53:18.389566 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:53:18.389667 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 19:53:18.396430 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:53:18.399424 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:53:18.399572 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 19:53:18.400028 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.403035 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.403386 (Thread-1): On model.dbt_play.customer_behaviour: Close
2020-08-12 19:53:18.404262 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f36e55-5342-4bcc-b4e1-4550d998ae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa148199d0>]}
2020-08-12 19:53:18.405726 (Thread-1): 15:53:18 | 6 of 8 OK created view model dev.customer_behaviour.................. [CREATE VIEW in 0.12s]
2020-08-12 19:53:18.405993 (Thread-1): Finished running node model.dbt_play.customer_behaviour
2020-08-12 19:53:18.406284 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 19:53:18.407821 (Thread-1): 15:53:18 | 7 of 8 START view model dev.customer_language_preference............. [RUN]
2020-08-12 19:53:18.408309 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:53:18.408509 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:53:18.408682 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 19:53:18.417080 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:53:18.417907 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.427913 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:53:18.428096 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 19:53:18.436153 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:53:18.439703 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:53:18.440240 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:53:18.441544 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.444108 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:53:18.444731 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:53:18.444852 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 19:53:18.445414 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:53:18.445556 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:53:18.445665 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_language_preference as (
    SELECT DISTINCT ON (customer_id)
        customer_id,
        film_language as language
    FROM rental_details
    GROUP BY customer_id, film_language
    ORDER BY customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 19:53:18.452127 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:53:18.455224 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:53:18.455810 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 19:53:18.457845 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:53:18.461080 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:53:18.461340 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:53:18.461515 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:53:18.468458 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:53:18.471155 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:53:18.471341 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:53:18.471728 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:53:18.474177 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.474453 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 19:53:18.475048 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f36e55-5342-4bcc-b4e1-4550d998ae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa148142d0>]}
2020-08-12 19:53:18.476324 (Thread-1): 15:53:18 | 7 of 8 OK created view model dev.customer_language_preference........ [CREATE VIEW in 0.07s]
2020-08-12 19:53:18.476565 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 19:53:18.477023 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 19:53:18.478225 (Thread-1): 15:53:18 | 8 of 8 START table model dev.customer_profile........................ [RUN]
2020-08-12 19:53:18.478718 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:53:18.478836 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:53:18.478948 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 19:53:18.494099 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:53:18.495098 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.523383 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:53:18.523561 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 19:53:18.532406 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 19:53:18.534780 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:53:18.534978 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:53:18.535411 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:53:18.541827 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:53:18.542369 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:53:18.542488 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 19:53:18.542854 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:53:18.543018 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:53:18.543141 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
lang as (
    SELECT * FROM "dvd_rental"."dev"."customer_language_preference"
),
behave as (
    SELECT *FROM "dvd_rental"."dev"."customer_behaviour"
),
customer_profile as (
    SELECT 
        customer.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.period_days,
        ltv.life_time_value,
        rental.rental_num,
        behave.return_num,
        behave.late_num,
        behave.paid_num,
        lang.language
    FROM customer
    LEFT JOIN rental USING(customer_id)
    LEFT JOIN ltv USING(customer_id)
    LEFT JOIN lang USING(customer_id)
    LEFT JOIN behave USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 19:53:18.545194 (Thread-1): Postgres error: column rental.rental_num does not exist
LINE 32:         rental.rental_num,
                 ^

2020-08-12 19:53:18.545361 (Thread-1): On model.dbt_play.customer_profile: ROLLBACK
2020-08-12 19:53:18.545678 (Thread-1): finished collecting timing info
2020-08-12 19:53:18.546004 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 19:53:18.546398 (Thread-1): Database Error in model customer_profile (models/customer_profile.sql)
  column rental.rental_num does not exist
  LINE 32:         rental.rental_num,
                   ^
  compiled SQL at target/run/dbt_play/models/customer_profile.sql
Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 77, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column rental.rental_num does not exist
LINE 32:         rental.rental_num,
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 122, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 85, in add_query
    return connection, cursor
  File "/Users/sean/opt/anaconda3/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_profile (models/customer_profile.sql)
  column rental.rental_num does not exist
  LINE 32:         rental.rental_num,
                   ^
  compiled SQL at target/run/dbt_play/models/customer_profile.sql
2020-08-12 19:53:18.548392 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3f36e55-5342-4bcc-b4e1-4550d998ae71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa14875590>]}
2020-08-12 19:53:18.549744 (Thread-1): 15:53:18 | 8 of 8 ERROR creating table model dev.customer_profile............... [ERROR in 0.07s]
2020-08-12 19:53:18.549947 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 19:53:18.588109 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:53:18.588523 (MainThread): Opening a new connection, currently in state closed
2020-08-12 19:53:18.589169 (MainThread): Using postgres connection "master".
2020-08-12 19:53:18.589468 (MainThread): On master: BEGIN
2020-08-12 19:53:18.598914 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:53:18.599123 (MainThread): On master: COMMIT
2020-08-12 19:53:18.599232 (MainThread): Using postgres connection "master".
2020-08-12 19:53:18.599328 (MainThread): On master: COMMIT
2020-08-12 19:53:18.599544 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:53:18.599680 (MainThread): On master: Close
2020-08-12 19:53:18.600081 (MainThread): 15:53:18 | 
2020-08-12 19:53:18.600262 (MainThread): 15:53:18 | Finished running 7 view models, 1 table model in 1.36s.
2020-08-12 19:53:18.600442 (MainThread): Connection 'master' was properly closed.
2020-08-12 19:53:18.600583 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 19:53:18.633073 (MainThread): 
2020-08-12 19:53:18.633271 (MainThread): Completed with 1 error and 0 warnings:
2020-08-12 19:53:18.633404 (MainThread): 
2020-08-12 19:53:18.633545 (MainThread): Database Error in model customer_profile (models/customer_profile.sql)
2020-08-12 19:53:18.633684 (MainThread):   column rental.rental_num does not exist
2020-08-12 19:53:18.633808 (MainThread):   LINE 32:         rental.rental_num,
2020-08-12 19:53:18.633940 (MainThread):                    ^
2020-08-12 19:53:18.634066 (MainThread):   compiled SQL at target/run/dbt_play/models/customer_profile.sql
2020-08-12 19:53:18.634221 (MainThread): 
Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
2020-08-12 19:53:18.634454 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa14691910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1407e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa14053b10>]}
2020-08-12 19:53:18.634683 (MainThread): Flushing usage events
2020-08-12 19:54:40.271369 (MainThread): Running with dbt=0.17.2
2020-08-12 19:54:40.351904 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 19:54:40.353110 (MainThread): Tracking: tracking
2020-08-12 19:54:40.371016 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1ad5c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10833e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1ad44110>]}
2020-08-12 19:54:40.399160 (MainThread): Partial parsing not enabled
2020-08-12 19:54:40.401235 (MainThread): Parsing macros/core.sql
2020-08-12 19:54:40.407834 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 19:54:40.418504 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 19:54:40.420716 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 19:54:40.442165 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 19:54:40.482248 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 19:54:40.510943 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 19:54:40.513521 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 19:54:40.522144 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 19:54:40.540645 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 19:54:40.549646 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 19:54:40.558084 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 19:54:40.564097 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 19:54:40.565320 (MainThread): Parsing macros/etc/query.sql
2020-08-12 19:54:40.566647 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 19:54:40.568808 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 19:54:40.581257 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 19:54:40.583878 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 19:54:40.586136 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 19:54:40.652408 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 19:54:40.653982 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 19:54:40.655153 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 19:54:40.656565 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 19:54:40.659508 (MainThread): Parsing macros/catalog.sql
2020-08-12 19:54:40.662347 (MainThread): Parsing macros/relations.sql
2020-08-12 19:54:40.664132 (MainThread): Parsing macros/adapters.sql
2020-08-12 19:54:40.692628 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 19:54:40.717031 (MainThread): Partial parsing not enabled
2020-08-12 19:54:40.757098 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:40.757274 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:54:40.796933 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:54:40.797179 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:54:40.809165 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:40.809371 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:54:40.821605 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:40.821796 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:54:40.833006 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:40.833167 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:54:40.844647 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 19:54:40.844844 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:54:40.858287 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:54:40.858462 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:54:40.871467 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:54:40.871649 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:54:41.009780 (MainThread): Found 8 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 19:54:41.011129 (MainThread): 
2020-08-12 19:54:41.011628 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:54:41.011845 (MainThread): Opening a new connection, currently in state init
2020-08-12 19:54:41.032645 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 19:54:41.033679 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 19:54:41.060822 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 19:54:41.061095 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 19:54:41.078635 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.02 seconds
2020-08-12 19:54:41.081995 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 19:54:41.093656 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 19:54:41.094102 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 19:54:41.103072 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:54:41.103256 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 19:54:41.111131 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:54:41.111329 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 19:54:41.111442 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 19:54:41.115852 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2020-08-12 19:54:41.123756 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 19:54:41.124096 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 19:54:41.140774 (MainThread): Using postgres connection "master".
2020-08-12 19:54:41.140947 (MainThread): On master: BEGIN
2020-08-12 19:54:41.148759 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:54:41.148936 (MainThread): Using postgres connection "master".
2020-08-12 19:54:41.149038 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 19:54:41.530665 (MainThread): SQL status: SELECT 53 in 0.38 seconds
2020-08-12 19:54:41.592906 (MainThread): On master: ROLLBACK
2020-08-12 19:54:41.593284 (MainThread): Using postgres connection "master".
2020-08-12 19:54:41.593415 (MainThread): On master: BEGIN
2020-08-12 19:54:41.593817 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:54:41.593961 (MainThread): On master: COMMIT
2020-08-12 19:54:41.594079 (MainThread): Using postgres connection "master".
2020-08-12 19:54:41.594219 (MainThread): On master: COMMIT
2020-08-12 19:54:41.594514 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:54:41.594727 (MainThread): On master: Close
2020-08-12 19:54:41.595297 (MainThread): 15:54:41 | Concurrency: 1 threads (target='dev')
2020-08-12 19:54:41.595590 (MainThread): 15:54:41 | 
2020-08-12 19:54:41.598832 (Thread-1): Began running node model.dbt_play.rental_payment
2020-08-12 19:54:41.600335 (Thread-1): 15:54:41 | 1 of 8 START view model dev.rental_payment........................... [RUN]
2020-08-12 19:54:41.601064 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:41.601286 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:54:41.601486 (Thread-1): Compiling model.dbt_play.rental_payment
2020-08-12 19:54:41.624003 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_payment"
2020-08-12 19:54:41.624556 (Thread-1): finished collecting timing info
2020-08-12 19:54:41.666858 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:41.667037 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_tmp" cascade
2020-08-12 19:54:41.675733 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:54:41.679234 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:41.679526 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 19:54:41.679964 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:41.684835 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_payment"
2020-08-12 19:54:41.685498 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:41.685731 (Thread-1): On model.dbt_play.rental_payment: BEGIN
2020-08-12 19:54:41.686079 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:54:41.686295 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:41.686419 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */

  create view "dvd_rental"."dev"."rental_payment__dbt_tmp" as (
    with rental_payment as(
    SELECT 
        rental_id, 
        sum(amount) as amount 
    FROM dvd_rental.public.payment 
    GROUP BY rental_id
)

SELECT * FROM rental_payment
  );

2020-08-12 19:54:41.689590 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:54:41.699815 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:41.699992 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment" rename to "rental_payment__dbt_backup"
2020-08-12 19:54:41.700576 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:41.703153 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:41.703362 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment__dbt_tmp" rename to "rental_payment"
2020-08-12 19:54:41.704145 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:41.712464 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 19:54:41.712751 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:41.712855 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 19:54:41.713621 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:54:41.717397 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 19:54:41.717566 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 19:54:41.720310 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:41.723027 (Thread-1): finished collecting timing info
2020-08-12 19:54:41.723301 (Thread-1): On model.dbt_play.rental_payment: Close
2020-08-12 19:54:41.723892 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4df56d4-4e4b-4079-b15a-c4b4c16f3dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1b406190>]}
2020-08-12 19:54:41.725091 (Thread-1): 15:54:41 | 1 of 8 OK created view model dev.rental_payment...................... [CREATE VIEW in 0.12s]
2020-08-12 19:54:41.725318 (Thread-1): Finished running node model.dbt_play.rental_payment
2020-08-12 19:54:41.725536 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 19:54:41.727002 (Thread-1): 15:54:41 | 2 of 8 START view model dev.customer................................. [RUN]
2020-08-12 19:54:41.727548 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 19:54:41.727691 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:54:41.727811 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 19:54:41.734616 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 19:54:41.737260 (Thread-1): finished collecting timing info
2020-08-12 19:54:41.744221 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:54:41.744517 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 19:54:41.758734 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:54:41.764157 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:54:41.764451 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:54:41.764884 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:41.767071 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 19:54:41.769075 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:54:41.769576 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 19:54:41.770199 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:54:41.770337 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:54:41.770442 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 19:54:41.774358 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:54:41.780154 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:54:41.780344 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 19:54:41.781151 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:41.783685 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:54:41.783965 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 19:54:41.784680 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:41.786338 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:54:41.786635 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:54:41.786769 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 19:54:41.793642 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:54:41.797635 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 19:54:41.797838 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 19:54:41.799295 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:41.802039 (Thread-1): finished collecting timing info
2020-08-12 19:54:41.802426 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 19:54:41.803509 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4df56d4-4e4b-4079-b15a-c4b4c16f3dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1b52a250>]}
2020-08-12 19:54:41.805650 (Thread-1): 15:54:41 | 2 of 8 OK created view model dev.customer............................ [CREATE VIEW in 0.08s]
2020-08-12 19:54:41.806002 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 19:54:41.806344 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 19:54:41.808029 (Thread-1): 15:54:41 | 3 of 8 START view model dev.customer_life_time_value................. [RUN]
2020-08-12 19:54:41.808613 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:41.808734 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:54:41.808846 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 19:54:41.818323 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:54:41.819075 (Thread-1): finished collecting timing info
2020-08-12 19:54:41.825765 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:41.825922 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 19:54:41.837582 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:54:41.843104 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:41.843365 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:54:41.843920 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:41.847960 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 19:54:41.848535 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:41.848658 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 19:54:41.849537 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:54:41.851077 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:41.853908 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 19:54:41.858853 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:54:41.863238 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:41.863418 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 19:54:41.864041 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:41.866528 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:41.866660 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 19:54:41.867162 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:41.868792 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:54:41.868967 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:41.869065 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 19:54:41.873917 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:54:41.877898 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 19:54:41.878173 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 19:54:41.879677 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:41.882590 (Thread-1): finished collecting timing info
2020-08-12 19:54:41.882883 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 19:54:41.883566 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4df56d4-4e4b-4079-b15a-c4b4c16f3dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1b456e50>]}
2020-08-12 19:54:41.884855 (Thread-1): 15:54:41 | 3 of 8 OK created view model dev.customer_life_time_value............ [CREATE VIEW in 0.07s]
2020-08-12 19:54:41.885057 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 19:54:41.885271 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 19:54:41.886492 (Thread-1): 15:54:41 | 4 of 8 START view model dev.customer_rental_summary.................. [RUN]
2020-08-12 19:54:41.886968 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:41.887101 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:54:41.887210 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 19:54:41.898670 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:54:41.899406 (Thread-1): finished collecting timing info
2020-08-12 19:54:41.906762 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:41.906938 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 19:54:41.918558 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:54:41.923561 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:41.924502 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:54:41.925023 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:41.926664 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 19:54:41.927849 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:41.928756 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 19:54:41.929880 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:54:41.930089 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:41.930219 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 19:54:41.937441 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:54:41.941960 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:41.942126 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 19:54:41.942969 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:41.945984 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:41.946164 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 19:54:41.946960 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:41.948319 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:54:41.948457 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:41.948561 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 19:54:41.954025 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:54:41.956143 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 19:54:41.956287 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 19:54:41.958134 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:41.961323 (Thread-1): finished collecting timing info
2020-08-12 19:54:41.961738 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 19:54:41.962539 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4df56d4-4e4b-4079-b15a-c4b4c16f3dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1b548bd0>]}
2020-08-12 19:54:41.964245 (Thread-1): 15:54:41 | 4 of 8 OK created view model dev.customer_rental_summary............. [CREATE VIEW in 0.08s]
2020-08-12 19:54:41.964480 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 19:54:41.964715 (Thread-1): Began running node model.dbt_play.rental_details
2020-08-12 19:54:41.965936 (Thread-1): 15:54:41 | 5 of 8 START view model dev.rental_details........................... [RUN]
2020-08-12 19:54:41.966349 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 19:54:41.966485 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:54:41.966598 (Thread-1): Compiling model.dbt_play.rental_details
2020-08-12 19:54:41.980283 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_details"
2020-08-12 19:54:41.980924 (Thread-1): finished collecting timing info
2020-08-12 19:54:41.992403 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:54:41.992583 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_tmp" cascade
2020-08-12 19:54:42.005933 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:54:42.008561 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:54:42.008757 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 19:54:42.009144 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:42.011643 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_details"
2020-08-12 19:54:42.012824 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:54:42.013092 (Thread-1): On model.dbt_play.rental_details: BEGIN
2020-08-12 19:54:42.013623 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:54:42.013780 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:54:42.013902 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */

  create view "dvd_rental"."dev"."rental_details__dbt_tmp" as (
    with rental_payment as (
    SELECT * FROM "dvd_rental"."dev"."rental_payment"
),
rental_details as(
    SELECT
        r.rental_id,
        r.customer_id,
        r.rental_date,
        CASE WHEN r.return_date is null THEN FALSE ELSE TRUE END as returned,
        CASE WHEN date_part('day', return_date - rental_date) > f.rental_duration THEN TRUE ELSE FALSE END as late,
        CASE WHEN rental_payment.amount is null THEN FALSE WHEN rental_payment.amount <= 0 THEN FALSE ELSE TRUE END as paid,
        f.title as film_title,
        f.rating as film_rating,
        l.name as film_language,
        c.name as film_category,
        CASE WHEN rental_payment.amount is null THEN 0 ELSE rental_payment.amount END as payment_amount
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film f ON i.film_id = f.film_id
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    INNER JOIN dvd_rental.public.film_category fc ON f.film_id = fc.film_id
    INNER JOIN dvd_rental.public.category c ON fc.category_id = c.category_id
    LEFT JOIN rental_payment ON r.rental_id = rental_payment.rental_id
)

SELECT * FROM rental_details
  );

2020-08-12 19:54:42.021886 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:54:42.024865 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:54:42.025041 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
alter table "dvd_rental"."dev"."rental_details__dbt_tmp" rename to "rental_details"
2020-08-12 19:54:42.026130 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:42.027786 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 19:54:42.027965 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:54:42.028079 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 19:54:42.034343 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:54:42.036717 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 19:54:42.036896 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 19:54:42.037299 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:42.041284 (Thread-1): finished collecting timing info
2020-08-12 19:54:42.041888 (Thread-1): On model.dbt_play.rental_details: Close
2020-08-12 19:54:42.043375 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4df56d4-4e4b-4079-b15a-c4b4c16f3dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1ad6acd0>]}
2020-08-12 19:54:42.045026 (Thread-1): 15:54:42 | 5 of 8 OK created view model dev.rental_details...................... [CREATE VIEW in 0.08s]
2020-08-12 19:54:42.045543 (Thread-1): Finished running node model.dbt_play.rental_details
2020-08-12 19:54:42.046041 (Thread-1): Began running node model.dbt_play.customer_behaviour
2020-08-12 19:54:42.047306 (Thread-1): 15:54:42 | 6 of 8 START view model dev.customer_behaviour....................... [RUN]
2020-08-12 19:54:42.047849 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:54:42.047987 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:54:42.048099 (Thread-1): Compiling model.dbt_play.customer_behaviour
2020-08-12 19:54:42.056761 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 19:54:42.057313 (Thread-1): finished collecting timing info
2020-08-12 19:54:42.069927 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:54:42.070186 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_tmp" cascade
2020-08-12 19:54:42.085851 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 19:54:42.144590 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:54:42.144854 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 19:54:42.145253 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:42.146560 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 19:54:42.147153 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:54:42.147274 (Thread-1): On model.dbt_play.customer_behaviour: BEGIN
2020-08-12 19:54:42.147572 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:54:42.147690 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:54:42.147787 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */

  create view "dvd_rental"."dev"."customer_behaviour__dbt_tmp" as (
    with rental_details as (
    SELECT 
        customer_id,
        returned,
        late, 
        paid
    FROM "dvd_rental"."dev"."rental_details"
),
customer_behaviour as(
    SELECT 
        customer_id, 
        sum(cast(returned as int)) as num_return, 
        sum(cast(late as int)) as num_late, 
        sum(cast(paid as int)) as num_paid 
    FROM rental_details 
    GROUP BY customer_id
)

SELECT * FROM customer_behaviour
  );

2020-08-12 19:54:42.159070 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 19:54:42.164011 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:54:42.164207 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
alter table "dvd_rental"."dev"."customer_behaviour__dbt_tmp" rename to "customer_behaviour"
2020-08-12 19:54:42.165000 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:42.166348 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 19:54:42.166492 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:54:42.166603 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 19:54:42.172914 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:54:42.175561 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 19:54:42.175707 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 19:54:42.176069 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:42.179978 (Thread-1): finished collecting timing info
2020-08-12 19:54:42.180337 (Thread-1): On model.dbt_play.customer_behaviour: Close
2020-08-12 19:54:42.181021 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4df56d4-4e4b-4079-b15a-c4b4c16f3dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1ad5cb50>]}
2020-08-12 19:54:42.182332 (Thread-1): 15:54:42 | 6 of 8 OK created view model dev.customer_behaviour.................. [CREATE VIEW in 0.13s]
2020-08-12 19:54:42.182564 (Thread-1): Finished running node model.dbt_play.customer_behaviour
2020-08-12 19:54:42.182868 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 19:54:42.184534 (Thread-1): 15:54:42 | 7 of 8 START view model dev.customer_language_preference............. [RUN]
2020-08-12 19:54:42.184978 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:54:42.185125 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:54:42.185243 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 19:54:42.199199 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:54:42.199889 (Thread-1): finished collecting timing info
2020-08-12 19:54:42.208846 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:54:42.209023 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 19:54:42.221707 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 19:54:42.227640 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:54:42.227876 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:54:42.228248 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:42.231614 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 19:54:42.232349 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:54:42.232590 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 19:54:42.232996 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:54:42.233124 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:54:42.233266 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_language_preference as (
    SELECT DISTINCT ON (customer_id)
        customer_id,
        film_language as language
    FROM rental_details
    GROUP BY customer_id, film_language
    ORDER BY customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 19:54:42.237386 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 19:54:42.240439 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:54:42.240601 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 19:54:42.241266 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:42.242541 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:54:42.242764 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:54:42.242904 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 19:54:42.249864 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 19:54:42.252421 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 19:54:42.252637 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 19:54:42.252985 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 19:54:42.255665 (Thread-1): finished collecting timing info
2020-08-12 19:54:42.255958 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 19:54:42.256913 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4df56d4-4e4b-4079-b15a-c4b4c16f3dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1b17c290>]}
2020-08-12 19:54:42.258237 (Thread-1): 15:54:42 | 7 of 8 OK created view model dev.customer_language_preference........ [CREATE VIEW in 0.07s]
2020-08-12 19:54:42.258490 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 19:54:42.258947 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 19:54:42.260340 (Thread-1): 15:54:42 | 8 of 8 START table model dev.customer_profile........................ [RUN]
2020-08-12 19:54:42.260868 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:42.261080 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 19:54:42.261205 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 19:54:42.280811 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:54:42.281956 (Thread-1): finished collecting timing info
2020-08-12 19:54:42.323069 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:42.323258 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 19:54:42.331751 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 19:54:42.334251 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:42.334396 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:54:42.334751 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:54:42.341715 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 19:54:42.342343 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:42.342478 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 19:54:42.342912 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 19:54:42.343039 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:42.343140 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
lang as (
    SELECT * FROM "dvd_rental"."dev"."customer_language_preference"
),
behave as (
    SELECT *FROM "dvd_rental"."dev"."customer_behaviour"
),
customer_profile as (
    SELECT 
        customer.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.period_days,
        ltv.life_time_value,
        rental.num_rental,
        behave.num_return,
        behave.num_late,
        behave.num_paid,
        lang.language
    FROM customer
    LEFT JOIN rental USING(customer_id)
    LEFT JOIN ltv USING(customer_id)
    LEFT JOIN lang USING(customer_id)
    LEFT JOIN behave USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 19:54:42.465747 (Thread-1): SQL status: SELECT 599 in 0.12 seconds
2020-08-12 19:54:42.470736 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:42.470939 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile" rename to "customer_profile__dbt_backup"
2020-08-12 19:54:42.471550 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:42.474379 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:42.474535 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 19:54:42.475152 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 19:54:42.476560 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:54:42.476791 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:42.476951 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 19:54:42.478134 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:54:42.480584 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 19:54:42.480779 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 19:54:42.483995 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 19:54:42.486890 (Thread-1): finished collecting timing info
2020-08-12 19:54:42.487216 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 19:54:42.488016 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4df56d4-4e4b-4079-b15a-c4b4c16f3dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1b2fc250>]}
2020-08-12 19:54:42.489787 (Thread-1): 15:54:42 | 8 of 8 OK created table model dev.customer_profile................... [SELECT 599 in 0.23s]
2020-08-12 19:54:42.490049 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 19:54:42.561153 (MainThread): Acquiring new postgres connection "master".
2020-08-12 19:54:42.561437 (MainThread): Opening a new connection, currently in state closed
2020-08-12 19:54:42.561944 (MainThread): Using postgres connection "master".
2020-08-12 19:54:42.562153 (MainThread): On master: BEGIN
2020-08-12 19:54:42.571235 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 19:54:42.571453 (MainThread): On master: COMMIT
2020-08-12 19:54:42.571578 (MainThread): Using postgres connection "master".
2020-08-12 19:54:42.571690 (MainThread): On master: COMMIT
2020-08-12 19:54:42.571932 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 19:54:42.572098 (MainThread): On master: Close
2020-08-12 19:54:42.572538 (MainThread): 15:54:42 | 
2020-08-12 19:54:42.572736 (MainThread): 15:54:42 | Finished running 7 view models, 1 table model in 1.56s.
2020-08-12 19:54:42.572922 (MainThread): Connection 'master' was properly closed.
2020-08-12 19:54:42.573057 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 19:54:42.606324 (MainThread): 
2020-08-12 19:54:42.606552 (MainThread): Completed successfully
2020-08-12 19:54:42.606713 (MainThread): 
Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
2020-08-12 19:54:42.606926 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1b530d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1b1b0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1b4a31d0>]}
2020-08-12 19:54:42.607146 (MainThread): Flushing usage events
2020-08-12 20:01:44.673116 (MainThread): Running with dbt=0.17.2
2020-08-12 20:01:44.750941 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 20:01:44.752751 (MainThread): Tracking: tracking
2020-08-12 20:01:44.769599 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1dc04d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ef750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1db8f950>]}
2020-08-12 20:01:44.796007 (MainThread): Partial parsing not enabled
2020-08-12 20:01:44.799176 (MainThread): Parsing macros/core.sql
2020-08-12 20:01:44.806007 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:01:44.817893 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:01:44.820210 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:01:44.844618 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:01:44.884988 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:01:44.914588 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:01:44.917707 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:01:44.925958 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:01:44.946377 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:01:44.955629 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:01:44.964061 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:01:44.970315 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:01:44.971678 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:01:44.973032 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:01:44.975116 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:01:44.987685 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:01:44.990150 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:01:44.992383 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:01:45.060412 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:01:45.061954 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:01:45.063052 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:01:45.064347 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:01:45.067003 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:01:45.069931 (MainThread): Parsing macros/relations.sql
2020-08-12 20:01:45.071898 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:01:45.100711 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:01:45.130836 (MainThread): Partial parsing not enabled
2020-08-12 20:01:45.177488 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:01:45.177663 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:01:45.218630 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:01:45.218818 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:01:45.230532 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:01:45.230745 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:01:45.243253 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:01:45.243432 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:01:45.255426 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:01:45.255603 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:01:45.266673 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:01:45.266844 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:01:45.280525 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:01:45.280698 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:01:45.294278 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_preferences".
2020-08-12 20:01:45.294450 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:01:45.355205 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1e1de610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1e361090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1e361150>]}
2020-08-12 20:01:45.355567 (MainThread): Flushing usage events
2020-08-12 20:01:46.618737 (MainThread): Connection 'model.dbt_play.customer_preferences' was properly closed.
2020-08-12 20:01:46.618995 (MainThread): Encountered an error:
2020-08-12 20:01:46.619181 (MainThread): Compilation Error in model customer_profile (models/customer_profile.sql)
  Model 'model.dbt_play.customer_profile' (models/customer_profile.sql) depends on a node named 'customer_language_preference' which was not found
2020-08-12 20:01:46.625554 (MainThread): Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 390, in run
    self._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 306, in process_manifest
    process_refs(manifest, project_name)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 564, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 548, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/utils.py", line 318, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/exceptions.py", line 527, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customer_profile (models/customer_profile.sql)
  Model 'model.dbt_play.customer_profile' (models/customer_profile.sql) depends on a node named 'customer_language_preference' which was not found

2020-08-12 20:03:28.724376 (MainThread): Running with dbt=0.17.2
2020-08-12 20:03:28.810915 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 20:03:28.812023 (MainThread): Tracking: tracking
2020-08-12 20:03:28.831532 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1bb59110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1bb49450>]}
2020-08-12 20:03:28.862122 (MainThread): Partial parsing not enabled
2020-08-12 20:03:28.864403 (MainThread): Parsing macros/core.sql
2020-08-12 20:03:28.871026 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:03:28.882394 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:03:28.884567 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:03:28.911783 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:03:28.954023 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:03:28.982510 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:03:28.984832 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:03:28.993179 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:03:29.013434 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:03:29.023322 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:03:29.033066 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:03:29.041765 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:03:29.043486 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:03:29.044969 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:03:29.047001 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:03:29.058642 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:03:29.061347 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:03:29.063482 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:03:29.131258 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:03:29.133154 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:03:29.134306 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:03:29.135606 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:03:29.138703 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:03:29.142052 (MainThread): Parsing macros/relations.sql
2020-08-12 20:03:29.144082 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:03:29.172716 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:03:29.198399 (MainThread): Partial parsing not enabled
2020-08-12 20:03:29.242665 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:03:29.242840 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:03:29.281407 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:03:29.281594 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:03:29.293244 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:03:29.293435 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:03:29.306577 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:03:29.306753 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:03:29.319191 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:03:29.319365 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:03:29.331583 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:03:29.331806 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:03:29.346315 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:03:29.346491 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:03:29.366489 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_preferences".
2020-08-12 20:03:29.366697 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:03:29.430620 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1c1ac590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1c11da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1c10d050>]}
2020-08-12 20:03:29.430919 (MainThread): Flushing usage events
2020-08-12 20:03:30.184202 (MainThread): Connection 'model.dbt_play.customer_preferences' was properly closed.
2020-08-12 20:03:30.184455 (MainThread): Encountered an error:
2020-08-12 20:03:30.184661 (MainThread): Compilation Error in model customer_profile (models/customer_profile.sql)
  Model 'model.dbt_play.customer_profile' (models/customer_profile.sql) depends on a node named 'customer_language_preference' which was not found
2020-08-12 20:03:30.186760 (MainThread): Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 390, in run
    self._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 358, in load_all
    manifest = loader.create_manifest()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 334, in create_manifest
    self.process_manifest(manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 306, in process_manifest
    process_refs(manifest, project_name)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 564, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 548, in _process_refs_for_node
    disabled=(isinstance(target_model, Disabled))
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/utils.py", line 318, in invalid_ref_fail_unless_test
    disabled=disabled,
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/exceptions.py", line 527, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customer_profile (models/customer_profile.sql)
  Model 'model.dbt_play.customer_profile' (models/customer_profile.sql) depends on a node named 'customer_language_preference' which was not found

2020-08-12 20:07:10.581174 (MainThread): Running with dbt=0.17.2
2020-08-12 20:07:10.666288 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 20:07:10.667921 (MainThread): Tracking: tracking
2020-08-12 20:07:10.686305 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa19a61e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa19a5b510>]}
2020-08-12 20:07:10.714840 (MainThread): Partial parsing not enabled
2020-08-12 20:07:10.717075 (MainThread): Parsing macros/core.sql
2020-08-12 20:07:10.726822 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:07:10.740344 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:07:10.743053 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:07:10.766072 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:07:10.806344 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:07:10.838337 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:07:10.840992 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:07:10.849261 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:07:10.867751 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:07:10.877014 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:07:10.884973 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:07:10.891705 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:07:10.892968 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:07:10.894272 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:07:10.896265 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:07:10.907949 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:07:10.910660 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:07:10.913741 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:07:10.982953 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:07:10.984385 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:07:10.985536 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:07:10.987009 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:07:10.989957 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:07:10.993121 (MainThread): Parsing macros/relations.sql
2020-08-12 20:07:10.994869 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:07:11.023107 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:07:11.047325 (MainThread): Partial parsing not enabled
2020-08-12 20:07:11.088128 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:11.088304 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.128538 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:07:11.128816 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.140659 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:11.140826 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.152998 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:11.153192 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.165460 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:11.165622 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.177322 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:07:11.177487 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.191284 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:07:11.191454 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.204851 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:07:11.205020 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.219525 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:07:11.219697 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.234043 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:07:11.234213 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.394508 (MainThread): Found 10 models, 0 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 20:07:11.395943 (MainThread): 
2020-08-12 20:07:11.396493 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:07:11.396750 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:07:11.419639 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 20:07:11.419904 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 20:07:11.432421 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 20:07:11.432596 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 20:07:11.442661 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.01 seconds
2020-08-12 20:07:11.446099 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 20:07:11.460756 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 20:07:11.460975 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 20:07:11.467620 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:07:11.467857 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 20:07:11.475901 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:07:11.476105 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:07:11.476214 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 20:07:11.480490 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2020-08-12 20:07:11.489131 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 20:07:11.489535 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 20:07:11.508561 (MainThread): Using postgres connection "master".
2020-08-12 20:07:11.508731 (MainThread): On master: BEGIN
2020-08-12 20:07:11.516597 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:07:11.516775 (MainThread): Using postgres connection "master".
2020-08-12 20:07:11.516876 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 20:07:11.906451 (MainThread): SQL status: SELECT 53 in 0.39 seconds
2020-08-12 20:07:11.972376 (MainThread): On master: ROLLBACK
2020-08-12 20:07:11.973633 (MainThread): Using postgres connection "master".
2020-08-12 20:07:11.973825 (MainThread): On master: BEGIN
2020-08-12 20:07:11.974193 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:11.974327 (MainThread): On master: COMMIT
2020-08-12 20:07:11.974438 (MainThread): Using postgres connection "master".
2020-08-12 20:07:11.974530 (MainThread): On master: COMMIT
2020-08-12 20:07:11.974762 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:07:11.974927 (MainThread): On master: Close
2020-08-12 20:07:11.975361 (MainThread): 16:07:11 | Concurrency: 1 threads (target='dev')
2020-08-12 20:07:11.975782 (MainThread): 16:07:11 | 
2020-08-12 20:07:11.977747 (Thread-1): Began running node model.dbt_play.rental_payment
2020-08-12 20:07:11.978976 (Thread-1): 16:07:11 | 1 of 10 START view model dev.rental_payment.......................... [RUN]
2020-08-12 20:07:11.979581 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:11.979742 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:11.979884 (Thread-1): Compiling model.dbt_play.rental_payment
2020-08-12 20:07:12.002898 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_payment"
2020-08-12 20:07:12.004320 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.043994 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:12.044182 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_tmp" cascade
2020-08-12 20:07:12.051988 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:07:12.055181 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:12.055368 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 20:07:12.055742 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.061150 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_payment"
2020-08-12 20:07:12.061924 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:12.062091 (Thread-1): On model.dbt_play.rental_payment: BEGIN
2020-08-12 20:07:12.062447 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.062568 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:12.062663 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */

  create view "dvd_rental"."dev"."rental_payment__dbt_tmp" as (
    with rental_payment as(
    SELECT 
        rental_id, 
        sum(amount) as amount 
    FROM dvd_rental.public.payment 
    GROUP BY rental_id
)

SELECT * FROM rental_payment
  );

2020-08-12 20:07:12.073283 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:07:12.081226 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:12.081573 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment" rename to "rental_payment__dbt_backup"
2020-08-12 20:07:12.082259 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.084887 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:12.085039 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment__dbt_tmp" rename to "rental_payment"
2020-08-12 20:07:12.085646 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.093500 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 20:07:12.093731 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:12.093834 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 20:07:12.094827 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:07:12.098851 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:07:12.099020 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 20:07:12.101907 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.104627 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.104913 (Thread-1): On model.dbt_play.rental_payment: Close
2020-08-12 20:07:12.105636 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a0fcdd0>]}
2020-08-12 20:07:12.107095 (Thread-1): 16:07:12 | 1 of 10 OK created view model dev.rental_payment..................... [CREATE VIEW in 0.13s]
2020-08-12 20:07:12.107382 (Thread-1): Finished running node model.dbt_play.rental_payment
2020-08-12 20:07:12.107570 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 20:07:12.108784 (Thread-1): 16:07:12 | 2 of 10 START view model dev.customer................................ [RUN]
2020-08-12 20:07:12.109293 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:07:12.109465 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:12.109586 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 20:07:12.117153 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 20:07:12.118193 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.128949 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:07:12.129152 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 20:07:12.142613 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:07:12.145318 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:07:12.145520 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 20:07:12.145894 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.147717 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 20:07:12.148775 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:07:12.149032 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 20:07:12.149772 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.150000 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:07:12.150182 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 20:07:12.161726 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:07:12.166513 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:07:12.166695 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 20:07:12.167415 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.170642 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:07:12.170940 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 20:07:12.171620 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.173341 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 20:07:12.173494 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:07:12.173600 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 20:07:12.174497 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:07:12.176305 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:07:12.176445 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 20:07:12.178116 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.180707 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.180979 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 20:07:12.181688 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a1ac1d0>]}
2020-08-12 20:07:12.183013 (Thread-1): 16:07:12 | 2 of 10 OK created view model dev.customer........................... [CREATE VIEW in 0.07s]
2020-08-12 20:07:12.183214 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 20:07:12.183413 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 20:07:12.184551 (Thread-1): 16:07:12 | 3 of 10 START view model dev.customer_life_time_value................ [RUN]
2020-08-12 20:07:12.185027 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:12.185173 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:12.185291 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 20:07:12.192683 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 20:07:12.195113 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.206992 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:12.207182 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 20:07:12.218218 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:07:12.221457 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:12.221630 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 20:07:12.222016 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.223634 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 20:07:12.224287 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:12.224412 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 20:07:12.224758 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.224877 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:12.224992 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 20:07:12.234221 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:07:12.239315 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:12.239742 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 20:07:12.240473 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.243075 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:12.243213 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 20:07:12.243795 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.245480 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 20:07:12.245663 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:12.245774 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 20:07:12.251598 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:07:12.254976 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:07:12.255250 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 20:07:12.256692 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.259856 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.260324 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 20:07:12.261038 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a08ab10>]}
2020-08-12 20:07:12.262444 (Thread-1): 16:07:12 | 3 of 10 OK created view model dev.customer_life_time_value........... [CREATE VIEW in 0.08s]
2020-08-12 20:07:12.262679 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 20:07:12.262960 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 20:07:12.264198 (Thread-1): 16:07:12 | 4 of 10 START view model dev.customer_rental_summary................. [RUN]
2020-08-12 20:07:12.264686 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:12.264844 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:12.264971 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 20:07:12.272562 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 20:07:12.275478 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.289265 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:12.291036 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 20:07:12.301918 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:07:12.306047 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:12.306231 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 20:07:12.306759 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.308212 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 20:07:12.308759 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:12.308944 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 20:07:12.309309 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.309431 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:12.309526 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 20:07:12.314481 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:07:12.318974 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:12.319145 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 20:07:12.319998 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.322509 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:12.322641 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 20:07:12.323370 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.324903 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 20:07:12.325062 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:12.325176 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 20:07:12.331241 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:07:12.334357 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:07:12.334536 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 20:07:12.336118 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.338789 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.339149 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 20:07:12.339994 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a08af10>]}
2020-08-12 20:07:12.341439 (Thread-1): 16:07:12 | 4 of 10 OK created view model dev.customer_rental_summary............ [CREATE VIEW in 0.08s]
2020-08-12 20:07:12.341643 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 20:07:12.341935 (Thread-1): Began running node model.dbt_play.rental_details
2020-08-12 20:07:12.343251 (Thread-1): 16:07:12 | 5 of 10 START view model dev.rental_details.......................... [RUN]
2020-08-12 20:07:12.343810 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:07:12.343939 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:12.344054 (Thread-1): Compiling model.dbt_play.rental_details
2020-08-12 20:07:12.354887 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_details"
2020-08-12 20:07:12.355475 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.363342 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:07:12.363607 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_tmp" cascade
2020-08-12 20:07:12.374565 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:07:12.377450 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:07:12.377619 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 20:07:12.377990 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.379215 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_details"
2020-08-12 20:07:12.379767 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:07:12.379891 (Thread-1): On model.dbt_play.rental_details: BEGIN
2020-08-12 20:07:12.380217 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.380336 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:07:12.380433 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */

  create view "dvd_rental"."dev"."rental_details__dbt_tmp" as (
    with rental_payment as (
    SELECT * FROM "dvd_rental"."dev"."rental_payment"
),
rental_details as(
    SELECT
        r.rental_id,
        r.customer_id,
        r.rental_date,
        CASE WHEN r.return_date is null THEN FALSE ELSE TRUE END as returned,
        CASE WHEN date_part('day', return_date - rental_date) > f.rental_duration THEN TRUE ELSE FALSE END as late,
        CASE WHEN rental_payment.amount is null THEN FALSE WHEN rental_payment.amount <= 0 THEN FALSE ELSE TRUE END as paid,
        f.title as film_title,
        f.rating as film_rating,
        l.name as film_language,
        c.name as film_category,
        CASE WHEN rental_payment.amount is null THEN 0 ELSE rental_payment.amount END as payment_amount
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film f ON i.film_id = f.film_id
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    INNER JOIN dvd_rental.public.film_category fc ON f.film_id = fc.film_id
    INNER JOIN dvd_rental.public.category c ON fc.category_id = c.category_id
    LEFT JOIN rental_payment ON r.rental_id = rental_payment.rental_id
)

SELECT * FROM rental_details
  );

2020-08-12 20:07:12.398738 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 20:07:12.402791 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:07:12.403052 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
alter table "dvd_rental"."dev"."rental_details__dbt_tmp" rename to "rental_details"
2020-08-12 20:07:12.403874 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.405351 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 20:07:12.405527 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:07:12.405625 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 20:07:12.406394 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:07:12.458665 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:07:12.458852 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 20:07:12.459224 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.461821 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.462431 (Thread-1): On model.dbt_play.rental_details: Close
2020-08-12 20:07:12.463112 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704d690>]}
2020-08-12 20:07:12.464347 (Thread-1): 16:07:12 | 5 of 10 OK created view model dev.rental_details..................... [CREATE VIEW in 0.12s]
2020-08-12 20:07:12.464563 (Thread-1): Finished running node model.dbt_play.rental_details
2020-08-12 20:07:12.465163 (Thread-1): Began running node model.dbt_play.customer_behaviour
2020-08-12 20:07:12.466462 (Thread-1): 16:07:12 | 6 of 10 START view model dev.customer_behaviour...................... [RUN]
2020-08-12 20:07:12.466981 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:07:12.467137 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:12.467264 (Thread-1): Compiling model.dbt_play.customer_behaviour
2020-08-12 20:07:12.478775 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 20:07:12.479369 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.490857 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:07:12.491065 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_tmp" cascade
2020-08-12 20:07:12.505461 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:07:12.509633 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:07:12.509881 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 20:07:12.510363 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.514560 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 20:07:12.515549 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:07:12.515740 (Thread-1): On model.dbt_play.customer_behaviour: BEGIN
2020-08-12 20:07:12.516545 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.516707 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:07:12.516811 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */

  create view "dvd_rental"."dev"."customer_behaviour__dbt_tmp" as (
    with rental_details as (
    SELECT 
        customer_id,
        returned,
        late, 
        paid
    FROM "dvd_rental"."dev"."rental_details"
),
customer_behaviour as(
    SELECT 
        customer_id, 
        sum(cast(returned as int)) as num_return, 
        sum(cast(late as int)) as num_late, 
        sum(cast(paid as int)) as num_paid 
    FROM rental_details 
    GROUP BY customer_id
)

SELECT * FROM customer_behaviour
  );

2020-08-12 20:07:12.521125 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:07:12.523707 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:07:12.524112 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
alter table "dvd_rental"."dev"."customer_behaviour__dbt_tmp" rename to "customer_behaviour"
2020-08-12 20:07:12.524920 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.526206 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 20:07:12.526332 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:07:12.526427 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 20:07:12.533470 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:07:12.535516 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:07:12.535651 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 20:07:12.536022 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.540642 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.541271 (Thread-1): On model.dbt_play.customer_behaviour: Close
2020-08-12 20:07:12.543062 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa19e7ca10>]}
2020-08-12 20:07:12.546122 (Thread-1): 16:07:12 | 6 of 10 OK created view model dev.customer_behaviour................. [CREATE VIEW in 0.08s]
2020-08-12 20:07:12.546441 (Thread-1): Finished running node model.dbt_play.customer_behaviour
2020-08-12 20:07:12.546836 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 20:07:12.549515 (Thread-1): 16:07:12 | 7 of 10 START view model dev.customer_language_preference............ [RUN]
2020-08-12 20:07:12.549942 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:07:12.550056 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:12.550166 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 20:07:12.561807 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 20:07:12.562474 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.574866 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:07:12.575055 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 20:07:12.586347 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:07:12.590683 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:07:12.590868 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 20:07:12.591292 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.592636 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 20:07:12.593161 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:07:12.593272 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 20:07:12.593729 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.593862 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:07:12.593960 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_language_preference as (
    SELECT DISTINCT ON (customer_id)
        customer_id,
        film_language as language
    FROM rental_details
    GROUP BY customer_id, film_language
    ORDER BY customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 20:07:12.598482 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:07:12.601255 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:07:12.601434 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 20:07:12.602092 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.603461 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 20:07:12.603698 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:07:12.603857 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 20:07:12.604713 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:07:12.606812 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:07:12.606977 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 20:07:12.607360 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.610307 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.610590 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 20:07:12.611387 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa19ea6510>]}
2020-08-12 20:07:12.613614 (Thread-1): 16:07:12 | 7 of 10 OK created view model dev.customer_language_preference....... [CREATE VIEW in 0.06s]
2020-08-12 20:07:12.613829 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 20:07:12.614094 (Thread-1): Began running node model.dbt_play.customer_category_preference
2020-08-12 20:07:12.615355 (Thread-1): 16:07:12 | 8 of 10 START view model dev.customer_category_preference............ [RUN]
2020-08-12 20:07:12.615975 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:07:12.616126 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:12.616239 (Thread-1): Compiling model.dbt_play.customer_category_preference
2020-08-12 20:07:12.632426 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_category_preference"
2020-08-12 20:07:12.633612 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.653049 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:07:12.653341 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_tmp" cascade
2020-08-12 20:07:12.669619 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 20:07:12.672205 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:07:12.672385 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_backup" cascade
2020-08-12 20:07:12.672726 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.674453 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_category_preference"
2020-08-12 20:07:12.675620 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:07:12.675872 (Thread-1): On model.dbt_play.customer_category_preference: BEGIN
2020-08-12 20:07:12.676272 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.676423 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:07:12.676531 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */

  create view "dvd_rental"."dev"."customer_category_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_category_preference as (
    SELECT 
        customer_id, 
        film_category, 
        count(*) as number, 
        sum(payment_amount) as dollars 
    FROM rental_details 
    GROUP BY customer_id, film_category
    ORDER BY customer_id ASC, count(*) DESC
)

SELECT * FROM customer_category_preference
  );

2020-08-12 20:07:12.694048 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 20:07:12.699304 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:07:12.699660 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
alter table "dvd_rental"."dev"."customer_category_preference__dbt_tmp" rename to "customer_category_preference"
2020-08-12 20:07:12.700889 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.702697 (Thread-1): On model.dbt_play.customer_category_preference: COMMIT
2020-08-12 20:07:12.703023 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:07:12.703303 (Thread-1): On model.dbt_play.customer_category_preference: COMMIT
2020-08-12 20:07:12.704253 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:07:12.706668 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:07:12.706853 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_backup" cascade
2020-08-12 20:07:12.707240 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.709705 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.709964 (Thread-1): On model.dbt_play.customer_category_preference: Close
2020-08-12 20:07:12.710541 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa19ec6550>]}
2020-08-12 20:07:12.712074 (Thread-1): 16:07:12 | 8 of 10 OK created view model dev.customer_category_preference....... [CREATE VIEW in 0.09s]
2020-08-12 20:07:12.712474 (Thread-1): Finished running node model.dbt_play.customer_category_preference
2020-08-12 20:07:12.712933 (Thread-1): Began running node model.dbt_play.customer_rating_preferences
2020-08-12 20:07:12.714625 (Thread-1): 16:07:12 | 9 of 10 START view model dev.customer_rating_preferences............. [RUN]
2020-08-12 20:07:12.715055 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:07:12.715188 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:12.715303 (Thread-1): Compiling model.dbt_play.customer_rating_preferences
2020-08-12 20:07:12.732442 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rating_preferences"
2020-08-12 20:07:12.733163 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.755574 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:07:12.755767 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" cascade
2020-08-12 20:07:12.765064 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:07:12.767624 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:07:12.767839 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_backup" cascade
2020-08-12 20:07:12.768179 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.769693 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rating_preferences"
2020-08-12 20:07:12.770220 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:07:12.770331 (Thread-1): On model.dbt_play.customer_rating_preferences: BEGIN
2020-08-12 20:07:12.770683 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.770801 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:07:12.770896 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */

  create view "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_rating_preference as (
    SELECT 
        customer_id, 
        film_rating, 
        count(*) as number, 
        sum(payment_amount) as dollars 
    FROM rental_details 
    GROUP BY customer_id, film_rating
    ORDER BY customer_id ASC, count(*) DESC
)

SELECT * FROM customer_rating_preference
  );

2020-08-12 20:07:12.785414 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:07:12.788359 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:07:12.788724 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
alter table "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" rename to "customer_rating_preferences"
2020-08-12 20:07:12.790125 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:12.792802 (Thread-1): On model.dbt_play.customer_rating_preferences: COMMIT
2020-08-12 20:07:12.793078 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:07:12.793255 (Thread-1): On model.dbt_play.customer_rating_preferences: COMMIT
2020-08-12 20:07:12.798302 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:07:12.803888 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:07:12.804186 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_backup" cascade
2020-08-12 20:07:12.804689 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:07:12.807480 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.807802 (Thread-1): On model.dbt_play.customer_rating_preferences: Close
2020-08-12 20:07:12.808507 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a0f80d0>]}
2020-08-12 20:07:12.809753 (Thread-1): 16:07:12 | 9 of 10 OK created view model dev.customer_rating_preferences........ [CREATE VIEW in 0.09s]
2020-08-12 20:07:12.809989 (Thread-1): Finished running node model.dbt_play.customer_rating_preferences
2020-08-12 20:07:12.810281 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 20:07:12.813073 (Thread-1): 16:07:12 | 10 of 10 START table model dev.customer_profile...................... [RUN]
2020-08-12 20:07:12.814090 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:12.814319 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:07:12.814492 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 20:07:12.836899 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 20:07:12.837482 (Thread-1): finished collecting timing info
2020-08-12 20:07:12.870653 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:12.870835 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 20:07:12.879443 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 20:07:12.881869 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:12.882002 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 20:07:12.882329 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 20:07:12.889666 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 20:07:12.890440 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:12.890620 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 20:07:12.891065 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:07:12.891193 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:12.891289 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
lang as (
    SELECT * FROM "dvd_rental"."dev"."customer_language_preference"
),
behave as (
    SELECT *FROM "dvd_rental"."dev"."customer_behaviour"
),
customer_profile as (
    SELECT 
        customer.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.period_days,
        ltv.life_time_value,
        rental.num_rental,
        behave.num_return,
        behave.num_late,
        behave.num_paid,
        lang.language
    FROM customer
    LEFT JOIN rental USING(customer_id)
    LEFT JOIN ltv USING(customer_id)
    LEFT JOIN lang USING(customer_id)
    LEFT JOIN behave USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 20:07:13.014201 (Thread-1): SQL status: SELECT 599 in 0.12 seconds
2020-08-12 20:07:13.018528 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:13.018675 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile" rename to "customer_profile__dbt_backup"
2020-08-12 20:07:13.019318 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:13.021979 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:13.022304 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 20:07:13.023012 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:07:13.024645 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 20:07:13.024828 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:13.024941 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 20:07:13.025830 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:07:13.027860 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:07:13.027999 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 20:07:13.031184 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 20:07:13.034013 (Thread-1): finished collecting timing info
2020-08-12 20:07:13.034319 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 20:07:13.034950 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f1f2bd3-30e9-4374-978f-56044ba033a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a028cd0>]}
2020-08-12 20:07:13.036771 (Thread-1): 16:07:13 | 10 of 10 OK created table model dev.customer_profile................. [SELECT 599 in 0.22s]
2020-08-12 20:07:13.037009 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 20:07:13.117993 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:07:13.118267 (MainThread): Opening a new connection, currently in state closed
2020-08-12 20:07:13.118509 (MainThread): Using postgres connection "master".
2020-08-12 20:07:13.118677 (MainThread): On master: BEGIN
2020-08-12 20:07:13.127137 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:07:13.127385 (MainThread): On master: COMMIT
2020-08-12 20:07:13.127512 (MainThread): Using postgres connection "master".
2020-08-12 20:07:13.127623 (MainThread): On master: COMMIT
2020-08-12 20:07:13.127949 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:07:13.128195 (MainThread): On master: Close
2020-08-12 20:07:13.128881 (MainThread): 16:07:13 | 
2020-08-12 20:07:13.129198 (MainThread): 16:07:13 | Finished running 9 view models, 1 table model in 1.73s.
2020-08-12 20:07:13.129468 (MainThread): Connection 'master' was properly closed.
2020-08-12 20:07:13.129684 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 20:07:13.164289 (MainThread): 
2020-08-12 20:07:13.164521 (MainThread): Completed successfully
2020-08-12 20:07:13.164785 (MainThread): 
Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
2020-08-12 20:07:13.165045 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a150d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a02f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a0bd2d0>]}
2020-08-12 20:07:13.165275 (MainThread): Flushing usage events
2020-08-12 20:26:41.368465 (MainThread): Running with dbt=0.17.2
2020-08-12 20:26:41.452617 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 20:26:41.454935 (MainThread): Tracking: tracking
2020-08-12 20:26:41.483245 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22947bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff02710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22937050>]}
2020-08-12 20:26:41.510367 (MainThread): Partial parsing not enabled
2020-08-12 20:26:41.513581 (MainThread): Parsing macros/core.sql
2020-08-12 20:26:41.520695 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:26:41.531327 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:26:41.533694 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:26:41.558311 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:26:41.598964 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:26:41.629522 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:26:41.631868 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:26:41.641188 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:26:41.661783 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:26:41.670852 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:26:41.681437 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:26:41.688334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:26:41.689934 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:26:41.691294 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:26:41.693433 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:26:41.704811 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:26:41.707240 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:26:41.709720 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:26:41.782156 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:26:41.784056 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:26:41.785375 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:26:41.786790 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:26:41.789910 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:26:41.792854 (MainThread): Parsing macros/relations.sql
2020-08-12 20:26:41.794526 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:26:41.823552 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:26:41.849828 (MainThread): Partial parsing not enabled
2020-08-12 20:26:41.893038 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:26:41.893220 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:41.932694 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:26:41.932875 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:41.948308 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:26:41.948518 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:41.962865 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:26:41.963118 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:41.979109 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:26:41.979317 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:41.992174 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:26:41.992343 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:42.005500 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:26:42.005693 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:42.020532 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:26:42.020707 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:42.033756 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:26:42.033929 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:42.048880 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:26:42.049060 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:26:42.063135 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22f11310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22f953d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22f95810>]}
2020-08-12 20:26:42.063475 (MainThread): Flushing usage events
2020-08-12 20:26:44.062447 (MainThread): Connection 'model.dbt_play.customer_rating_preferences' was properly closed.
2020-08-12 20:26:44.062715 (MainThread): Encountered an error:
2020-08-12 20:26:44.062897 (MainThread): Compilation Error
  Error reading dbt_play: schema.yml - Runtime Error
    Syntax error near line 20
    ------------------------------
    17 |                 values: [TRUE, FALSE]
    18 |         - name: last_initial
    19 |           description: the first initial of the customers last name
    20 |           - accepted_values:
    21 |               values: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
    22 |         - name: city
    23 |           description: the customer city
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 18, column 11
    did not find expected key
      in "<unicode string>", line 20, column 11
2020-08-12 20:26:44.068974 (MainThread): Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/yaml/constructor.py", line 41, in get_single_data
    node = self.get_single_node()
  File "ext/_yaml.pyx", line 707, in _yaml.CParser.get_single_node
  File "ext/_yaml.pyx", line 725, in _yaml.CParser._compose_document
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 851, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 851, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 892, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 905, in _yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 18, column 11
did not find expected key
  in "<unicode string>", line 20, column 11

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 213, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 20
  ------------------------------
  17 |                 values: [TRUE, FALSE]
  18 |         - name: last_initial
  19 |           description: the first initial of the customers last name
  20 |           - accepted_values:
  21 |               values: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
  22 |         - name: city
  23 |           description: the customer city
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 18, column 11
  did not find expected key
    in "<unicode string>", line 20, column 11

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 390, in run
    self._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 506, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 218, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading dbt_play: schema.yml - Runtime Error
    Syntax error near line 20
    ------------------------------
    17 |                 values: [TRUE, FALSE]
    18 |         - name: last_initial
    19 |           description: the first initial of the customers last name
    20 |           - accepted_values:
    21 |               values: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
    22 |         - name: city
    23 |           description: the customer city
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 18, column 11
    did not find expected key
      in "<unicode string>", line 20, column 11

2020-08-12 20:27:19.337602 (MainThread): Running with dbt=0.17.2
2020-08-12 20:27:19.423725 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 20:27:19.424903 (MainThread): Tracking: tracking
2020-08-12 20:27:19.443873 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22fae150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22fc8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa22f9e550>]}
2020-08-12 20:27:19.474552 (MainThread): Partial parsing not enabled
2020-08-12 20:27:19.477588 (MainThread): Parsing macros/core.sql
2020-08-12 20:27:19.485763 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:27:19.496642 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:27:19.498952 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:27:19.522562 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:27:19.564144 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:27:19.593746 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:27:19.596063 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:27:19.604118 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:27:19.624074 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:27:19.632786 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:27:19.641038 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:27:19.648941 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:27:19.650239 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:27:19.651854 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:27:19.654554 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:27:19.666995 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:27:19.669878 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:27:19.672050 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:27:19.740035 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:27:19.741922 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:27:19.743236 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:27:19.745176 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:27:19.748988 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:27:19.753203 (MainThread): Parsing macros/relations.sql
2020-08-12 20:27:19.755202 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:27:19.786759 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:27:19.810931 (MainThread): Partial parsing not enabled
2020-08-12 20:27:19.854499 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:27:19.854682 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:19.899320 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:27:19.899528 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:19.912271 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:27:19.912467 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:19.925673 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:27:19.925863 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:19.939844 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:27:19.940719 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:19.957386 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:27:19.957569 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:19.973088 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:27:19.973273 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:19.996838 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:27:19.997067 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:20.019024 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:27:20.019253 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:20.036937 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:27:20.037132 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:27:20.055140 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa23593a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa235c1b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa235c12d0>]}
2020-08-12 20:27:20.055428 (MainThread): Flushing usage events
2020-08-12 20:27:20.266166 (MainThread): Connection 'model.dbt_play.customer_rating_preferences' was properly closed.
2020-08-12 20:27:20.268974 (MainThread): Encountered an error:
2020-08-12 20:27:20.269472 (MainThread): Compilation Error
  Error reading dbt_play: schema.yml - Runtime Error
    Syntax error near line 18
    ------------------------------
    15 |             - not_null
    16 |         - name: last_initial
    17 |           description: the first initial of the customers last name
    18 |           - accepted_values:
    19 |               values: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
    20 |         - name: city
    21 |           description: the customer city
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 16, column 11
    did not find expected key
      in "<unicode string>", line 18, column 11
2020-08-12 20:27:20.272619 (MainThread): Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 62, in load_yaml_text
    return safe_load(contents)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 57, in safe_load
    return yaml.load(contents, Loader=YamlLoader)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/yaml/constructor.py", line 41, in get_single_data
    node = self.get_single_node()
  File "ext/_yaml.pyx", line 707, in _yaml.CParser.get_single_node
  File "ext/_yaml.pyx", line 725, in _yaml.CParser._compose_document
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 851, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 890, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 774, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 851, in _yaml.CParser._compose_sequence_node
  File "ext/_yaml.pyx", line 776, in _yaml.CParser._compose_node
  File "ext/_yaml.pyx", line 892, in _yaml.CParser._compose_mapping_node
  File "ext/_yaml.pyx", line 905, in _yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 16, column 11
did not find expected key
  in "<unicode string>", line 18, column 11

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 213, in _yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/clients/yaml_helper.py", line 69, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 18
  ------------------------------
  15 |             - not_null
  16 |         - name: last_initial
  17 |           description: the first initial of the customers last name
  18 |           - accepted_values:
  19 |               values: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
  20 |         - name: city
  21 |           description: the customer city
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 16, column 11
  did not find expected key
    in "<unicode string>", line 18, column 11

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 390, in run
    self._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 506, in parse_file
    dct = self._yaml_from_file(block.file)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 218, in _yaml_from_file
    .format(self.project.project_name, path, reason)
dbt.exceptions.CompilationException: Compilation Error
  Error reading dbt_play: schema.yml - Runtime Error
    Syntax error near line 18
    ------------------------------
    15 |             - not_null
    16 |         - name: last_initial
    17 |           description: the first initial of the customers last name
    18 |           - accepted_values:
    19 |               values: ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
    20 |         - name: city
    21 |           description: the customer city
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 16, column 11
    did not find expected key
      in "<unicode string>", line 18, column 11

2020-08-12 20:28:26.619887 (MainThread): Running with dbt=0.17.2
2020-08-12 20:28:26.703636 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 20:28:26.704970 (MainThread): Tracking: tracking
2020-08-12 20:28:26.723897 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa18626650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa18616050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa18616c50>]}
2020-08-12 20:28:26.752873 (MainThread): Partial parsing not enabled
2020-08-12 20:28:26.755245 (MainThread): Parsing macros/core.sql
2020-08-12 20:28:26.762411 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:28:26.773631 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:28:26.776784 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:28:26.799630 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:28:26.839443 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:28:26.869570 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:28:26.872133 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:28:26.882370 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:28:26.901251 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:28:26.911418 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:28:26.920435 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:28:26.926758 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:28:26.927948 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:28:26.929453 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:28:26.931449 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:28:26.945054 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:28:26.948328 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:28:26.950417 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:28:27.019154 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:28:27.020890 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:28:27.022171 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:28:27.023478 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:28:27.026352 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:28:27.029229 (MainThread): Parsing macros/relations.sql
2020-08-12 20:28:27.030895 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:28:27.063673 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:28:27.091855 (MainThread): Partial parsing not enabled
2020-08-12 20:28:27.133998 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:28:27.134187 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.182021 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:28:27.182205 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.197242 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:28:27.197427 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.209772 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:28:27.209961 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.222909 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:28:27.223081 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.235220 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:28:27.235404 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.250609 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:28:27.250834 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.266024 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:28:27.266202 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.281762 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:28:27.281938 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.296977 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:28:27.297176 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:27.318862 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa18a60250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa18c00e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa18c51ed0>]}
2020-08-12 20:28:27.319183 (MainThread): Flushing usage events
2020-08-12 20:28:28.760939 (MainThread): Connection 'model.dbt_play.customer_rating_preferences' was properly closed.
2020-08-12 20:28:28.761195 (MainThread): Encountered an error:
2020-08-12 20:28:28.761382 (MainThread): Compilation Error
  The schema file at schema.yml is invalid because version 1 is not supported. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files
2020-08-12 20:28:28.763599 (MainThread): Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 390, in run
    self._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 520, in parse_file
    self._parse_format_version(yaml_block)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 203, in _parse_format_version
    path, 'version {} is not supported'.format(version)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/exceptions.py", line 860, in raise_invalid_schema_yml_version
    .format(path, issue)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at schema.yml is invalid because version 1 is not supported. Please consult the documentation for more information on schema.yml syntax:
  
  https://docs.getdbt.com/docs/schemayml-files

2020-08-12 20:28:40.931876 (MainThread): Running with dbt=0.17.2
2020-08-12 20:28:41.054061 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 20:28:41.055995 (MainThread): Tracking: tracking
2020-08-12 20:28:41.083057 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bc8da10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8d2510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8d2c10>]}
2020-08-12 20:28:41.125971 (MainThread): Partial parsing not enabled
2020-08-12 20:28:41.132313 (MainThread): Parsing macros/core.sql
2020-08-12 20:28:41.143237 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:28:41.158192 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:28:41.161433 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:28:41.192727 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:28:41.240193 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:28:41.273542 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:28:41.276233 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:28:41.285641 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:28:41.306469 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:28:41.315883 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:28:41.324548 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:28:41.332211 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:28:41.333508 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:28:41.334818 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:28:41.337315 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:28:41.350153 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:28:41.354879 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:28:41.357027 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:28:41.453277 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:28:41.455366 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:28:41.456556 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:28:41.458361 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:28:41.462148 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:28:41.466651 (MainThread): Parsing macros/relations.sql
2020-08-12 20:28:41.469169 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:28:41.502365 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:28:41.529165 (MainThread): Partial parsing not enabled
2020-08-12 20:28:41.602552 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:28:41.602731 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.645071 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:28:41.645249 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.658035 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:28:41.658565 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.673310 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:28:41.673586 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.686107 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:28:41.686293 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.700432 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:28:41.700734 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.714673 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:28:41.714858 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.734324 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:28:41.734729 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.763581 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:28:41.763769 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.779692 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:28:41.779901 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:28:41.899249 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bec9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bebe110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bef4a90>]}
2020-08-12 20:28:41.899546 (MainThread): Flushing usage events
2020-08-12 20:28:42.113756 (MainThread): Connection 'model.dbt_play.customer_rating_preferences' was properly closed.
2020-08-12 20:28:42.114140 (MainThread): Encountered an error:
2020-08-12 20:28:42.115477 (MainThread): Compilation Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)
2020-08-12 20:28:42.120300 (MainThread): Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 355, in _parse_generic_test
    render_ctx=render_ctx,
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schema_test_builders.py", line 192, in __init__
    test_name, test_args = self.extract_test_args(test, column_name)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schema_test_builders.py", line 243, in extract_test_args
    ' {} instead ({} keys)'.format(test, len(test))
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/exceptions.py", line 396, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'])] instead (2 keys)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 81, in main
    results, succeeded = handle_and_check(args)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 159, in handle_and_check
    task, res = run_from_args(parsed)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/main.py", line 212, in run_from_args
    results = task.run()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 390, in run
    self._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 103, in _runtime_initialize
    super()._runtime_initialize()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 71, in _runtime_initialize
    self.load_manifest()
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/task/runnable.py", line 60, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/perf_utils.py", line 23, in get_full_manifest
    return load_manifest(config, internal, set_header)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 641, in load_manifest
    return ManifestLoader.load_all(config, internal_manifest, macro_hook)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 356, in load_all
    loader.load(internal_manifest=internal_manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 212, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 186, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/manifest.py", line 142, in parse_with_cache
    parser.parse_file(block)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 534, in parse_file
    self.parse_tests(test_block)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 500, in parse_tests
    self.parse_column_tests(block, column)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 229, in parse_column_tests
    self.parse_test(block, test, column)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 496, in parse_test
    self.parse_node(block)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 446, in parse_node
    column_name=block.column_name,
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/parser/schemas.py", line 364, in _parse_generic_test
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)

2020-08-12 20:29:15.557978 (MainThread): Running with dbt=0.17.2
2020-08-12 20:29:15.638934 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 20:29:15.640124 (MainThread): Tracking: tracking
2020-08-12 20:29:15.659068 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d74a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad2e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d744390>]}
2020-08-12 20:29:15.688293 (MainThread): Partial parsing not enabled
2020-08-12 20:29:15.690325 (MainThread): Parsing macros/core.sql
2020-08-12 20:29:15.698302 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:29:15.708867 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:29:15.711181 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:29:15.733636 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:29:15.774376 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:29:15.803174 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:29:15.805509 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:29:15.814037 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:29:15.832815 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:29:15.841474 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:29:15.849752 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:29:15.856920 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:29:15.858180 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:29:15.859837 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:29:15.863066 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:29:15.875771 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:29:15.878602 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:29:15.880680 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:29:15.952112 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:29:15.953815 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:29:15.955541 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:29:15.957345 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:29:15.960770 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:29:15.964292 (MainThread): Parsing macros/relations.sql
2020-08-12 20:29:15.966439 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:29:15.998554 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:29:16.024596 (MainThread): Partial parsing not enabled
2020-08-12 20:29:16.067249 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:16.067424 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.112954 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:29:16.113140 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.126865 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:16.127206 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.141219 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:16.141390 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.153067 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:16.153275 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.166630 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:16.166804 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.180979 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:16.181164 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.195857 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:16.196112 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.210579 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:16.210789 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.223716 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:16.223969 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.531964 (MainThread): Found 10 models, 5 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 20:29:16.533948 (MainThread): 
2020-08-12 20:29:16.534447 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:29:16.534592 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:16.558577 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 20:29:16.559232 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 20:29:16.574156 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 20:29:16.574367 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 20:29:16.588036 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.01 seconds
2020-08-12 20:29:16.592045 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 20:29:16.619711 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 20:29:16.619985 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 20:29:16.628488 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:29:16.628672 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 20:29:16.638957 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:16.639154 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:29:16.639261 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 20:29:16.644367 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2020-08-12 20:29:16.652991 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 20:29:16.653569 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 20:29:16.682240 (MainThread): Using postgres connection "master".
2020-08-12 20:29:16.682420 (MainThread): On master: BEGIN
2020-08-12 20:29:16.691599 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:16.691801 (MainThread): Using postgres connection "master".
2020-08-12 20:29:16.691905 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 20:29:17.158355 (MainThread): SQL status: SELECT 55 in 0.47 seconds
2020-08-12 20:29:17.230153 (MainThread): On master: ROLLBACK
2020-08-12 20:29:17.230574 (MainThread): Using postgres connection "master".
2020-08-12 20:29:17.230695 (MainThread): On master: BEGIN
2020-08-12 20:29:17.231008 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:17.231130 (MainThread): On master: COMMIT
2020-08-12 20:29:17.231232 (MainThread): Using postgres connection "master".
2020-08-12 20:29:17.231323 (MainThread): On master: COMMIT
2020-08-12 20:29:17.231554 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:29:17.231695 (MainThread): On master: Close
2020-08-12 20:29:17.232077 (MainThread): 16:29:17 | Concurrency: 1 threads (target='dev')
2020-08-12 20:29:17.232277 (MainThread): 16:29:17 | 
2020-08-12 20:29:17.234292 (Thread-1): Began running node model.dbt_play.rental_payment
2020-08-12 20:29:17.235779 (Thread-1): 16:29:17 | 1 of 10 START view model dev.rental_payment.......................... [RUN]
2020-08-12 20:29:17.236364 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:17.236506 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:17.236654 (Thread-1): Compiling model.dbt_play.rental_payment
2020-08-12 20:29:17.255592 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_payment"
2020-08-12 20:29:17.257976 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.301145 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:17.301715 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_tmp" cascade
2020-08-12 20:29:17.310488 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:29:17.313238 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:17.313397 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 20:29:17.313797 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.318848 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_payment"
2020-08-12 20:29:17.319427 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:17.319611 (Thread-1): On model.dbt_play.rental_payment: BEGIN
2020-08-12 20:29:17.320318 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:17.320488 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:17.320591 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */

  create view "dvd_rental"."dev"."rental_payment__dbt_tmp" as (
    with rental_payment as(
    SELECT 
        rental_id, 
        sum(amount) as amount 
    FROM dvd_rental.public.payment 
    GROUP BY rental_id
)

SELECT * FROM rental_payment
  );

2020-08-12 20:29:17.330033 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:29:17.339144 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:17.339630 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment" rename to "rental_payment__dbt_backup"
2020-08-12 20:29:17.340351 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.342776 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:17.342942 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment__dbt_tmp" rename to "rental_payment"
2020-08-12 20:29:17.343503 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.352167 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 20:29:17.352362 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:17.352473 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 20:29:17.354199 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:29:17.359993 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:17.360187 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 20:29:17.364027 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.367044 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.367344 (Thread-1): On model.dbt_play.rental_payment: Close
2020-08-12 20:29:17.368006 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1de4dd50>]}
2020-08-12 20:29:17.369280 (Thread-1): 16:29:17 | 1 of 10 OK created view model dev.rental_payment..................... [CREATE VIEW in 0.13s]
2020-08-12 20:29:17.369529 (Thread-1): Finished running node model.dbt_play.rental_payment
2020-08-12 20:29:17.369700 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 20:29:17.371108 (Thread-1): 16:29:17 | 2 of 10 START view model dev.customer................................ [RUN]
2020-08-12 20:29:17.371837 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:29:17.372126 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:17.372359 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 20:29:17.379298 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 20:29:17.380361 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.391545 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:29:17.391816 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 20:29:17.403112 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:29:17.407855 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:29:17.408156 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 20:29:17.408763 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.410565 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 20:29:17.411181 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:29:17.411335 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 20:29:17.411751 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:17.411881 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:29:17.411978 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 20:29:17.442716 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2020-08-12 20:29:17.449219 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:29:17.449422 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 20:29:17.450113 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.452783 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:29:17.452939 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 20:29:17.453816 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.455678 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 20:29:17.455866 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:29:17.455972 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 20:29:17.457320 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:29:17.460269 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:29:17.460458 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 20:29:17.462222 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.464939 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.465208 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 20:29:17.465792 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1df88090>]}
2020-08-12 20:29:17.466988 (Thread-1): 16:29:17 | 2 of 10 OK created view model dev.customer........................... [CREATE VIEW in 0.09s]
2020-08-12 20:29:17.467195 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 20:29:17.467355 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 20:29:17.468620 (Thread-1): 16:29:17 | 3 of 10 START view model dev.customer_life_time_value................ [RUN]
2020-08-12 20:29:17.469069 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:17.469208 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:17.469324 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 20:29:17.476165 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 20:29:17.476812 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.486190 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:17.486389 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 20:29:17.498298 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:29:17.504178 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:17.504781 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 20:29:17.505768 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.508204 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 20:29:17.509003 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:17.509163 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 20:29:17.509573 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:17.509708 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:17.509815 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 20:29:17.513228 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:29:17.517885 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:17.567165 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 20:29:17.567831 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.570439 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:17.570629 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 20:29:17.571274 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.573053 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 20:29:17.573310 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:17.573498 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 20:29:17.574234 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:29:17.576057 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:17.576177 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 20:29:17.577626 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.580258 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.580529 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 20:29:17.581126 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b760250>]}
2020-08-12 20:29:17.582333 (Thread-1): 16:29:17 | 3 of 10 OK created view model dev.customer_life_time_value........... [CREATE VIEW in 0.11s]
2020-08-12 20:29:17.582551 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 20:29:17.582761 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 20:29:17.584086 (Thread-1): 16:29:17 | 4 of 10 START view model dev.customer_rental_summary................. [RUN]
2020-08-12 20:29:17.584532 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:17.584674 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:17.584797 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 20:29:17.591868 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 20:29:17.593188 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.603343 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:17.603633 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 20:29:17.612449 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:29:17.616017 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:17.616209 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 20:29:17.616615 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.618075 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 20:29:17.618808 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:17.619160 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 20:29:17.619706 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:17.620057 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:17.620534 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 20:29:17.641781 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 20:29:17.646594 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:17.646777 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 20:29:17.647544 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.650618 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:17.650810 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 20:29:17.651469 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.652895 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 20:29:17.653083 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:17.653194 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 20:29:17.656405 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:29:17.659675 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:17.659959 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 20:29:17.661435 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.664059 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.664374 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 20:29:17.665433 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1dd2b210>]}
2020-08-12 20:29:17.667276 (Thread-1): 16:29:17 | 4 of 10 OK created view model dev.customer_rental_summary............ [CREATE VIEW in 0.08s]
2020-08-12 20:29:17.667503 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 20:29:17.667778 (Thread-1): Began running node model.dbt_play.rental_details
2020-08-12 20:29:17.669117 (Thread-1): 16:29:17 | 5 of 10 START view model dev.rental_details.......................... [RUN]
2020-08-12 20:29:17.669716 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:17.669904 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:17.670454 (Thread-1): Compiling model.dbt_play.rental_details
2020-08-12 20:29:17.683701 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_details"
2020-08-12 20:29:17.684263 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.702854 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:17.703036 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_tmp" cascade
2020-08-12 20:29:17.716748 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:29:17.725724 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:17.726100 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 20:29:17.726769 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.728696 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_details"
2020-08-12 20:29:17.729284 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:17.729424 (Thread-1): On model.dbt_play.rental_details: BEGIN
2020-08-12 20:29:17.729807 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:17.729925 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:17.730030 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */

  create view "dvd_rental"."dev"."rental_details__dbt_tmp" as (
    with rental_payment as (
    SELECT * FROM "dvd_rental"."dev"."rental_payment"
),
rental_details as(
    SELECT
        r.rental_id,
        r.customer_id,
        r.rental_date,
        CASE WHEN r.return_date is null THEN FALSE ELSE TRUE END as returned,
        CASE WHEN date_part('day', return_date - rental_date) > f.rental_duration THEN TRUE ELSE FALSE END as late,
        CASE WHEN rental_payment.amount is null THEN FALSE WHEN rental_payment.amount <= 0 THEN FALSE ELSE TRUE END as paid,
        f.title as film_title,
        f.rating as film_rating,
        l.name as film_language,
        c.name as film_category,
        CASE WHEN rental_payment.amount is null THEN 0 ELSE rental_payment.amount END as payment_amount
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film f ON i.film_id = f.film_id
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    INNER JOIN dvd_rental.public.film_category fc ON f.film_id = fc.film_id
    INNER JOIN dvd_rental.public.category c ON fc.category_id = c.category_id
    LEFT JOIN rental_payment ON r.rental_id = rental_payment.rental_id
)

SELECT * FROM rental_details
  );

2020-08-12 20:29:17.737129 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:29:17.739593 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:17.739721 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
alter table "dvd_rental"."dev"."rental_details__dbt_tmp" rename to "rental_details"
2020-08-12 20:29:17.741009 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.742579 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 20:29:17.742737 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:17.742833 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 20:29:17.749534 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:29:17.751483 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:17.751618 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 20:29:17.751928 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.757003 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.757736 (Thread-1): On model.dbt_play.rental_details: Close
2020-08-12 20:29:17.758861 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1de7fa90>]}
2020-08-12 20:29:17.761463 (Thread-1): 16:29:17 | 5 of 10 OK created view model dev.rental_details..................... [CREATE VIEW in 0.09s]
2020-08-12 20:29:17.761677 (Thread-1): Finished running node model.dbt_play.rental_details
2020-08-12 20:29:17.762157 (Thread-1): Began running node model.dbt_play.customer_behaviour
2020-08-12 20:29:17.763249 (Thread-1): 16:29:17 | 6 of 10 START view model dev.customer_behaviour...................... [RUN]
2020-08-12 20:29:17.763644 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:17.763768 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:17.763880 (Thread-1): Compiling model.dbt_play.customer_behaviour
2020-08-12 20:29:17.774574 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 20:29:17.775748 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.783122 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:17.783304 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_tmp" cascade
2020-08-12 20:29:17.794676 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:29:17.800425 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:17.800735 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 20:29:17.801720 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.806548 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 20:29:17.807728 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:17.807931 (Thread-1): On model.dbt_play.customer_behaviour: BEGIN
2020-08-12 20:29:17.808348 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:17.808510 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:17.808617 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */

  create view "dvd_rental"."dev"."customer_behaviour__dbt_tmp" as (
    with rental_details as (
    SELECT 
        customer_id,
        returned,
        late, 
        paid
    FROM "dvd_rental"."dev"."rental_details"
),
customer_behaviour as(
    SELECT 
        customer_id, 
        sum(cast(returned as int)) as num_return, 
        sum(cast(late as int)) as num_late, 
        sum(cast(paid as int)) as num_paid 
    FROM rental_details 
    GROUP BY customer_id
)

SELECT * FROM customer_behaviour
  );

2020-08-12 20:29:17.812585 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:29:17.815451 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:17.815601 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
alter table "dvd_rental"."dev"."customer_behaviour__dbt_tmp" rename to "customer_behaviour"
2020-08-12 20:29:17.816306 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.817568 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 20:29:17.817694 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:17.817793 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 20:29:17.824539 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:29:17.826899 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:17.827090 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 20:29:17.827462 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.831335 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.831672 (Thread-1): On model.dbt_play.customer_behaviour: Close
2020-08-12 20:29:17.832886 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1dd2e810>]}
2020-08-12 20:29:17.834190 (Thread-1): 16:29:17 | 6 of 10 OK created view model dev.customer_behaviour................. [CREATE VIEW in 0.07s]
2020-08-12 20:29:17.834430 (Thread-1): Finished running node model.dbt_play.customer_behaviour
2020-08-12 20:29:17.834687 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 20:29:17.836118 (Thread-1): 16:29:17 | 7 of 10 START view model dev.customer_language_preference............ [RUN]
2020-08-12 20:29:17.836738 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:17.836947 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:17.837129 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 20:29:17.846783 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 20:29:17.847874 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.860899 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:17.861105 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 20:29:17.874392 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:29:17.878516 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:17.878749 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 20:29:17.879158 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.880489 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 20:29:17.881070 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:17.881202 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 20:29:17.881636 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:17.881756 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:17.881859 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_language_preference as (
    SELECT DISTINCT ON (customer_id)
        customer_id,
        film_language as language
    FROM rental_details
    GROUP BY customer_id, film_language
    ORDER BY customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 20:29:17.887533 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:29:17.892479 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:17.892772 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 20:29:17.893805 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.895724 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 20:29:17.895934 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:17.896052 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 20:29:17.903090 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:29:17.905422 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:17.905597 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 20:29:17.905937 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.908877 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.909317 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 20:29:17.910031 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1de42310>]}
2020-08-12 20:29:17.911572 (Thread-1): 16:29:17 | 7 of 10 OK created view model dev.customer_language_preference....... [CREATE VIEW in 0.07s]
2020-08-12 20:29:17.911804 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 20:29:17.912045 (Thread-1): Began running node model.dbt_play.customer_category_preference
2020-08-12 20:29:17.913358 (Thread-1): 16:29:17 | 8 of 10 START view model dev.customer_category_preference............ [RUN]
2020-08-12 20:29:17.913997 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:17.914145 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:17.914305 (Thread-1): Compiling model.dbt_play.customer_category_preference
2020-08-12 20:29:17.928030 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_category_preference"
2020-08-12 20:29:17.928946 (Thread-1): finished collecting timing info
2020-08-12 20:29:17.938946 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:17.939523 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_tmp" cascade
2020-08-12 20:29:17.951930 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:29:17.964942 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:17.965219 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_backup" cascade
2020-08-12 20:29:17.965724 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:17.967345 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_category_preference"
2020-08-12 20:29:17.967994 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:17.968333 (Thread-1): On model.dbt_play.customer_category_preference: BEGIN
2020-08-12 20:29:17.969152 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:17.969329 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:17.969438 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */

  create view "dvd_rental"."dev"."customer_category_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_category_preference as (
    SELECT 
        customer_id, 
        film_category, 
        count(*) as number, 
        sum(payment_amount) as dollars 
    FROM rental_details 
    GROUP BY customer_id, film_category
    ORDER BY customer_id ASC, count(*) DESC
)

SELECT * FROM customer_category_preference
  );

2020-08-12 20:29:17.974324 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:29:17.977163 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:17.977347 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
alter table "dvd_rental"."dev"."customer_category_preference__dbt_tmp" rename to "customer_category_preference"
2020-08-12 20:29:17.978018 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:17.979947 (Thread-1): On model.dbt_play.customer_category_preference: COMMIT
2020-08-12 20:29:17.980148 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:17.980355 (Thread-1): On model.dbt_play.customer_category_preference: COMMIT
2020-08-12 20:29:17.997918 (Thread-1): SQL status: COMMIT in 0.02 seconds
2020-08-12 20:29:17.999842 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:17.999967 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_backup" cascade
2020-08-12 20:29:18.000279 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:18.002931 (Thread-1): finished collecting timing info
2020-08-12 20:29:18.003836 (Thread-1): On model.dbt_play.customer_category_preference: Close
2020-08-12 20:29:18.004781 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1dbaafd0>]}
2020-08-12 20:29:18.006281 (Thread-1): 16:29:18 | 8 of 10 OK created view model dev.customer_category_preference....... [CREATE VIEW in 0.09s]
2020-08-12 20:29:18.006480 (Thread-1): Finished running node model.dbt_play.customer_category_preference
2020-08-12 20:29:18.006672 (Thread-1): Began running node model.dbt_play.customer_rating_preferences
2020-08-12 20:29:18.007836 (Thread-1): 16:29:18 | 9 of 10 START view model dev.customer_rating_preferences............. [RUN]
2020-08-12 20:29:18.008323 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:18.008455 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:18.008576 (Thread-1): Compiling model.dbt_play.customer_rating_preferences
2020-08-12 20:29:18.016104 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rating_preferences"
2020-08-12 20:29:18.016695 (Thread-1): finished collecting timing info
2020-08-12 20:29:18.027927 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:18.028139 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" cascade
2020-08-12 20:29:18.041440 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:29:18.045255 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:18.045445 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_backup" cascade
2020-08-12 20:29:18.045827 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:18.047153 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rating_preferences"
2020-08-12 20:29:18.047708 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:18.047828 (Thread-1): On model.dbt_play.customer_rating_preferences: BEGIN
2020-08-12 20:29:18.048206 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:18.048443 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:18.048554 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */

  create view "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_rating_preference as (
    SELECT 
        customer_id, 
        film_rating, 
        count(*) as number, 
        sum(payment_amount) as dollars 
    FROM rental_details 
    GROUP BY customer_id, film_rating
    ORDER BY customer_id ASC, count(*) DESC
)

SELECT * FROM customer_rating_preference
  );

2020-08-12 20:29:18.052986 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:29:18.061812 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:18.062007 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
alter table "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" rename to "customer_rating_preferences"
2020-08-12 20:29:18.062772 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:18.064283 (Thread-1): On model.dbt_play.customer_rating_preferences: COMMIT
2020-08-12 20:29:18.064486 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:18.064612 (Thread-1): On model.dbt_play.customer_rating_preferences: COMMIT
2020-08-12 20:29:18.070808 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:29:18.073455 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:18.073641 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_backup" cascade
2020-08-12 20:29:18.073973 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:29:18.076419 (Thread-1): finished collecting timing info
2020-08-12 20:29:18.076690 (Thread-1): On model.dbt_play.customer_rating_preferences: Close
2020-08-12 20:29:18.077284 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1de613d0>]}
2020-08-12 20:29:18.078534 (Thread-1): 16:29:18 | 9 of 10 OK created view model dev.customer_rating_preferences........ [CREATE VIEW in 0.07s]
2020-08-12 20:29:18.078773 (Thread-1): Finished running node model.dbt_play.customer_rating_preferences
2020-08-12 20:29:18.079029 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 20:29:18.080263 (Thread-1): 16:29:18 | 10 of 10 START table model dev.customer_profile...................... [RUN]
2020-08-12 20:29:18.080672 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:18.080799 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:18.080912 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 20:29:18.108741 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 20:29:18.109410 (Thread-1): finished collecting timing info
2020-08-12 20:29:18.142876 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:18.143105 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 20:29:18.151720 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 20:29:18.155343 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:18.155522 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 20:29:18.156698 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 20:29:18.165430 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 20:29:18.166056 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:18.166184 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 20:29:18.166559 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:29:18.166670 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:18.166764 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
lang as (
    SELECT * FROM "dvd_rental"."dev"."customer_language_preference"
),
behave as (
    SELECT *FROM "dvd_rental"."dev"."customer_behaviour"
),
customer_profile as (
    SELECT 
        customer.customer_id,
        customer.active,
        left(customer.last_name, 1),
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.period_days,
        ltv.life_time_value,
        rental.num_rental,
        behave.num_return,
        behave.num_late,
        behave.num_paid,
        lang.language
    FROM customer
    LEFT JOIN rental USING(customer_id)
    LEFT JOIN ltv USING(customer_id)
    LEFT JOIN lang USING(customer_id)
    LEFT JOIN behave USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 20:29:18.307106 (Thread-1): SQL status: SELECT 599 in 0.14 seconds
2020-08-12 20:29:18.311599 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:18.311798 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile" rename to "customer_profile__dbt_backup"
2020-08-12 20:29:18.312652 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:18.315818 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:18.316016 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 20:29:18.316725 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:29:18.318198 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 20:29:18.318376 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:18.318557 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 20:29:18.319516 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:29:18.321952 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:18.322303 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 20:29:18.325074 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 20:29:18.328207 (Thread-1): finished collecting timing info
2020-08-12 20:29:18.328640 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 20:29:18.329467 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96533670-2355-427e-a2ed-0b4b60018abb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1de79b10>]}
2020-08-12 20:29:18.330790 (Thread-1): 16:29:18 | 10 of 10 OK created table model dev.customer_profile................. [SELECT 599 in 0.25s]
2020-08-12 20:29:18.331025 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 20:29:18.412697 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:29:18.412901 (MainThread): Opening a new connection, currently in state closed
2020-08-12 20:29:18.413068 (MainThread): Using postgres connection "master".
2020-08-12 20:29:18.413178 (MainThread): On master: BEGIN
2020-08-12 20:29:18.422552 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:18.422828 (MainThread): On master: COMMIT
2020-08-12 20:29:18.422984 (MainThread): Using postgres connection "master".
2020-08-12 20:29:18.423103 (MainThread): On master: COMMIT
2020-08-12 20:29:18.423402 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:29:18.423616 (MainThread): On master: Close
2020-08-12 20:29:18.424346 (MainThread): 16:29:18 | 
2020-08-12 20:29:18.424568 (MainThread): 16:29:18 | Finished running 9 view models, 1 table model in 1.89s.
2020-08-12 20:29:18.424785 (MainThread): Connection 'master' was properly closed.
2020-08-12 20:29:18.424957 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 20:29:18.465694 (MainThread): 
2020-08-12 20:29:18.465929 (MainThread): Completed successfully
2020-08-12 20:29:18.466094 (MainThread): 
Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
2020-08-12 20:29:18.466746 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1de79b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1db69550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1db90e10>]}
2020-08-12 20:29:18.467319 (MainThread): Flushing usage events
2020-08-12 20:29:30.236545 (MainThread): Running with dbt=0.17.2
2020-08-12 20:29:30.322141 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-12 20:29:30.323236 (MainThread): Tracking: tracking
2020-08-12 20:29:30.340765 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa2186d990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa21861f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee59710>]}
2020-08-12 20:29:30.375188 (MainThread): Partial parsing not enabled
2020-08-12 20:29:30.380743 (MainThread): Parsing macros/core.sql
2020-08-12 20:29:30.387388 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:29:30.397912 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:29:30.400340 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:29:30.424073 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:29:30.467669 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:29:30.499059 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:29:30.501900 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:29:30.512350 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:29:30.531649 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:29:30.540626 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:29:30.550646 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:29:30.557260 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:29:30.558471 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:29:30.559882 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:29:30.562603 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:29:30.574705 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:29:30.578019 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:29:30.580851 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:29:30.650151 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:29:30.651723 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:29:30.653095 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:29:30.654504 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:29:30.657200 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:29:30.660362 (MainThread): Parsing macros/relations.sql
2020-08-12 20:29:30.662666 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:29:30.691445 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:29:30.716329 (MainThread): Partial parsing not enabled
2020-08-12 20:29:30.757623 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:29:30.757802 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:30.797127 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:29:30.797331 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:30.808683 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:29:30.808871 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:30.822700 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:29:30.822876 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:30.833884 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:29:30.834035 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:30.847031 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:29:30.847218 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:30.861736 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:29:30.861941 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:30.876166 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:29:30.876352 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:30.894398 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:29:30.894667 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:30.913038 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:29:30.913340 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:31.241299 (MainThread): Found 10 models, 5 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 20:29:31.243011 (MainThread): 
2020-08-12 20:29:31.243621 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:29:31.243875 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:29:31.273718 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 20:29:31.274032 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-12 20:29:31.297475 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:29:31.297779 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 20:29:31.308725 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:31.308960 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:29:31.309125 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 20:29:31.314199 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2020-08-12 20:29:31.326342 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 20:29:31.326737 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 20:29:31.354089 (MainThread): Using postgres connection "master".
2020-08-12 20:29:31.354278 (MainThread): On master: BEGIN
2020-08-12 20:29:31.362200 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:31.362397 (MainThread): Using postgres connection "master".
2020-08-12 20:29:31.362510 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 20:29:31.787117 (MainThread): SQL status: SELECT 55 in 0.42 seconds
2020-08-12 20:29:31.856060 (MainThread): On master: ROLLBACK
2020-08-12 20:29:31.856442 (MainThread): On master: Close
2020-08-12 20:29:31.856830 (MainThread): 16:29:31 | Concurrency: 1 threads (target='dev')
2020-08-12 20:29:31.857004 (MainThread): 16:29:31 | 
2020-08-12 20:29:31.858890 (Thread-1): Began running node test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German
2020-08-12 20:29:31.859157 (Thread-1): 16:29:31 | 1 of 5 START test accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German [RUN]
2020-08-12 20:29:31.859599 (Thread-1): Acquiring new postgres connection "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German".
2020-08-12 20:29:31.859766 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:31.859899 (Thread-1): Compiling test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German
2020-08-12 20:29:31.892217 (Thread-1): Writing injected SQL for node "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German"
2020-08-12 20:29:31.893258 (Thread-1): finished collecting timing info
2020-08-12 20:29:31.894080 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German".
2020-08-12 20:29:31.894352 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: BEGIN
2020-08-12 20:29:31.907544 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:31.907804 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German".
2020-08-12 20:29:31.907949 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German"} */





with all_values as (

    select distinct
        language as value_field

    from "dvd_rental"."dev"."customer_profile"

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'English','Italian','Japanese','Mandarin','French','German'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-12 20:29:31.911882 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 20:29:31.913373 (Thread-1): finished collecting timing info
2020-08-12 20:29:31.914021 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: ROLLBACK
2020-08-12 20:29:31.914539 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: Close
2020-08-12 20:29:31.915282 (Thread-1): 16:29:31 | 1 of 5 PASS accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German [PASS in 0.06s]
2020-08-12 20:29:31.915560 (Thread-1): Finished running node test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German
2020-08-12 20:29:31.915871 (Thread-1): Began running node test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z
2020-08-12 20:29:31.916196 (Thread-1): 16:29:31 | 2 of 5 START test accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z [RUN]
2020-08-12 20:29:31.916859 (Thread-1): Acquiring new postgres connection "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z".
2020-08-12 20:29:31.917124 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:31.917270 (Thread-1): Compiling test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z
2020-08-12 20:29:31.941836 (Thread-1): Writing injected SQL for node "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z"
2020-08-12 20:29:31.942917 (Thread-1): finished collecting timing info
2020-08-12 20:29:31.943582 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z".
2020-08-12 20:29:31.943928 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: BEGIN
2020-08-12 20:29:31.955222 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:31.955421 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z".
2020-08-12 20:29:31.955528 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z"} */





with all_values as (

    select distinct
        last_initial as value_field

    from "dvd_rental"."dev"."customer_profile"

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-12 20:29:31.956422 (Thread-1): Postgres error: column "last_initial" does not exist
LINE 10:         last_initial as value_field
                 ^

2020-08-12 20:29:31.956637 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: ROLLBACK
2020-08-12 20:29:31.956985 (Thread-1): finished collecting timing info
2020-08-12 20:29:31.957331 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: Close
2020-08-12 20:29:31.957806 (Thread-1): Database Error in test accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z (models/schema.yml)
  column "last_initial" does not exist
  LINE 10:         last_initial as value_field
                   ^
  compiled SQL at target/compiled/dbt_play/models/schema.yml/schema_test/accepted_values_customer_profile_8e3627ed04f8bcacd0fa7e5231e981ea.sql
Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 46, in exception_handler
    yield
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 77, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column "last_initial" does not exist
LINE 10:         last_initial as value_field
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 607, in execute
    failed_rows = self.execute_schema_test(test)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/node_runners.py", line 587, in execute_schema_test
    fetch=True,
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/base/impl.py", line 228, in execute
    fetch=fetch
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 122, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/sql/connections.py", line 85, in add_query
    return connection, cursor
  File "/Users/sean/opt/anaconda3/lib/python3.7/contextlib.py", line 130, in __exit__
    self.gen.throw(type, value, traceback)
  File "/Users/sean/opt/anaconda3/lib/python3.7/site-packages/dbt/adapters/postgres/connections.py", line 57, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in test accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z (models/schema.yml)
  column "last_initial" does not exist
  LINE 10:         last_initial as value_field
                   ^
  compiled SQL at target/compiled/dbt_play/models/schema.yml/schema_test/accepted_values_customer_profile_8e3627ed04f8bcacd0fa7e5231e981ea.sql
2020-08-12 20:29:31.959966 (Thread-1): 16:29:31 | 2 of 5 ERROR accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z [ERROR in 0.04s]
2020-08-12 20:29:31.960304 (Thread-1): Finished running node test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z
2020-08-12 20:29:31.961086 (Thread-1): Began running node test.dbt_play.not_null_customer_profile_active
2020-08-12 20:29:31.961637 (Thread-1): 16:29:31 | 3 of 5 START test not_null_customer_profile_active................... [RUN]
2020-08-12 20:29:31.962424 (Thread-1): Acquiring new postgres connection "test.dbt_play.not_null_customer_profile_active".
2020-08-12 20:29:31.962632 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:31.962767 (Thread-1): Compiling test.dbt_play.not_null_customer_profile_active
2020-08-12 20:29:31.973927 (Thread-1): Writing injected SQL for node "test.dbt_play.not_null_customer_profile_active"
2020-08-12 20:29:31.974658 (Thread-1): finished collecting timing info
2020-08-12 20:29:31.975031 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_active".
2020-08-12 20:29:31.975140 (Thread-1): On test.dbt_play.not_null_customer_profile_active: BEGIN
2020-08-12 20:29:31.985198 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:31.985515 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_active".
2020-08-12 20:29:31.985719 (Thread-1): On test.dbt_play.not_null_customer_profile_active: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.not_null_customer_profile_active"} */




select count(*) as validation_errors
from "dvd_rental"."dev"."customer_profile"
where active is null


2020-08-12 20:29:31.988030 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 20:29:31.988633 (Thread-1): finished collecting timing info
2020-08-12 20:29:31.989102 (Thread-1): On test.dbt_play.not_null_customer_profile_active: ROLLBACK
2020-08-12 20:29:31.989519 (Thread-1): On test.dbt_play.not_null_customer_profile_active: Close
2020-08-12 20:29:31.990429 (Thread-1): 16:29:31 | 3 of 5 PASS not_null_customer_profile_active......................... [PASS in 0.03s]
2020-08-12 20:29:31.991012 (Thread-1): Finished running node test.dbt_play.not_null_customer_profile_active
2020-08-12 20:29:31.991442 (Thread-1): Began running node test.dbt_play.not_null_customer_profile_customer_id
2020-08-12 20:29:31.991688 (Thread-1): 16:29:31 | 4 of 5 START test not_null_customer_profile_customer_id.............. [RUN]
2020-08-12 20:29:31.992113 (Thread-1): Acquiring new postgres connection "test.dbt_play.not_null_customer_profile_customer_id".
2020-08-12 20:29:31.992272 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:31.992467 (Thread-1): Compiling test.dbt_play.not_null_customer_profile_customer_id
2020-08-12 20:29:32.014272 (Thread-1): Writing injected SQL for node "test.dbt_play.not_null_customer_profile_customer_id"
2020-08-12 20:29:32.015922 (Thread-1): finished collecting timing info
2020-08-12 20:29:32.016902 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_customer_id".
2020-08-12 20:29:32.017185 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: BEGIN
2020-08-12 20:29:32.025235 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:32.025425 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_customer_id".
2020-08-12 20:29:32.025529 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.not_null_customer_profile_customer_id"} */




select count(*) as validation_errors
from "dvd_rental"."dev"."customer_profile"
where customer_id is null


2020-08-12 20:29:32.027275 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 20:29:32.027659 (Thread-1): finished collecting timing info
2020-08-12 20:29:32.028031 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: ROLLBACK
2020-08-12 20:29:32.029998 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: Close
2020-08-12 20:29:32.030759 (Thread-1): 16:29:32 | 4 of 5 PASS not_null_customer_profile_customer_id.................... [PASS in 0.04s]
2020-08-12 20:29:32.031175 (Thread-1): Finished running node test.dbt_play.not_null_customer_profile_customer_id
2020-08-12 20:29:32.031486 (Thread-1): Began running node test.dbt_play.unique_customer_profile_customer_id
2020-08-12 20:29:32.031863 (Thread-1): 16:29:32 | 5 of 5 START test unique_customer_profile_customer_id................ [RUN]
2020-08-12 20:29:32.032571 (Thread-1): Acquiring new postgres connection "test.dbt_play.unique_customer_profile_customer_id".
2020-08-12 20:29:32.032874 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:29:32.033093 (Thread-1): Compiling test.dbt_play.unique_customer_profile_customer_id
2020-08-12 20:29:32.050315 (Thread-1): Writing injected SQL for node "test.dbt_play.unique_customer_profile_customer_id"
2020-08-12 20:29:32.051206 (Thread-1): finished collecting timing info
2020-08-12 20:29:32.051976 (Thread-1): Using postgres connection "test.dbt_play.unique_customer_profile_customer_id".
2020-08-12 20:29:32.052209 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: BEGIN
2020-08-12 20:29:32.064505 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:29:32.065322 (Thread-1): Using postgres connection "test.dbt_play.unique_customer_profile_customer_id".
2020-08-12 20:29:32.065758 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.unique_customer_profile_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from "dvd_rental"."dev"."customer_profile"
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-08-12 20:29:32.070570 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 20:29:32.071017 (Thread-1): finished collecting timing info
2020-08-12 20:29:32.071372 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: ROLLBACK
2020-08-12 20:29:32.071707 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: Close
2020-08-12 20:29:32.072196 (Thread-1): 16:29:32 | 5 of 5 PASS unique_customer_profile_customer_id...................... [PASS in 0.04s]
2020-08-12 20:29:32.072427 (Thread-1): Finished running node test.dbt_play.unique_customer_profile_customer_id
2020-08-12 20:29:32.167446 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:29:32.167742 (MainThread): Opening a new connection, currently in state closed
2020-08-12 20:29:32.168226 (MainThread): 16:29:32 | 
2020-08-12 20:29:32.168476 (MainThread): 16:29:32 | Finished running 5 tests in 0.92s.
2020-08-12 20:29:32.168694 (MainThread): Connection 'master' was properly closed.
2020-08-12 20:29:32.169066 (MainThread): Connection 'test.dbt_play.unique_customer_profile_customer_id' was properly closed.
2020-08-12 20:29:32.190807 (MainThread): 
2020-08-12 20:29:32.191062 (MainThread): Completed with 1 error and 0 warnings:
2020-08-12 20:29:32.191210 (MainThread): 
2020-08-12 20:29:32.191375 (MainThread): Database Error in test accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z (models/schema.yml)
2020-08-12 20:29:32.191527 (MainThread):   column "last_initial" does not exist
2020-08-12 20:29:32.191663 (MainThread):   LINE 10:         last_initial as value_field
2020-08-12 20:29:32.191795 (MainThread):                    ^
2020-08-12 20:29:32.191935 (MainThread):   compiled SQL at target/compiled/dbt_play/models/schema.yml/schema_test/accepted_values_customer_profile_8e3627ed04f8bcacd0fa7e5231e981ea.sql
2020-08-12 20:29:32.192096 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2020-08-12 20:29:32.192356 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa21e35cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa2208b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa2208b990>]}
2020-08-12 20:29:32.192579 (MainThread): Flushing usage events
2020-08-12 20:30:35.427865 (MainThread): Running with dbt=0.17.2
2020-08-12 20:30:35.518296 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 20:30:35.519681 (MainThread): Tracking: tracking
2020-08-12 20:30:35.543297 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1c85a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cd5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1cc48550>]}
2020-08-12 20:30:35.582681 (MainThread): Partial parsing not enabled
2020-08-12 20:30:35.586397 (MainThread): Parsing macros/core.sql
2020-08-12 20:30:35.597610 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:30:35.613580 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:30:35.616116 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:30:35.645986 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:30:35.688238 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:30:35.716935 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:30:35.719654 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:30:35.727931 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:30:35.748545 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:30:35.757776 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:30:35.766778 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:30:35.773863 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:30:35.775630 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:30:35.778071 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:30:35.780907 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:30:35.792944 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:30:35.795681 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:30:35.797767 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:30:35.866240 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:30:35.867741 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:30:35.868978 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:30:35.870310 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:30:35.873553 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:30:35.877916 (MainThread): Parsing macros/relations.sql
2020-08-12 20:30:35.880606 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:30:35.908934 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:30:35.933070 (MainThread): Partial parsing not enabled
2020-08-12 20:30:35.975801 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:35.975981 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.018413 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:30:36.018590 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.029900 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:36.030082 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.045368 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:36.045607 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.058444 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:36.058637 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.071348 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:36.071631 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.087688 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:36.087874 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.100957 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:36.101183 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.115928 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:36.116158 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.130051 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:36.130216 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.463248 (MainThread): Found 10 models, 5 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 20:30:36.465692 (MainThread): 
2020-08-12 20:30:36.466186 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:30:36.466314 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:36.489297 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 20:30:36.489550 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 20:30:36.506204 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 20:30:36.506468 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 20:30:36.526220 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.02 seconds
2020-08-12 20:30:36.529335 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 20:30:36.556188 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 20:30:36.556408 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 20:30:36.563734 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:30:36.563909 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 20:30:36.572134 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:36.572342 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:30:36.572461 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 20:30:36.577311 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2020-08-12 20:30:36.588373 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 20:30:36.588759 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 20:30:36.615311 (MainThread): Using postgres connection "master".
2020-08-12 20:30:36.615645 (MainThread): On master: BEGIN
2020-08-12 20:30:36.623840 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:36.624022 (MainThread): Using postgres connection "master".
2020-08-12 20:30:36.624122 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 20:30:37.078500 (MainThread): SQL status: SELECT 55 in 0.45 seconds
2020-08-12 20:30:37.146234 (MainThread): On master: ROLLBACK
2020-08-12 20:30:37.146752 (MainThread): Using postgres connection "master".
2020-08-12 20:30:37.146883 (MainThread): On master: BEGIN
2020-08-12 20:30:37.147364 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:37.147552 (MainThread): On master: COMMIT
2020-08-12 20:30:37.147687 (MainThread): Using postgres connection "master".
2020-08-12 20:30:37.147794 (MainThread): On master: COMMIT
2020-08-12 20:30:37.148064 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:30:37.148217 (MainThread): On master: Close
2020-08-12 20:30:37.148609 (MainThread): 16:30:37 | Concurrency: 1 threads (target='dev')
2020-08-12 20:30:37.148796 (MainThread): 16:30:37 | 
2020-08-12 20:30:37.151078 (Thread-1): Began running node model.dbt_play.rental_payment
2020-08-12 20:30:37.152580 (Thread-1): 16:30:37 | 1 of 10 START view model dev.rental_payment.......................... [RUN]
2020-08-12 20:30:37.153023 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:37.153159 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:37.153293 (Thread-1): Compiling model.dbt_play.rental_payment
2020-08-12 20:30:37.175443 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_payment"
2020-08-12 20:30:37.175959 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.213353 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:37.213563 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_tmp" cascade
2020-08-12 20:30:37.221750 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:30:37.224618 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:37.224752 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 20:30:37.225110 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.230142 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_payment"
2020-08-12 20:30:37.230728 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:37.230904 (Thread-1): On model.dbt_play.rental_payment: BEGIN
2020-08-12 20:30:37.231283 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:37.231416 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:37.231523 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */

  create view "dvd_rental"."dev"."rental_payment__dbt_tmp" as (
    with rental_payment as(
    SELECT 
        rental_id, 
        sum(amount) as amount 
    FROM dvd_rental.public.payment 
    GROUP BY rental_id
)

SELECT * FROM rental_payment
  );

2020-08-12 20:30:37.234581 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:30:37.244135 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:37.244591 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment" rename to "rental_payment__dbt_backup"
2020-08-12 20:30:37.245408 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.248355 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:37.248547 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment__dbt_tmp" rename to "rental_payment"
2020-08-12 20:30:37.249260 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.257149 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 20:30:37.257379 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:37.257542 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 20:30:37.258743 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:30:37.263441 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:37.263648 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 20:30:37.267577 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.270238 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.270526 (Thread-1): On model.dbt_play.rental_payment: Close
2020-08-12 20:30:37.271489 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1cfffa10>]}
2020-08-12 20:30:37.273060 (Thread-1): 16:30:37 | 1 of 10 OK created view model dev.rental_payment..................... [CREATE VIEW in 0.12s]
2020-08-12 20:30:37.273534 (Thread-1): Finished running node model.dbt_play.rental_payment
2020-08-12 20:30:37.273855 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 20:30:37.275428 (Thread-1): 16:30:37 | 2 of 10 START view model dev.customer................................ [RUN]
2020-08-12 20:30:37.276018 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:30:37.276155 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:37.276270 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 20:30:37.284474 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 20:30:37.285095 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.302240 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:30:37.302445 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 20:30:37.314517 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:30:37.318615 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:30:37.318982 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 20:30:37.319664 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.322467 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 20:30:37.323359 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:30:37.323628 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 20:30:37.324105 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:37.324352 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:30:37.324586 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 20:30:37.332053 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:30:37.337098 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:30:37.337312 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 20:30:37.338906 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.343218 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:30:37.343414 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 20:30:37.344316 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.346052 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 20:30:37.346249 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:30:37.346359 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 20:30:37.351817 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:30:37.354277 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 20:30:37.354479 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 20:30:37.356198 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.358967 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.359393 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 20:30:37.360445 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d0a81d0>]}
2020-08-12 20:30:37.363064 (Thread-1): 16:30:37 | 2 of 10 OK created view model dev.customer........................... [CREATE VIEW in 0.08s]
2020-08-12 20:30:37.363303 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 20:30:37.363539 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 20:30:37.364911 (Thread-1): 16:30:37 | 3 of 10 START view model dev.customer_life_time_value................ [RUN]
2020-08-12 20:30:37.365486 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:37.365683 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:37.365848 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 20:30:37.383393 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 20:30:37.384527 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.400344 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:37.400615 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 20:30:37.414134 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:30:37.423721 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:37.423970 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 20:30:37.424412 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.426466 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 20:30:37.427815 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:37.428392 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 20:30:37.429214 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:37.429550 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:37.429934 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 20:30:37.433263 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:30:37.437953 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:37.497390 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 20:30:37.498227 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.500868 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:37.501042 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 20:30:37.501647 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.503231 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 20:30:37.503445 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:37.503561 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 20:30:37.504404 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:30:37.507722 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:37.508171 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 20:30:37.510565 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.514130 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.514449 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 20:30:37.515277 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d12fc90>]}
2020-08-12 20:30:37.516574 (Thread-1): 16:30:37 | 3 of 10 OK created view model dev.customer_life_time_value........... [CREATE VIEW in 0.15s]
2020-08-12 20:30:37.516797 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 20:30:37.517026 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 20:30:37.518786 (Thread-1): 16:30:37 | 4 of 10 START view model dev.customer_rental_summary................. [RUN]
2020-08-12 20:30:37.519330 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:37.519543 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:37.519721 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 20:30:37.530465 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 20:30:37.531401 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.540973 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:37.541240 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 20:30:37.557253 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 20:30:37.567966 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:37.568553 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 20:30:37.569493 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.572476 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 20:30:37.573328 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:37.573577 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 20:30:37.574422 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:37.574774 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:37.575045 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 20:30:37.582192 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:30:37.587944 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:37.588447 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 20:30:37.589809 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.595776 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:37.596037 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 20:30:37.596852 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.598929 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 20:30:37.599175 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:37.599332 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 20:30:37.600102 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:30:37.603251 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:37.603520 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 20:30:37.606411 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.610012 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.610912 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 20:30:37.613244 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d132bd0>]}
2020-08-12 20:30:37.615854 (Thread-1): 16:30:37 | 4 of 10 OK created view model dev.customer_rental_summary............ [CREATE VIEW in 0.09s]
2020-08-12 20:30:37.616211 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 20:30:37.616528 (Thread-1): Began running node model.dbt_play.rental_details
2020-08-12 20:30:37.618814 (Thread-1): 16:30:37 | 5 of 10 START view model dev.rental_details.......................... [RUN]
2020-08-12 20:30:37.619399 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:37.619562 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:37.619706 (Thread-1): Compiling model.dbt_play.rental_details
2020-08-12 20:30:37.628620 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_details"
2020-08-12 20:30:37.629353 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.653906 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:37.654213 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_tmp" cascade
2020-08-12 20:30:37.666795 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:30:37.670336 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:37.670540 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 20:30:37.671520 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.674450 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_details"
2020-08-12 20:30:37.675420 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:37.675644 (Thread-1): On model.dbt_play.rental_details: BEGIN
2020-08-12 20:30:37.676053 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:37.676249 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:37.676490 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */

  create view "dvd_rental"."dev"."rental_details__dbt_tmp" as (
    with rental_payment as (
    SELECT * FROM "dvd_rental"."dev"."rental_payment"
),
rental_details as(
    SELECT
        r.rental_id,
        r.customer_id,
        r.rental_date,
        CASE WHEN r.return_date is null THEN FALSE ELSE TRUE END as returned,
        CASE WHEN date_part('day', return_date - rental_date) > f.rental_duration THEN TRUE ELSE FALSE END as late,
        CASE WHEN rental_payment.amount is null THEN FALSE WHEN rental_payment.amount <= 0 THEN FALSE ELSE TRUE END as paid,
        f.title as film_title,
        f.rating as film_rating,
        l.name as film_language,
        c.name as film_category,
        CASE WHEN rental_payment.amount is null THEN 0 ELSE rental_payment.amount END as payment_amount
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film f ON i.film_id = f.film_id
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    INNER JOIN dvd_rental.public.film_category fc ON f.film_id = fc.film_id
    INNER JOIN dvd_rental.public.category c ON fc.category_id = c.category_id
    LEFT JOIN rental_payment ON r.rental_id = rental_payment.rental_id
)

SELECT * FROM rental_details
  );

2020-08-12 20:30:37.687513 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:30:37.692183 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:37.692500 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
alter table "dvd_rental"."dev"."rental_details__dbt_tmp" rename to "rental_details"
2020-08-12 20:30:37.694007 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.697155 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 20:30:37.697424 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:37.697620 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 20:30:37.704815 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:30:37.708122 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:37.708347 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 20:30:37.708686 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.712441 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.712802 (Thread-1): On model.dbt_play.rental_details: Close
2020-08-12 20:30:37.713916 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1cfbec50>]}
2020-08-12 20:30:37.716216 (Thread-1): 16:30:37 | 5 of 10 OK created view model dev.rental_details..................... [CREATE VIEW in 0.09s]
2020-08-12 20:30:37.716428 (Thread-1): Finished running node model.dbt_play.rental_details
2020-08-12 20:30:37.716956 (Thread-1): Began running node model.dbt_play.customer_behaviour
2020-08-12 20:30:37.718749 (Thread-1): 16:30:37 | 6 of 10 START view model dev.customer_behaviour...................... [RUN]
2020-08-12 20:30:37.719415 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:37.719615 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:37.719789 (Thread-1): Compiling model.dbt_play.customer_behaviour
2020-08-12 20:30:37.729619 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 20:30:37.730366 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.738886 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:37.739177 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_tmp" cascade
2020-08-12 20:30:37.755166 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 20:30:37.763804 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:37.764136 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 20:30:37.764503 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.766104 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 20:30:37.766668 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:37.766796 (Thread-1): On model.dbt_play.customer_behaviour: BEGIN
2020-08-12 20:30:37.767316 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:37.767591 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:37.767809 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */

  create view "dvd_rental"."dev"."customer_behaviour__dbt_tmp" as (
    with rental_details as (
    SELECT 
        customer_id,
        returned,
        late, 
        paid
    FROM "dvd_rental"."dev"."rental_details"
),
customer_behaviour as(
    SELECT 
        customer_id, 
        sum(cast(returned as int)) as num_return, 
        sum(cast(late as int)) as num_late, 
        sum(cast(paid as int)) as num_paid 
    FROM rental_details 
    GROUP BY customer_id
)

SELECT * FROM customer_behaviour
  );

2020-08-12 20:30:37.772260 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 20:30:37.775405 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:37.775584 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
alter table "dvd_rental"."dev"."customer_behaviour__dbt_tmp" rename to "customer_behaviour"
2020-08-12 20:30:37.776372 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.780595 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 20:30:37.780901 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:37.781085 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 20:30:37.787427 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:30:37.791546 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:37.791784 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 20:30:37.792227 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.796550 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.797019 (Thread-1): On model.dbt_play.customer_behaviour: Close
2020-08-12 20:30:37.797966 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1ce27190>]}
2020-08-12 20:30:37.799987 (Thread-1): 16:30:37 | 6 of 10 OK created view model dev.customer_behaviour................. [CREATE VIEW in 0.08s]
2020-08-12 20:30:37.800314 (Thread-1): Finished running node model.dbt_play.customer_behaviour
2020-08-12 20:30:37.800652 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 20:30:37.803121 (Thread-1): 16:30:37 | 7 of 10 START view model dev.customer_language_preference............ [RUN]
2020-08-12 20:30:37.803834 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:37.804018 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:37.804182 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 20:30:37.819739 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 20:30:37.820476 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.830266 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:37.830499 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 20:30:37.842748 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:30:37.850184 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:37.850481 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 20:30:37.851654 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.854418 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 20:30:37.855147 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:37.855317 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 20:30:37.855685 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:37.855818 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:37.855918 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_language_preference as (
    SELECT DISTINCT ON (customer_id)
        customer_id,
        film_language as language
    FROM rental_details
    GROUP BY customer_id, film_language
    ORDER BY customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 20:30:37.864631 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:30:37.867651 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:37.867850 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 20:30:37.868833 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.871087 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 20:30:37.871319 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:37.871429 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 20:30:37.872626 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:30:37.874746 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:37.874915 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 20:30:37.875261 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.879176 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.879761 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 20:30:37.880465 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d108f50>]}
2020-08-12 20:30:37.882153 (Thread-1): 16:30:37 | 7 of 10 OK created view model dev.customer_language_preference....... [CREATE VIEW in 0.08s]
2020-08-12 20:30:37.882357 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 20:30:37.882579 (Thread-1): Began running node model.dbt_play.customer_category_preference
2020-08-12 20:30:37.884011 (Thread-1): 16:30:37 | 8 of 10 START view model dev.customer_category_preference............ [RUN]
2020-08-12 20:30:37.884733 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:37.884935 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:37.885096 (Thread-1): Compiling model.dbt_play.customer_category_preference
2020-08-12 20:30:37.901191 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_category_preference"
2020-08-12 20:30:37.901938 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.913551 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:37.913762 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_tmp" cascade
2020-08-12 20:30:37.925035 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:30:37.931006 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:37.931328 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_backup" cascade
2020-08-12 20:30:37.932260 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.934375 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_category_preference"
2020-08-12 20:30:37.934997 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:37.935152 (Thread-1): On model.dbt_play.customer_category_preference: BEGIN
2020-08-12 20:30:37.935512 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:37.935635 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:37.935732 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */

  create view "dvd_rental"."dev"."customer_category_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_category_preference as (
    SELECT 
        customer_id, 
        film_category, 
        count(*) as number, 
        sum(payment_amount) as dollars 
    FROM rental_details 
    GROUP BY customer_id, film_category
    ORDER BY customer_id ASC, count(*) DESC
)

SELECT * FROM customer_category_preference
  );

2020-08-12 20:30:37.941579 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:30:37.947754 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:37.948041 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
alter table "dvd_rental"."dev"."customer_category_preference__dbt_tmp" rename to "customer_category_preference"
2020-08-12 20:30:37.949299 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:37.952291 (Thread-1): On model.dbt_play.customer_category_preference: COMMIT
2020-08-12 20:30:37.952599 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:37.952835 (Thread-1): On model.dbt_play.customer_category_preference: COMMIT
2020-08-12 20:30:37.959562 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:30:37.962113 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:37.962459 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_backup" cascade
2020-08-12 20:30:37.962905 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:37.966081 (Thread-1): finished collecting timing info
2020-08-12 20:30:37.966411 (Thread-1): On model.dbt_play.customer_category_preference: Close
2020-08-12 20:30:37.967308 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1ce2ef50>]}
2020-08-12 20:30:37.968819 (Thread-1): 16:30:37 | 8 of 10 OK created view model dev.customer_category_preference....... [CREATE VIEW in 0.08s]
2020-08-12 20:30:37.969052 (Thread-1): Finished running node model.dbt_play.customer_category_preference
2020-08-12 20:30:37.969242 (Thread-1): Began running node model.dbt_play.customer_rating_preferences
2020-08-12 20:30:37.970523 (Thread-1): 16:30:37 | 9 of 10 START view model dev.customer_rating_preferences............. [RUN]
2020-08-12 20:30:37.971146 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:37.971354 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:37.971532 (Thread-1): Compiling model.dbt_play.customer_rating_preferences
2020-08-12 20:30:37.986163 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rating_preferences"
2020-08-12 20:30:37.987732 (Thread-1): finished collecting timing info
2020-08-12 20:30:38.002876 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:38.003192 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" cascade
2020-08-12 20:30:38.017104 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 20:30:38.021632 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:38.021834 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_backup" cascade
2020-08-12 20:30:38.022185 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:38.023822 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rating_preferences"
2020-08-12 20:30:38.024428 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:38.024637 (Thread-1): On model.dbt_play.customer_rating_preferences: BEGIN
2020-08-12 20:30:38.025093 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:38.025231 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:38.025383 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */

  create view "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_rating_preference as (
    SELECT 
        customer_id, 
        film_rating, 
        count(*) as number, 
        sum(payment_amount) as dollars 
    FROM rental_details 
    GROUP BY customer_id, film_rating
    ORDER BY customer_id ASC, count(*) DESC
)

SELECT * FROM customer_rating_preference
  );

2020-08-12 20:30:38.030718 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 20:30:38.034937 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:38.035401 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
alter table "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" rename to "customer_rating_preferences"
2020-08-12 20:30:38.036140 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:38.037482 (Thread-1): On model.dbt_play.customer_rating_preferences: COMMIT
2020-08-12 20:30:38.037659 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:38.037757 (Thread-1): On model.dbt_play.customer_rating_preferences: COMMIT
2020-08-12 20:30:38.046781 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:30:38.048782 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:38.048914 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_backup" cascade
2020-08-12 20:30:38.049279 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 20:30:38.052136 (Thread-1): finished collecting timing info
2020-08-12 20:30:38.052665 (Thread-1): On model.dbt_play.customer_rating_preferences: Close
2020-08-12 20:30:38.053634 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1cfd6150>]}
2020-08-12 20:30:38.055844 (Thread-1): 16:30:38 | 9 of 10 OK created view model dev.customer_rating_preferences........ [CREATE VIEW in 0.08s]
2020-08-12 20:30:38.056105 (Thread-1): Finished running node model.dbt_play.customer_rating_preferences
2020-08-12 20:30:38.056395 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 20:30:38.058127 (Thread-1): 16:30:38 | 10 of 10 START table model dev.customer_profile...................... [RUN]
2020-08-12 20:30:38.058665 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:38.058838 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:38.059024 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 20:30:38.099888 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 20:30:38.100937 (Thread-1): finished collecting timing info
2020-08-12 20:30:38.127004 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:38.127214 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 20:30:38.135150 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 20:30:38.138643 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:38.138950 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 20:30:38.139385 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 20:30:38.148928 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 20:30:38.149510 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:38.149629 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 20:30:38.149946 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 20:30:38.150065 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:38.150161 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
lang as (
    SELECT * FROM "dvd_rental"."dev"."customer_language_preference"
),
behave as (
    SELECT *FROM "dvd_rental"."dev"."customer_behaviour"
),
customer_profile as (
    SELECT 
        customer.customer_id,
        customer.active,
        left(customer.last_name, 1) as last_initial,
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.period_days,
        ltv.life_time_value,
        rental.num_rental,
        behave.num_return,
        behave.num_late,
        behave.num_paid,
        lang.language
    FROM customer
    LEFT JOIN rental USING(customer_id)
    LEFT JOIN ltv USING(customer_id)
    LEFT JOIN lang USING(customer_id)
    LEFT JOIN behave USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 20:30:38.326868 (Thread-1): SQL status: SELECT 599 in 0.18 seconds
2020-08-12 20:30:38.331039 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:38.331234 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile" rename to "customer_profile__dbt_backup"
2020-08-12 20:30:38.331873 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 20:30:38.334721 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:38.334895 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 20:30:38.344444 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2020-08-12 20:30:38.346653 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 20:30:38.346898 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:38.347036 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 20:30:38.355914 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 20:30:38.358169 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:38.358325 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 20:30:38.366790 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 20:30:38.370137 (Thread-1): finished collecting timing info
2020-08-12 20:30:38.370491 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 20:30:38.371622 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0ac1972-93b8-405a-b974-ff00b7b3946a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1ce90a50>]}
2020-08-12 20:30:38.373547 (Thread-1): 16:30:38 | 10 of 10 OK created table model dev.customer_profile................. [SELECT 599 in 0.31s]
2020-08-12 20:30:38.373951 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 20:30:38.436747 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:30:38.437034 (MainThread): Opening a new connection, currently in state closed
2020-08-12 20:30:38.437285 (MainThread): Using postgres connection "master".
2020-08-12 20:30:38.437456 (MainThread): On master: BEGIN
2020-08-12 20:30:38.449454 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:38.449660 (MainThread): On master: COMMIT
2020-08-12 20:30:38.449811 (MainThread): Using postgres connection "master".
2020-08-12 20:30:38.449929 (MainThread): On master: COMMIT
2020-08-12 20:30:38.450191 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 20:30:38.450347 (MainThread): On master: Close
2020-08-12 20:30:38.450766 (MainThread): 16:30:38 | 
2020-08-12 20:30:38.450954 (MainThread): 16:30:38 | Finished running 9 view models, 1 table model in 1.98s.
2020-08-12 20:30:38.451145 (MainThread): Connection 'master' was properly closed.
2020-08-12 20:30:38.451329 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 20:30:38.490493 (MainThread): 
2020-08-12 20:30:38.490807 (MainThread): Completed successfully
2020-08-12 20:30:38.491017 (MainThread): 
Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
2020-08-12 20:30:38.491354 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1ccf9c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1d0a8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1cf89050>]}
2020-08-12 20:30:38.491739 (MainThread): Flushing usage events
2020-08-12 20:30:43.676159 (MainThread): Running with dbt=0.17.2
2020-08-12 20:30:43.800347 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-12 20:30:43.802351 (MainThread): Tracking: tracking
2020-08-12 20:30:43.826206 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa13eabbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x812a63b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101496750>]}
2020-08-12 20:30:43.873057 (MainThread): Partial parsing not enabled
2020-08-12 20:30:43.877380 (MainThread): Parsing macros/core.sql
2020-08-12 20:30:43.890003 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 20:30:43.907364 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 20:30:43.911357 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 20:30:43.948829 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 20:30:44.005775 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 20:30:44.048240 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 20:30:44.051828 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 20:30:44.066748 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 20:30:44.095085 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 20:30:44.109351 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 20:30:44.121183 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 20:30:44.131497 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 20:30:44.134266 (MainThread): Parsing macros/etc/query.sql
2020-08-12 20:30:44.136405 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 20:30:44.140015 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 20:30:44.158028 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 20:30:44.162904 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 20:30:44.167815 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 20:30:44.285614 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 20:30:44.288509 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 20:30:44.290656 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 20:30:44.294172 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 20:30:44.301820 (MainThread): Parsing macros/catalog.sql
2020-08-12 20:30:44.308943 (MainThread): Parsing macros/relations.sql
2020-08-12 20:30:44.311546 (MainThread): Parsing macros/adapters.sql
2020-08-12 20:30:44.376244 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 20:30:44.408046 (MainThread): Partial parsing not enabled
2020-08-12 20:30:44.461814 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 20:30:44.462028 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:44.525717 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 20:30:44.526021 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:44.543819 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 20:30:44.544017 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:44.563260 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 20:30:44.563462 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:44.582033 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 20:30:44.582243 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:44.600227 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 20:30:44.600548 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:44.620019 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 20:30:44.620233 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:44.642193 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 20:30:44.642405 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:44.662437 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 20:30:44.662730 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:44.684211 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 20:30:44.684410 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:45.137573 (MainThread): Found 10 models, 5 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 20:30:45.139874 (MainThread): 
2020-08-12 20:30:45.140403 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:30:45.140617 (MainThread): Opening a new connection, currently in state init
2020-08-12 20:30:45.174434 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 20:30:45.175019 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-12 20:30:45.199910 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:30:45.200255 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 20:30:45.212280 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:45.212523 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 20:30:45.212670 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 20:30:45.219211 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.01 seconds
2020-08-12 20:30:45.238414 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 20:30:45.238936 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 20:30:45.278430 (MainThread): Using postgres connection "master".
2020-08-12 20:30:45.278632 (MainThread): On master: BEGIN
2020-08-12 20:30:45.287829 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:45.288050 (MainThread): Using postgres connection "master".
2020-08-12 20:30:45.288204 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 20:30:45.807354 (MainThread): SQL status: SELECT 55 in 0.52 seconds
2020-08-12 20:30:45.910051 (MainThread): On master: ROLLBACK
2020-08-12 20:30:45.910494 (MainThread): On master: Close
2020-08-12 20:30:45.911117 (MainThread): 16:30:45 | Concurrency: 1 threads (target='dev')
2020-08-12 20:30:45.911368 (MainThread): 16:30:45 | 
2020-08-12 20:30:45.913501 (Thread-1): Began running node test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German
2020-08-12 20:30:45.913821 (Thread-1): 16:30:45 | 1 of 5 START test accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German [RUN]
2020-08-12 20:30:45.914381 (Thread-1): Acquiring new postgres connection "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German".
2020-08-12 20:30:45.914650 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:45.914892 (Thread-1): Compiling test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German
2020-08-12 20:30:45.964004 (Thread-1): Writing injected SQL for node "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German"
2020-08-12 20:30:45.964636 (Thread-1): finished collecting timing info
2020-08-12 20:30:45.965399 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German".
2020-08-12 20:30:45.965593 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: BEGIN
2020-08-12 20:30:45.974866 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:45.975079 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German".
2020-08-12 20:30:45.975185 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German"} */





with all_values as (

    select distinct
        language as value_field

    from "dvd_rental"."dev"."customer_profile"

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'English','Italian','Japanese','Mandarin','French','German'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-12 20:30:45.977905 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 20:30:45.978335 (Thread-1): finished collecting timing info
2020-08-12 20:30:45.978684 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: ROLLBACK
2020-08-12 20:30:45.979004 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: Close
2020-08-12 20:30:45.979625 (Thread-1): 16:30:45 | 1 of 5 PASS accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German [PASS in 0.07s]
2020-08-12 20:30:45.979926 (Thread-1): Finished running node test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German
2020-08-12 20:30:45.980164 (Thread-1): Began running node test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z
2020-08-12 20:30:45.980646 (Thread-1): 16:30:45 | 2 of 5 START test accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z [RUN]
2020-08-12 20:30:45.981267 (Thread-1): Acquiring new postgres connection "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z".
2020-08-12 20:30:45.981498 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:45.981695 (Thread-1): Compiling test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z
2020-08-12 20:30:46.019656 (Thread-1): Writing injected SQL for node "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z"
2020-08-12 20:30:46.020726 (Thread-1): finished collecting timing info
2020-08-12 20:30:46.021221 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z".
2020-08-12 20:30:46.021389 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: BEGIN
2020-08-12 20:30:46.030642 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:46.030882 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z".
2020-08-12 20:30:46.031007 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z"} */





with all_values as (

    select distinct
        last_initial as value_field

    from "dvd_rental"."dev"."customer_profile"

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-12 20:30:46.034844 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 20:30:46.035258 (Thread-1): finished collecting timing info
2020-08-12 20:30:46.035642 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: ROLLBACK
2020-08-12 20:30:46.035966 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: Close
2020-08-12 20:30:46.036528 (Thread-1): 16:30:46 | 2 of 5 PASS accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z [PASS in 0.06s]
2020-08-12 20:30:46.036743 (Thread-1): Finished running node test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z
2020-08-12 20:30:46.037012 (Thread-1): Began running node test.dbt_play.not_null_customer_profile_active
2020-08-12 20:30:46.037323 (Thread-1): 16:30:46 | 3 of 5 START test not_null_customer_profile_active................... [RUN]
2020-08-12 20:30:46.037764 (Thread-1): Acquiring new postgres connection "test.dbt_play.not_null_customer_profile_active".
2020-08-12 20:30:46.037888 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:46.038046 (Thread-1): Compiling test.dbt_play.not_null_customer_profile_active
2020-08-12 20:30:46.052158 (Thread-1): Writing injected SQL for node "test.dbt_play.not_null_customer_profile_active"
2020-08-12 20:30:46.052801 (Thread-1): finished collecting timing info
2020-08-12 20:30:46.053505 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_active".
2020-08-12 20:30:46.053719 (Thread-1): On test.dbt_play.not_null_customer_profile_active: BEGIN
2020-08-12 20:30:46.062739 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:46.062942 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_active".
2020-08-12 20:30:46.063055 (Thread-1): On test.dbt_play.not_null_customer_profile_active: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.not_null_customer_profile_active"} */




select count(*) as validation_errors
from "dvd_rental"."dev"."customer_profile"
where active is null


2020-08-12 20:30:46.065303 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 20:30:46.065854 (Thread-1): finished collecting timing info
2020-08-12 20:30:46.066473 (Thread-1): On test.dbt_play.not_null_customer_profile_active: ROLLBACK
2020-08-12 20:30:46.066846 (Thread-1): On test.dbt_play.not_null_customer_profile_active: Close
2020-08-12 20:30:46.067741 (Thread-1): 16:30:46 | 3 of 5 PASS not_null_customer_profile_active......................... [PASS in 0.03s]
2020-08-12 20:30:46.067996 (Thread-1): Finished running node test.dbt_play.not_null_customer_profile_active
2020-08-12 20:30:46.068282 (Thread-1): Began running node test.dbt_play.not_null_customer_profile_customer_id
2020-08-12 20:30:46.068674 (Thread-1): 16:30:46 | 4 of 5 START test not_null_customer_profile_customer_id.............. [RUN]
2020-08-12 20:30:46.069086 (Thread-1): Acquiring new postgres connection "test.dbt_play.not_null_customer_profile_customer_id".
2020-08-12 20:30:46.069304 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:46.069647 (Thread-1): Compiling test.dbt_play.not_null_customer_profile_customer_id
2020-08-12 20:30:46.080723 (Thread-1): Writing injected SQL for node "test.dbt_play.not_null_customer_profile_customer_id"
2020-08-12 20:30:46.081435 (Thread-1): finished collecting timing info
2020-08-12 20:30:46.081858 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_customer_id".
2020-08-12 20:30:46.082000 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: BEGIN
2020-08-12 20:30:46.091902 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:46.092196 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_customer_id".
2020-08-12 20:30:46.092464 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.not_null_customer_profile_customer_id"} */




select count(*) as validation_errors
from "dvd_rental"."dev"."customer_profile"
where customer_id is null


2020-08-12 20:30:46.094957 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 20:30:46.095414 (Thread-1): finished collecting timing info
2020-08-12 20:30:46.095721 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: ROLLBACK
2020-08-12 20:30:46.096040 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: Close
2020-08-12 20:30:46.096457 (Thread-1): 16:30:46 | 4 of 5 PASS not_null_customer_profile_customer_id.................... [PASS in 0.03s]
2020-08-12 20:30:46.096634 (Thread-1): Finished running node test.dbt_play.not_null_customer_profile_customer_id
2020-08-12 20:30:46.096911 (Thread-1): Began running node test.dbt_play.unique_customer_profile_customer_id
2020-08-12 20:30:46.097316 (Thread-1): 16:30:46 | 5 of 5 START test unique_customer_profile_customer_id................ [RUN]
2020-08-12 20:30:46.097850 (Thread-1): Acquiring new postgres connection "test.dbt_play.unique_customer_profile_customer_id".
2020-08-12 20:30:46.098130 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 20:30:46.098395 (Thread-1): Compiling test.dbt_play.unique_customer_profile_customer_id
2020-08-12 20:30:46.113183 (Thread-1): Writing injected SQL for node "test.dbt_play.unique_customer_profile_customer_id"
2020-08-12 20:30:46.113769 (Thread-1): finished collecting timing info
2020-08-12 20:30:46.114160 (Thread-1): Using postgres connection "test.dbt_play.unique_customer_profile_customer_id".
2020-08-12 20:30:46.114271 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: BEGIN
2020-08-12 20:30:46.125172 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 20:30:46.125529 (Thread-1): Using postgres connection "test.dbt_play.unique_customer_profile_customer_id".
2020-08-12 20:30:46.125752 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.unique_customer_profile_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from "dvd_rental"."dev"."customer_profile"
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-08-12 20:30:46.129038 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 20:30:46.129432 (Thread-1): finished collecting timing info
2020-08-12 20:30:46.129755 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: ROLLBACK
2020-08-12 20:30:46.130408 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: Close
2020-08-12 20:30:46.131774 (Thread-1): 16:30:46 | 5 of 5 PASS unique_customer_profile_customer_id...................... [PASS in 0.03s]
2020-08-12 20:30:46.132698 (Thread-1): Finished running node test.dbt_play.unique_customer_profile_customer_id
2020-08-12 20:30:46.229544 (MainThread): Acquiring new postgres connection "master".
2020-08-12 20:30:46.229900 (MainThread): Opening a new connection, currently in state closed
2020-08-12 20:30:46.230597 (MainThread): 16:30:46 | 
2020-08-12 20:30:46.230955 (MainThread): 16:30:46 | Finished running 5 tests in 1.09s.
2020-08-12 20:30:46.231263 (MainThread): Connection 'master' was properly closed.
2020-08-12 20:30:46.231426 (MainThread): Connection 'test.dbt_play.unique_customer_profile_customer_id' was properly closed.
2020-08-12 20:30:46.264984 (MainThread): 
2020-08-12 20:30:46.265357 (MainThread): Completed successfully
2020-08-12 20:30:46.265689 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-12 20:30:46.266084 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa145c10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa144623d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa145a8710>]}
2020-08-12 20:30:46.266567 (MainThread): Flushing usage events
2020-08-12 21:12:46.332080 (MainThread): Running with dbt=0.17.2
2020-08-12 21:12:46.423743 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-08-12 21:12:46.425745 (MainThread): Tracking: tracking
2020-08-12 21:12:46.446128 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa19ef94d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa19ef3b10>]}
2020-08-12 21:12:46.478296 (MainThread): Partial parsing not enabled
2020-08-12 21:12:46.481116 (MainThread): Parsing macros/core.sql
2020-08-12 21:12:46.487271 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 21:12:46.498428 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 21:12:46.500802 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 21:12:46.523521 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 21:12:46.563072 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 21:12:46.592123 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 21:12:46.594615 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 21:12:46.602944 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 21:12:46.621749 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 21:12:46.631058 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 21:12:46.639374 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 21:12:46.645625 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 21:12:46.646973 (MainThread): Parsing macros/etc/query.sql
2020-08-12 21:12:46.648338 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 21:12:46.650635 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 21:12:46.663539 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 21:12:46.666382 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 21:12:46.668698 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 21:12:46.736291 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 21:12:46.737754 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 21:12:46.738857 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 21:12:46.740171 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 21:12:46.742965 (MainThread): Parsing macros/catalog.sql
2020-08-12 21:12:46.745821 (MainThread): Parsing macros/relations.sql
2020-08-12 21:12:46.747903 (MainThread): Parsing macros/adapters.sql
2020-08-12 21:12:46.782246 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 21:12:46.806090 (MainThread): Partial parsing not enabled
2020-08-12 21:12:46.849363 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:46.849545 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:46.889808 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 21:12:46.890007 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:46.901311 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:46.901484 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:46.913293 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:46.913500 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:46.925897 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:46.926083 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:46.940118 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:46.940296 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:46.955418 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:46.955699 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:46.969513 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:46.969686 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:46.984088 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:46.984266 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:46.998152 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:46.998351 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:47.298848 (MainThread): Found 10 models, 5 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 21:12:47.300934 (MainThread): 
2020-08-12 21:12:47.301416 (MainThread): Acquiring new postgres connection "master".
2020-08-12 21:12:47.301568 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:47.320360 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dvd_rental".
2020-08-12 21:12:47.320873 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-08-12 21:12:47.342365 (ThreadPoolExecutor-0_0): Using postgres connection "list_dvd_rental".
2020-08-12 21:12:47.342571 (ThreadPoolExecutor-0_0): On list_dvd_rental: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental"} */

    select distinct nspname from pg_namespace
  
2020-08-12 21:12:47.358070 (ThreadPoolExecutor-0_0): SQL status: SELECT 7 in 0.02 seconds
2020-08-12 21:12:47.361514 (ThreadPoolExecutor-0_0): On list_dvd_rental: Close
2020-08-12 21:12:47.387449 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 21:12:47.387710 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2020-08-12 21:12:47.394236 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 21:12:47.394415 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 21:12:47.402330 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 21:12:47.402523 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 21:12:47.402637 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 21:12:47.406570 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2020-08-12 21:12:47.415333 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 21:12:47.415678 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 21:12:47.441191 (MainThread): Using postgres connection "master".
2020-08-12 21:12:47.441366 (MainThread): On master: BEGIN
2020-08-12 21:12:47.448794 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 21:12:47.448992 (MainThread): Using postgres connection "master".
2020-08-12 21:12:47.449110 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 21:12:47.840354 (MainThread): SQL status: SELECT 55 in 0.39 seconds
2020-08-12 21:12:47.909742 (MainThread): On master: ROLLBACK
2020-08-12 21:12:47.910207 (MainThread): Using postgres connection "master".
2020-08-12 21:12:47.910354 (MainThread): On master: BEGIN
2020-08-12 21:12:47.910718 (MainThread): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:47.910970 (MainThread): On master: COMMIT
2020-08-12 21:12:47.911096 (MainThread): Using postgres connection "master".
2020-08-12 21:12:47.911195 (MainThread): On master: COMMIT
2020-08-12 21:12:47.911466 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 21:12:47.911621 (MainThread): On master: Close
2020-08-12 21:12:47.912007 (MainThread): 17:12:47 | Concurrency: 1 threads (target='dev')
2020-08-12 21:12:47.912374 (MainThread): 17:12:47 | 
2020-08-12 21:12:47.914393 (Thread-1): Began running node model.dbt_play.rental_payment
2020-08-12 21:12:47.915682 (Thread-1): 17:12:47 | 1 of 10 START view model dev.rental_payment.......................... [RUN]
2020-08-12 21:12:47.916077 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:47.916196 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:47.916319 (Thread-1): Compiling model.dbt_play.rental_payment
2020-08-12 21:12:47.952421 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_payment"
2020-08-12 21:12:47.954259 (Thread-1): finished collecting timing info
2020-08-12 21:12:47.995289 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:47.995483 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_tmp" cascade
2020-08-12 21:12:48.003423 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 21:12:48.006347 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:48.006515 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 21:12:48.006866 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.015658 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_payment"
2020-08-12 21:12:48.016651 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:48.016863 (Thread-1): On model.dbt_play.rental_payment: BEGIN
2020-08-12 21:12:48.017427 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:48.017635 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:48.017763 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */

  create view "dvd_rental"."dev"."rental_payment__dbt_tmp" as (
    with rental_payment as(
    SELECT 
        rental_id, 
        sum(amount) as amount 
    FROM dvd_rental.public.payment 
    GROUP BY rental_id
)

SELECT * FROM rental_payment
  );

2020-08-12 21:12:48.023615 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 21:12:48.032694 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:48.033053 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment" rename to "rental_payment__dbt_backup"
2020-08-12 21:12:48.033607 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.036235 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:48.036376 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
alter table "dvd_rental"."dev"."rental_payment__dbt_tmp" rename to "rental_payment"
2020-08-12 21:12:48.036991 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.044815 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 21:12:48.045000 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:48.045103 (Thread-1): On model.dbt_play.rental_payment: COMMIT
2020-08-12 21:12:48.046029 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 21:12:48.050211 (Thread-1): Using postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:48.050401 (Thread-1): On model.dbt_play.rental_payment: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_payment"} */
drop view if exists "dvd_rental"."dev"."rental_payment__dbt_backup" cascade
2020-08-12 21:12:48.053966 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.057370 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.058037 (Thread-1): On model.dbt_play.rental_payment: Close
2020-08-12 21:12:48.059213 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a698ed0>]}
2020-08-12 21:12:48.061481 (Thread-1): 17:12:48 | 1 of 10 OK created view model dev.rental_payment..................... [CREATE VIEW in 0.14s]
2020-08-12 21:12:48.061819 (Thread-1): Finished running node model.dbt_play.rental_payment
2020-08-12 21:12:48.062077 (Thread-1): Began running node model.dbt_play.customer
2020-08-12 21:12:48.064860 (Thread-1): 17:12:48 | 2 of 10 START view model dev.customer................................ [RUN]
2020-08-12 21:12:48.065444 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 21:12:48.065640 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:48.065818 (Thread-1): Compiling model.dbt_play.customer
2020-08-12 21:12:48.076496 (Thread-1): Writing injected SQL for node "model.dbt_play.customer"
2020-08-12 21:12:48.079890 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.088503 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 21:12:48.088778 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_tmp" cascade
2020-08-12 21:12:48.113118 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 21:12:48.115809 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 21:12:48.116088 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 21:12:48.116846 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.118548 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer"
2020-08-12 21:12:48.119182 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 21:12:48.119483 (Thread-1): On model.dbt_play.customer: BEGIN
2020-08-12 21:12:48.119851 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:48.119992 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 21:12:48.120099 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */

  create view "dvd_rental"."dev"."customer__dbt_tmp" as (
    with customer as (
    SELECT
        a.customer_id,
        a.active,
        a.last_name,
        c.city,
        d.country
    FROM dvd_rental.public.customer a
    INNER JOIN dvd_rental.public.address b ON a.address_id = b.address_id
    INNER JOIN dvd_rental.public.city c ON b.city_id = c.city_id
    INNER JOIN dvd_rental.public.country d ON c.country_id = d.country_id
)

SELECT * FROM customer
  );

2020-08-12 21:12:48.132184 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 21:12:48.136800 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 21:12:48.136992 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer" rename to "customer__dbt_backup"
2020-08-12 21:12:48.137673 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.140901 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 21:12:48.141165 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
alter table "dvd_rental"."dev"."customer__dbt_tmp" rename to "customer"
2020-08-12 21:12:48.141798 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.143071 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 21:12:48.143223 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 21:12:48.143321 (Thread-1): On model.dbt_play.customer: COMMIT
2020-08-12 21:12:48.148681 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 21:12:48.150868 (Thread-1): Using postgres connection "model.dbt_play.customer".
2020-08-12 21:12:48.151155 (Thread-1): On model.dbt_play.customer: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer"} */
drop view if exists "dvd_rental"."dev"."customer__dbt_backup" cascade
2020-08-12 21:12:48.152858 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.156159 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.156696 (Thread-1): On model.dbt_play.customer: Close
2020-08-12 21:12:48.157787 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a6ffe50>]}
2020-08-12 21:12:48.159333 (Thread-1): 17:12:48 | 2 of 10 OK created view model dev.customer........................... [CREATE VIEW in 0.09s]
2020-08-12 21:12:48.159540 (Thread-1): Finished running node model.dbt_play.customer
2020-08-12 21:12:48.159721 (Thread-1): Began running node model.dbt_play.customer_life_time_value
2020-08-12 21:12:48.160837 (Thread-1): 17:12:48 | 3 of 10 START view model dev.customer_life_time_value................ [RUN]
2020-08-12 21:12:48.161235 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:48.161407 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:48.161529 (Thread-1): Compiling model.dbt_play.customer_life_time_value
2020-08-12 21:12:48.167103 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 21:12:48.167850 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.179470 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:48.180226 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" cascade
2020-08-12 21:12:48.196540 (Thread-1): SQL status: DROP VIEW in 0.02 seconds
2020-08-12 21:12:48.200898 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:48.201094 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 21:12:48.201451 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.202820 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_life_time_value"
2020-08-12 21:12:48.203580 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:48.203731 (Thread-1): On model.dbt_play.customer_life_time_value: BEGIN
2020-08-12 21:12:48.204122 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:48.204258 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:48.204371 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */

  create view "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" as (
    with customer_life_time_value as (
    SELECT
        customer_id,
        sum(amount) AS life_time_value
    FROM dvd_rental.public.payment
    GROUP BY customer_id
)

SELECT * FROM customer_life_time_value
  );

2020-08-12 21:12:48.220073 (Thread-1): SQL status: CREATE VIEW in 0.02 seconds
2020-08-12 21:12:48.295264 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:48.295555 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value" rename to "customer_life_time_value__dbt_backup"
2020-08-12 21:12:48.298226 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.302987 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:48.303179 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
alter table "dvd_rental"."dev"."customer_life_time_value__dbt_tmp" rename to "customer_life_time_value"
2020-08-12 21:12:48.303740 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.305106 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 21:12:48.305238 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:48.305337 (Thread-1): On model.dbt_play.customer_life_time_value: COMMIT
2020-08-12 21:12:48.306604 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 21:12:48.308493 (Thread-1): Using postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:48.308631 (Thread-1): On model.dbt_play.customer_life_time_value: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_life_time_value"} */
drop view if exists "dvd_rental"."dev"."customer_life_time_value__dbt_backup" cascade
2020-08-12 21:12:48.309900 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.312653 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.312964 (Thread-1): On model.dbt_play.customer_life_time_value: Close
2020-08-12 21:12:48.313788 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa19f039d0>]}
2020-08-12 21:12:48.315252 (Thread-1): 17:12:48 | 3 of 10 OK created view model dev.customer_life_time_value........... [CREATE VIEW in 0.15s]
2020-08-12 21:12:48.315471 (Thread-1): Finished running node model.dbt_play.customer_life_time_value
2020-08-12 21:12:48.315704 (Thread-1): Began running node model.dbt_play.customer_rental_summary
2020-08-12 21:12:48.316885 (Thread-1): 17:12:48 | 4 of 10 START view model dev.customer_rental_summary................. [RUN]
2020-08-12 21:12:48.317325 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:48.317476 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:48.317599 (Thread-1): Compiling model.dbt_play.customer_rental_summary
2020-08-12 21:12:48.324532 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 21:12:48.325579 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.335554 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:48.335871 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" cascade
2020-08-12 21:12:48.347090 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 21:12:48.351188 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:48.351484 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 21:12:48.354622 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.357368 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rental_summary"
2020-08-12 21:12:48.359143 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:48.359816 (Thread-1): On model.dbt_play.customer_rental_summary: BEGIN
2020-08-12 21:12:48.361917 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:48.362928 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:48.364634 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */

  create view "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" as (
    with customer_rental_summary as (
    SELECT 
        customer_id, 
        min(rental_date) as first_rental, 
        max(rental_date) as last_rental,
        count(*) as num_rental,
        date_part('day', max(rental_date) - min(rental_date)) as period_days,
        date_part('day', max(rental_date) - min(rental_date)) / 7 as period_weeks,
        date_part('day', max(rental_date) - min(rental_date)) / 30.4 as period_months,
        date_part('day', max(rental_date) - min(rental_date)) / 365 as period_years
    FROM dvd_rental.public.rental
    GROUP BY customer_id
)

SELECT * FROM customer_rental_summary
  );

2020-08-12 21:12:48.371619 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 21:12:48.377851 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:48.378301 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary" rename to "customer_rental_summary__dbt_backup"
2020-08-12 21:12:48.380028 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.383715 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:48.383928 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
alter table "dvd_rental"."dev"."customer_rental_summary__dbt_tmp" rename to "customer_rental_summary"
2020-08-12 21:12:48.384531 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.385808 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 21:12:48.385950 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:48.386051 (Thread-1): On model.dbt_play.customer_rental_summary: COMMIT
2020-08-12 21:12:48.386791 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 21:12:48.388806 (Thread-1): Using postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:48.388950 (Thread-1): On model.dbt_play.customer_rental_summary: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rental_summary"} */
drop view if exists "dvd_rental"."dev"."customer_rental_summary__dbt_backup" cascade
2020-08-12 21:12:48.390646 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.393494 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.393791 (Thread-1): On model.dbt_play.customer_rental_summary: Close
2020-08-12 21:12:48.394548 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a34cdd0>]}
2020-08-12 21:12:48.396689 (Thread-1): 17:12:48 | 4 of 10 OK created view model dev.customer_rental_summary............ [CREATE VIEW in 0.08s]
2020-08-12 21:12:48.397070 (Thread-1): Finished running node model.dbt_play.customer_rental_summary
2020-08-12 21:12:48.397354 (Thread-1): Began running node model.dbt_play.rental_details
2020-08-12 21:12:48.399508 (Thread-1): 17:12:48 | 5 of 10 START view model dev.rental_details.......................... [RUN]
2020-08-12 21:12:48.400393 (Thread-1): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:48.400621 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:48.400794 (Thread-1): Compiling model.dbt_play.rental_details
2020-08-12 21:12:48.419913 (Thread-1): Writing injected SQL for node "model.dbt_play.rental_details"
2020-08-12 21:12:48.420772 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.455234 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:48.455488 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_tmp" cascade
2020-08-12 21:12:48.487884 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2020-08-12 21:12:48.491317 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:48.491622 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 21:12:48.492359 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.495855 (Thread-1): Writing runtime SQL for node "model.dbt_play.rental_details"
2020-08-12 21:12:48.496587 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:48.496710 (Thread-1): On model.dbt_play.rental_details: BEGIN
2020-08-12 21:12:48.497151 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:48.497335 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:48.497453 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */

  create view "dvd_rental"."dev"."rental_details__dbt_tmp" as (
    with rental_payment as (
    SELECT * FROM "dvd_rental"."dev"."rental_payment"
),
rental_details as(
    SELECT
        r.rental_id,
        r.customer_id,
        r.rental_date,
        CASE WHEN r.return_date is null THEN FALSE ELSE TRUE END as returned,
        CASE WHEN date_part('day', return_date - rental_date) > f.rental_duration THEN TRUE ELSE FALSE END as late,
        CASE WHEN rental_payment.amount is null THEN FALSE WHEN rental_payment.amount <= 0 THEN FALSE ELSE TRUE END as paid,
        f.title as film_title,
        f.rating as film_rating,
        l.name as film_language,
        c.name as film_category,
        CASE WHEN rental_payment.amount is null THEN 0 ELSE rental_payment.amount END as payment_amount
    FROM dvd_rental.public.rental r
    INNER JOIN dvd_rental.public.inventory i ON r.inventory_id = i.inventory_id
    INNER JOIN dvd_rental.public.film f ON i.film_id = f.film_id
    INNER JOIN dvd_rental.public.language l ON f.language_id = l.language_id
    INNER JOIN dvd_rental.public.film_category fc ON f.film_id = fc.film_id
    INNER JOIN dvd_rental.public.category c ON fc.category_id = c.category_id
    LEFT JOIN rental_payment ON r.rental_id = rental_payment.rental_id
)

SELECT * FROM rental_details
  );

2020-08-12 21:12:48.503835 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 21:12:48.506944 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:48.507140 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
alter table "dvd_rental"."dev"."rental_details__dbt_tmp" rename to "rental_details"
2020-08-12 21:12:48.508187 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.510063 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 21:12:48.510252 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:48.510422 (Thread-1): On model.dbt_play.rental_details: COMMIT
2020-08-12 21:12:48.516957 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 21:12:48.519754 (Thread-1): Using postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:48.519945 (Thread-1): On model.dbt_play.rental_details: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.rental_details"} */
drop view if exists "dvd_rental"."dev"."rental_details__dbt_backup" cascade
2020-08-12 21:12:48.520279 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.522849 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.523192 (Thread-1): On model.dbt_play.rental_details: Close
2020-08-12 21:12:48.523994 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a61bd90>]}
2020-08-12 21:12:48.525944 (Thread-1): 17:12:48 | 5 of 10 OK created view model dev.rental_details..................... [CREATE VIEW in 0.12s]
2020-08-12 21:12:48.526173 (Thread-1): Finished running node model.dbt_play.rental_details
2020-08-12 21:12:48.526842 (Thread-1): Began running node model.dbt_play.customer_behaviour
2020-08-12 21:12:48.528272 (Thread-1): 17:12:48 | 6 of 10 START view model dev.customer_behaviour...................... [RUN]
2020-08-12 21:12:48.528774 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:48.528932 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:48.529048 (Thread-1): Compiling model.dbt_play.customer_behaviour
2020-08-12 21:12:48.539922 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 21:12:48.541505 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.566417 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:48.566608 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_tmp" cascade
2020-08-12 21:12:48.577607 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 21:12:48.583716 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:48.583899 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 21:12:48.584549 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.586128 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_behaviour"
2020-08-12 21:12:48.586714 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:48.586832 (Thread-1): On model.dbt_play.customer_behaviour: BEGIN
2020-08-12 21:12:48.587146 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:48.587269 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:48.587365 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */

  create view "dvd_rental"."dev"."customer_behaviour__dbt_tmp" as (
    with rental_details as (
    SELECT 
        customer_id,
        returned,
        late, 
        paid
    FROM "dvd_rental"."dev"."rental_details"
),
customer_behaviour as(
    SELECT 
        customer_id, 
        sum(cast(returned as int)) as num_return, 
        sum(cast(late as int)) as num_late, 
        sum(cast(paid as int)) as num_paid 
    FROM rental_details 
    GROUP BY customer_id
)

SELECT * FROM customer_behaviour
  );

2020-08-12 21:12:48.596738 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2020-08-12 21:12:48.599770 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:48.599957 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
alter table "dvd_rental"."dev"."customer_behaviour__dbt_tmp" rename to "customer_behaviour"
2020-08-12 21:12:48.600699 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.602112 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 21:12:48.602264 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:48.602373 (Thread-1): On model.dbt_play.customer_behaviour: COMMIT
2020-08-12 21:12:48.609296 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 21:12:48.611981 (Thread-1): Using postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:48.612148 (Thread-1): On model.dbt_play.customer_behaviour: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_behaviour"} */
drop view if exists "dvd_rental"."dev"."customer_behaviour__dbt_backup" cascade
2020-08-12 21:12:48.612481 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.615590 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.615939 (Thread-1): On model.dbt_play.customer_behaviour: Close
2020-08-12 21:12:48.616772 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a3231d0>]}
2020-08-12 21:12:48.618671 (Thread-1): 17:12:48 | 6 of 10 OK created view model dev.customer_behaviour................. [CREATE VIEW in 0.09s]
2020-08-12 21:12:48.618899 (Thread-1): Finished running node model.dbt_play.customer_behaviour
2020-08-12 21:12:48.619125 (Thread-1): Began running node model.dbt_play.customer_language_preference
2020-08-12 21:12:48.620663 (Thread-1): 17:12:48 | 7 of 10 START view model dev.customer_language_preference............ [RUN]
2020-08-12 21:12:48.621190 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:48.621325 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:48.621455 (Thread-1): Compiling model.dbt_play.customer_language_preference
2020-08-12 21:12:48.630296 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 21:12:48.633120 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.646655 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:48.647151 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_tmp" cascade
2020-08-12 21:12:48.662366 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 21:12:48.665033 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:48.665216 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 21:12:48.665544 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.666975 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_language_preference"
2020-08-12 21:12:48.667617 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:48.667750 (Thread-1): On model.dbt_play.customer_language_preference: BEGIN
2020-08-12 21:12:48.668084 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:48.668202 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:48.668299 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */

  create view "dvd_rental"."dev"."customer_language_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_language_preference as (
    SELECT DISTINCT ON (customer_id)
        customer_id,
        film_language as language
    FROM rental_details
    GROUP BY customer_id, film_language
    ORDER BY customer_id ASC, COUNT(*) DESC
)

SELECT * FROM customer_language_preference
  );

2020-08-12 21:12:48.673026 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 21:12:48.678231 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:48.678754 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
alter table "dvd_rental"."dev"."customer_language_preference__dbt_tmp" rename to "customer_language_preference"
2020-08-12 21:12:48.681841 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.684564 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 21:12:48.684746 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:48.684848 (Thread-1): On model.dbt_play.customer_language_preference: COMMIT
2020-08-12 21:12:48.691276 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 21:12:48.693384 (Thread-1): Using postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:48.693522 (Thread-1): On model.dbt_play.customer_language_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_language_preference"} */
drop view if exists "dvd_rental"."dev"."customer_language_preference__dbt_backup" cascade
2020-08-12 21:12:48.693827 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.696909 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.697334 (Thread-1): On model.dbt_play.customer_language_preference: Close
2020-08-12 21:12:48.698076 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a360550>]}
2020-08-12 21:12:48.699460 (Thread-1): 17:12:48 | 7 of 10 OK created view model dev.customer_language_preference....... [CREATE VIEW in 0.08s]
2020-08-12 21:12:48.699732 (Thread-1): Finished running node model.dbt_play.customer_language_preference
2020-08-12 21:12:48.699940 (Thread-1): Began running node model.dbt_play.customer_category_preference
2020-08-12 21:12:48.701241 (Thread-1): 17:12:48 | 8 of 10 START view model dev.customer_category_preference............ [RUN]
2020-08-12 21:12:48.701674 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:48.701969 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:48.702123 (Thread-1): Compiling model.dbt_play.customer_category_preference
2020-08-12 21:12:48.711213 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_category_preference"
2020-08-12 21:12:48.713218 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.721895 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:48.722259 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_tmp" cascade
2020-08-12 21:12:48.735175 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2020-08-12 21:12:48.739187 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:48.741612 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_backup" cascade
2020-08-12 21:12:48.742218 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.745801 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_category_preference"
2020-08-12 21:12:48.746698 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:48.746871 (Thread-1): On model.dbt_play.customer_category_preference: BEGIN
2020-08-12 21:12:48.747235 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:48.747383 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:48.747485 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */

  create view "dvd_rental"."dev"."customer_category_preference__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_category_preference as (
    SELECT 
        customer_id, 
        film_category, 
        count(*) as number, 
        sum(payment_amount) as dollars 
    FROM rental_details 
    GROUP BY customer_id, film_category
    ORDER BY customer_id ASC, count(*) DESC
)

SELECT * FROM customer_category_preference
  );

2020-08-12 21:12:48.775822 (Thread-1): SQL status: CREATE VIEW in 0.03 seconds
2020-08-12 21:12:48.778958 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:48.779145 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
alter table "dvd_rental"."dev"."customer_category_preference__dbt_tmp" rename to "customer_category_preference"
2020-08-12 21:12:48.779735 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.781590 (Thread-1): On model.dbt_play.customer_category_preference: COMMIT
2020-08-12 21:12:48.781796 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:48.781942 (Thread-1): On model.dbt_play.customer_category_preference: COMMIT
2020-08-12 21:12:48.782563 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 21:12:48.784617 (Thread-1): Using postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:48.784838 (Thread-1): On model.dbt_play.customer_category_preference: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_category_preference"} */
drop view if exists "dvd_rental"."dev"."customer_category_preference__dbt_backup" cascade
2020-08-12 21:12:48.785315 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.788204 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.788584 (Thread-1): On model.dbt_play.customer_category_preference: Close
2020-08-12 21:12:48.789619 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a6225d0>]}
2020-08-12 21:12:48.791043 (Thread-1): 17:12:48 | 8 of 10 OK created view model dev.customer_category_preference....... [CREATE VIEW in 0.09s]
2020-08-12 21:12:48.791248 (Thread-1): Finished running node model.dbt_play.customer_category_preference
2020-08-12 21:12:48.791417 (Thread-1): Began running node model.dbt_play.customer_rating_preferences
2020-08-12 21:12:48.792550 (Thread-1): 17:12:48 | 9 of 10 START view model dev.customer_rating_preferences............. [RUN]
2020-08-12 21:12:48.792963 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:48.793099 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:48.793218 (Thread-1): Compiling model.dbt_play.customer_rating_preferences
2020-08-12 21:12:48.801616 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_rating_preferences"
2020-08-12 21:12:48.802758 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.815597 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:48.815863 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" cascade
2020-08-12 21:12:48.856127 (Thread-1): SQL status: DROP VIEW in 0.04 seconds
2020-08-12 21:12:48.860871 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:48.861098 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_backup" cascade
2020-08-12 21:12:48.861619 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.864425 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_rating_preferences"
2020-08-12 21:12:48.865121 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:48.865302 (Thread-1): On model.dbt_play.customer_rating_preferences: BEGIN
2020-08-12 21:12:48.865714 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:48.865897 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:48.866054 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */

  create view "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" as (
    with rental_details as (
    SELECT * FROM "dvd_rental"."dev"."rental_details"
),
customer_rating_preference as (
    SELECT 
        customer_id, 
        film_rating, 
        count(*) as number, 
        sum(payment_amount) as dollars 
    FROM rental_details 
    GROUP BY customer_id, film_rating
    ORDER BY customer_id ASC, count(*) DESC
)

SELECT * FROM customer_rating_preference
  );

2020-08-12 21:12:48.870480 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2020-08-12 21:12:48.874885 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:48.875082 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
alter table "dvd_rental"."dev"."customer_rating_preferences__dbt_tmp" rename to "customer_rating_preferences"
2020-08-12 21:12:48.876382 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:48.877907 (Thread-1): On model.dbt_play.customer_rating_preferences: COMMIT
2020-08-12 21:12:48.878074 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:48.878172 (Thread-1): On model.dbt_play.customer_rating_preferences: COMMIT
2020-08-12 21:12:48.890167 (Thread-1): SQL status: COMMIT in 0.01 seconds
2020-08-12 21:12:48.893039 (Thread-1): Using postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:48.893192 (Thread-1): On model.dbt_play.customer_rating_preferences: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_rating_preferences"} */
drop view if exists "dvd_rental"."dev"."customer_rating_preferences__dbt_backup" cascade
2020-08-12 21:12:48.893516 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2020-08-12 21:12:48.896428 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.896768 (Thread-1): On model.dbt_play.customer_rating_preferences: Close
2020-08-12 21:12:48.897488 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a66f090>]}
2020-08-12 21:12:48.899154 (Thread-1): 17:12:48 | 9 of 10 OK created view model dev.customer_rating_preferences........ [CREATE VIEW in 0.10s]
2020-08-12 21:12:48.899408 (Thread-1): Finished running node model.dbt_play.customer_rating_preferences
2020-08-12 21:12:48.899753 (Thread-1): Began running node model.dbt_play.customer_profile
2020-08-12 21:12:48.901547 (Thread-1): 17:12:48 | 10 of 10 START table model dev.customer_profile...................... [RUN]
2020-08-12 21:12:48.902186 (Thread-1): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:48.902385 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:48.902580 (Thread-1): Compiling model.dbt_play.customer_profile
2020-08-12 21:12:48.938054 (Thread-1): Writing injected SQL for node "model.dbt_play.customer_profile"
2020-08-12 21:12:48.939040 (Thread-1): finished collecting timing info
2020-08-12 21:12:48.979635 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:48.980245 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_tmp" cascade
2020-08-12 21:12:48.989955 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2020-08-12 21:12:48.992445 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:48.992580 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 21:12:48.992993 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 21:12:49.000033 (Thread-1): Writing runtime SQL for node "model.dbt_play.customer_profile"
2020-08-12 21:12:49.000668 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:49.000788 (Thread-1): On model.dbt_play.customer_profile: BEGIN
2020-08-12 21:12:49.001127 (Thread-1): SQL status: BEGIN in 0.00 seconds
2020-08-12 21:12:49.001241 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:49.001335 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */


  create  table "dvd_rental"."dev"."customer_profile__dbt_tmp"
  as (
    with customer as (
    SELECT * FROM "dvd_rental"."dev"."customer"
),
rental as (
    SELECT * FROM "dvd_rental"."dev"."customer_rental_summary"
),
ltv as (
    SELECT * FROM "dvd_rental"."dev"."customer_life_time_value"
),
lang as (
    SELECT * FROM "dvd_rental"."dev"."customer_language_preference"
),
behave as (
    SELECT *FROM "dvd_rental"."dev"."customer_behaviour"
),
customer_profile as (
    SELECT 
        customer.customer_id,
        customer.active,
        left(customer.last_name, 1) as last_initial,
        customer.city,
        customer.country,
        rental.first_rental,
        rental.last_rental,
        rental.period_days,
        ltv.life_time_value,
        rental.num_rental,
        behave.num_return,
        behave.num_late,
        behave.num_paid,
        lang.language
    FROM customer
    LEFT JOIN rental USING(customer_id)
    LEFT JOIN ltv USING(customer_id)
    LEFT JOIN lang USING(customer_id)
    LEFT JOIN behave USING(customer_id)
)

SELECT * FROM customer_profile
  );
2020-08-12 21:12:49.154604 (Thread-1): SQL status: SELECT 599 in 0.15 seconds
2020-08-12 21:12:49.159459 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:49.159637 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile" rename to "customer_profile__dbt_backup"
2020-08-12 21:12:49.160147 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2020-08-12 21:12:49.163103 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:49.163266 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
alter table "dvd_rental"."dev"."customer_profile__dbt_tmp" rename to "customer_profile"
2020-08-12 21:12:49.168578 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2020-08-12 21:12:49.170095 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 21:12:49.170235 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:49.170348 (Thread-1): On model.dbt_play.customer_profile: COMMIT
2020-08-12 21:12:49.171412 (Thread-1): SQL status: COMMIT in 0.00 seconds
2020-08-12 21:12:49.174072 (Thread-1): Using postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:49.174353 (Thread-1): On model.dbt_play.customer_profile: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "model.dbt_play.customer_profile"} */
drop table if exists "dvd_rental"."dev"."customer_profile__dbt_backup" cascade
2020-08-12 21:12:49.177490 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2020-08-12 21:12:49.180373 (Thread-1): finished collecting timing info
2020-08-12 21:12:49.180652 (Thread-1): On model.dbt_play.customer_profile: Close
2020-08-12 21:12:49.181420 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ef4269-0a20-4fd7-b49d-d0d844fc1e03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a735390>]}
2020-08-12 21:12:49.182655 (Thread-1): 17:12:49 | 10 of 10 OK created table model dev.customer_profile................. [SELECT 599 in 0.28s]
2020-08-12 21:12:49.182875 (Thread-1): Finished running node model.dbt_play.customer_profile
2020-08-12 21:12:49.278391 (MainThread): Acquiring new postgres connection "master".
2020-08-12 21:12:49.278661 (MainThread): Opening a new connection, currently in state closed
2020-08-12 21:12:49.278902 (MainThread): Using postgres connection "master".
2020-08-12 21:12:49.279013 (MainThread): On master: BEGIN
2020-08-12 21:12:49.288162 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 21:12:49.288370 (MainThread): On master: COMMIT
2020-08-12 21:12:49.288490 (MainThread): Using postgres connection "master".
2020-08-12 21:12:49.288693 (MainThread): On master: COMMIT
2020-08-12 21:12:49.289024 (MainThread): SQL status: COMMIT in 0.00 seconds
2020-08-12 21:12:49.289184 (MainThread): On master: Close
2020-08-12 21:12:49.289659 (MainThread): 17:12:49 | 
2020-08-12 21:12:49.289857 (MainThread): 17:12:49 | Finished running 9 view models, 1 table model in 1.99s.
2020-08-12 21:12:49.290044 (MainThread): Connection 'master' was properly closed.
2020-08-12 21:12:49.290185 (MainThread): Connection 'model.dbt_play.customer_profile' was properly closed.
2020-08-12 21:12:49.332771 (MainThread): 
2020-08-12 21:12:49.332972 (MainThread): Completed successfully
2020-08-12 21:12:49.333116 (MainThread): 
Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
2020-08-12 21:12:49.333324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a67de90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a66f090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1a622150>]}
2020-08-12 21:12:49.333564 (MainThread): Flushing usage events
2020-08-12 21:12:54.434330 (MainThread): Running with dbt=0.17.2
2020-08-12 21:12:54.518586 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/Users/sean/.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-08-12 21:12:54.519804 (MainThread): Tracking: tracking
2020-08-12 21:12:54.538357 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1439f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa1439f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10197d750>]}
2020-08-12 21:12:54.570412 (MainThread): Partial parsing not enabled
2020-08-12 21:12:54.573018 (MainThread): Parsing macros/core.sql
2020-08-12 21:12:54.579161 (MainThread): Parsing macros/materializations/helpers.sql
2020-08-12 21:12:54.589746 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2020-08-12 21:12:54.592002 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2020-08-12 21:12:54.613608 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2020-08-12 21:12:54.653836 (MainThread): Parsing macros/materializations/seed/seed.sql
2020-08-12 21:12:54.682036 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2020-08-12 21:12:54.684461 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2020-08-12 21:12:54.694159 (MainThread): Parsing macros/materializations/common/merge.sql
2020-08-12 21:12:54.714718 (MainThread): Parsing macros/materializations/table/table.sql
2020-08-12 21:12:54.723890 (MainThread): Parsing macros/materializations/view/view.sql
2020-08-12 21:12:54.731941 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2020-08-12 21:12:54.738446 (MainThread): Parsing macros/etc/get_custom_alias.sql
2020-08-12 21:12:54.739654 (MainThread): Parsing macros/etc/query.sql
2020-08-12 21:12:54.740928 (MainThread): Parsing macros/etc/is_incremental.sql
2020-08-12 21:12:54.742897 (MainThread): Parsing macros/etc/datetime.sql
2020-08-12 21:12:54.755540 (MainThread): Parsing macros/etc/get_custom_schema.sql
2020-08-12 21:12:54.758276 (MainThread): Parsing macros/etc/get_custom_database.sql
2020-08-12 21:12:54.761108 (MainThread): Parsing macros/adapters/common.sql
2020-08-12 21:12:54.831318 (MainThread): Parsing macros/schema_tests/relationships.sql
2020-08-12 21:12:54.832823 (MainThread): Parsing macros/schema_tests/not_null.sql
2020-08-12 21:12:54.834299 (MainThread): Parsing macros/schema_tests/unique.sql
2020-08-12 21:12:54.836134 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2020-08-12 21:12:54.841141 (MainThread): Parsing macros/catalog.sql
2020-08-12 21:12:54.845029 (MainThread): Parsing macros/relations.sql
2020-08-12 21:12:54.847249 (MainThread): Parsing macros/adapters.sql
2020-08-12 21:12:54.876281 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2020-08-12 21:12:54.899685 (MainThread): Partial parsing not enabled
2020-08-12 21:12:54.939882 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_profile".
2020-08-12 21:12:54.940058 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:54.980025 (MainThread): Acquiring new postgres connection "model.dbt_play.customer".
2020-08-12 21:12:54.980202 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:54.991950 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rental_summary".
2020-08-12 21:12:54.992117 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:55.004250 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_payment".
2020-08-12 21:12:55.004426 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:55.015605 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_life_time_value".
2020-08-12 21:12:55.015775 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:55.026996 (MainThread): Acquiring new postgres connection "model.dbt_play.rental_details".
2020-08-12 21:12:55.027163 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:55.040526 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_behaviour".
2020-08-12 21:12:55.040695 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:55.054570 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_language_preference".
2020-08-12 21:12:55.054742 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:55.069274 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_category_preference".
2020-08-12 21:12:55.069451 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:55.082963 (MainThread): Acquiring new postgres connection "model.dbt_play.customer_rating_preferences".
2020-08-12 21:12:55.083160 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:55.389949 (MainThread): Found 10 models, 5 tests, 0 snapshots, 0 analyses, 134 macros, 0 operations, 0 seed files, 0 sources
2020-08-12 21:12:55.391673 (MainThread): 
2020-08-12 21:12:55.392142 (MainThread): Acquiring new postgres connection "master".
2020-08-12 21:12:55.392290 (MainThread): Opening a new connection, currently in state init
2020-08-12 21:12:55.432729 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dvd_rental_dev".
2020-08-12 21:12:55.433216 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-08-12 21:12:55.452407 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 21:12:55.452589 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: BEGIN
2020-08-12 21:12:55.466010 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2020-08-12 21:12:55.466220 (ThreadPoolExecutor-1_0): Using postgres connection "list_dvd_rental_dev".
2020-08-12 21:12:55.466332 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "list_dvd_rental_dev"} */
select
      'dvd_rental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'dvd_rental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
2020-08-12 21:12:55.470008 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2020-08-12 21:12:55.482901 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: ROLLBACK
2020-08-12 21:12:55.483254 (ThreadPoolExecutor-1_0): On list_dvd_rental_dev: Close
2020-08-12 21:12:55.508782 (MainThread): Using postgres connection "master".
2020-08-12 21:12:55.508983 (MainThread): On master: BEGIN
2020-08-12 21:12:55.516202 (MainThread): SQL status: BEGIN in 0.01 seconds
2020-08-12 21:12:55.516380 (MainThread): Using postgres connection "master".
2020-08-12 21:12:55.516481 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2020-08-12 21:12:55.902220 (MainThread): SQL status: SELECT 55 in 0.39 seconds
2020-08-12 21:12:55.966795 (MainThread): On master: ROLLBACK
2020-08-12 21:12:55.967198 (MainThread): On master: Close
2020-08-12 21:12:55.967740 (MainThread): 17:12:55 | Concurrency: 1 threads (target='dev')
2020-08-12 21:12:55.967940 (MainThread): 17:12:55 | 
2020-08-12 21:12:55.969887 (Thread-1): Began running node test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German
2020-08-12 21:12:55.970163 (Thread-1): 17:12:55 | 1 of 5 START test accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German [RUN]
2020-08-12 21:12:55.970628 (Thread-1): Acquiring new postgres connection "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German".
2020-08-12 21:12:55.970774 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:55.970907 (Thread-1): Compiling test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German
2020-08-12 21:12:56.003724 (Thread-1): Writing injected SQL for node "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German"
2020-08-12 21:12:56.005162 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.005810 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German".
2020-08-12 21:12:56.006023 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: BEGIN
2020-08-12 21:12:56.033373 (Thread-1): SQL status: BEGIN in 0.03 seconds
2020-08-12 21:12:56.034115 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German".
2020-08-12 21:12:56.034472 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German"} */





with all_values as (

    select distinct
        language as value_field

    from "dvd_rental"."dev"."customer_profile"

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'English','Italian','Japanese','Mandarin','French','German'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-12 21:12:56.036629 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 21:12:56.037007 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.037346 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: ROLLBACK
2020-08-12 21:12:56.037605 (Thread-1): On test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German: Close
2020-08-12 21:12:56.038121 (Thread-1): 17:12:56 | 1 of 5 PASS accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German [PASS in 0.07s]
2020-08-12 21:12:56.038306 (Thread-1): Finished running node test.dbt_play.accepted_values_customer_profile_language__English__Italian__Japanese__Mandarin__French__German
2020-08-12 21:12:56.038546 (Thread-1): Began running node test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z
2020-08-12 21:12:56.038884 (Thread-1): 17:12:56 | 2 of 5 START test accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z [RUN]
2020-08-12 21:12:56.039377 (Thread-1): Acquiring new postgres connection "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z".
2020-08-12 21:12:56.039579 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:56.039713 (Thread-1): Compiling test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z
2020-08-12 21:12:56.076250 (Thread-1): Writing injected SQL for node "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z"
2020-08-12 21:12:56.076997 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.077467 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z".
2020-08-12 21:12:56.077600 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: BEGIN
2020-08-12 21:12:56.088856 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 21:12:56.089041 (Thread-1): Using postgres connection "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z".
2020-08-12 21:12:56.089149 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z"} */





with all_values as (

    select distinct
        last_initial as value_field

    from "dvd_rental"."dev"."customer_profile"

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'
    )
)

select count(*) as validation_errors
from validation_errors


2020-08-12 21:12:56.091388 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 21:12:56.091693 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.092019 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: ROLLBACK
2020-08-12 21:12:56.092299 (Thread-1): On test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z: Close
2020-08-12 21:12:56.092825 (Thread-1): 17:12:56 | 2 of 5 PASS accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z [PASS in 0.05s]
2020-08-12 21:12:56.093034 (Thread-1): Finished running node test.dbt_play.accepted_values_customer_profile_last_initial__A__B__C__D__E__F__G__H__I__J__K__L__M__N__O__P__Q__R__S__T__U__V__W__X__Y__Z
2020-08-12 21:12:56.093287 (Thread-1): Began running node test.dbt_play.not_null_customer_profile_active
2020-08-12 21:12:56.093569 (Thread-1): 17:12:56 | 3 of 5 START test not_null_customer_profile_active................... [RUN]
2020-08-12 21:12:56.094004 (Thread-1): Acquiring new postgres connection "test.dbt_play.not_null_customer_profile_active".
2020-08-12 21:12:56.094145 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:56.094380 (Thread-1): Compiling test.dbt_play.not_null_customer_profile_active
2020-08-12 21:12:56.107673 (Thread-1): Writing injected SQL for node "test.dbt_play.not_null_customer_profile_active"
2020-08-12 21:12:56.108276 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.108612 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_active".
2020-08-12 21:12:56.108724 (Thread-1): On test.dbt_play.not_null_customer_profile_active: BEGIN
2020-08-12 21:12:56.121850 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 21:12:56.122033 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_active".
2020-08-12 21:12:56.122134 (Thread-1): On test.dbt_play.not_null_customer_profile_active: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.not_null_customer_profile_active"} */




select count(*) as validation_errors
from "dvd_rental"."dev"."customer_profile"
where active is null


2020-08-12 21:12:56.123565 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 21:12:56.123878 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.124223 (Thread-1): On test.dbt_play.not_null_customer_profile_active: ROLLBACK
2020-08-12 21:12:56.124493 (Thread-1): On test.dbt_play.not_null_customer_profile_active: Close
2020-08-12 21:12:56.124964 (Thread-1): 17:12:56 | 3 of 5 PASS not_null_customer_profile_active......................... [PASS in 0.03s]
2020-08-12 21:12:56.125166 (Thread-1): Finished running node test.dbt_play.not_null_customer_profile_active
2020-08-12 21:12:56.125424 (Thread-1): Began running node test.dbt_play.not_null_customer_profile_customer_id
2020-08-12 21:12:56.125733 (Thread-1): 17:12:56 | 4 of 5 START test not_null_customer_profile_customer_id.............. [RUN]
2020-08-12 21:12:56.126124 (Thread-1): Acquiring new postgres connection "test.dbt_play.not_null_customer_profile_customer_id".
2020-08-12 21:12:56.126243 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:56.126378 (Thread-1): Compiling test.dbt_play.not_null_customer_profile_customer_id
2020-08-12 21:12:56.147542 (Thread-1): Writing injected SQL for node "test.dbt_play.not_null_customer_profile_customer_id"
2020-08-12 21:12:56.148436 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.148959 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_customer_id".
2020-08-12 21:12:56.149077 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: BEGIN
2020-08-12 21:12:56.157124 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 21:12:56.157316 (Thread-1): Using postgres connection "test.dbt_play.not_null_customer_profile_customer_id".
2020-08-12 21:12:56.157420 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.not_null_customer_profile_customer_id"} */




select count(*) as validation_errors
from "dvd_rental"."dev"."customer_profile"
where customer_id is null


2020-08-12 21:12:56.158872 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 21:12:56.159159 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.159456 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: ROLLBACK
2020-08-12 21:12:56.159706 (Thread-1): On test.dbt_play.not_null_customer_profile_customer_id: Close
2020-08-12 21:12:56.160349 (Thread-1): 17:12:56 | 4 of 5 PASS not_null_customer_profile_customer_id.................... [PASS in 0.03s]
2020-08-12 21:12:56.160674 (Thread-1): Finished running node test.dbt_play.not_null_customer_profile_customer_id
2020-08-12 21:12:56.160994 (Thread-1): Began running node test.dbt_play.unique_customer_profile_customer_id
2020-08-12 21:12:56.161339 (Thread-1): 17:12:56 | 5 of 5 START test unique_customer_profile_customer_id................ [RUN]
2020-08-12 21:12:56.161855 (Thread-1): Acquiring new postgres connection "test.dbt_play.unique_customer_profile_customer_id".
2020-08-12 21:12:56.162259 (Thread-1): Opening a new connection, currently in state closed
2020-08-12 21:12:56.162525 (Thread-1): Compiling test.dbt_play.unique_customer_profile_customer_id
2020-08-12 21:12:56.174809 (Thread-1): Writing injected SQL for node "test.dbt_play.unique_customer_profile_customer_id"
2020-08-12 21:12:56.175356 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.176012 (Thread-1): Using postgres connection "test.dbt_play.unique_customer_profile_customer_id".
2020-08-12 21:12:56.176130 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: BEGIN
2020-08-12 21:12:56.184150 (Thread-1): SQL status: BEGIN in 0.01 seconds
2020-08-12 21:12:56.184361 (Thread-1): Using postgres connection "test.dbt_play.unique_customer_profile_customer_id".
2020-08-12 21:12:56.184480 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: /* {"app": "dbt", "dbt_version": "0.17.2", "profile_name": "dbt_play", "target_name": "dev", "node_id": "test.dbt_play.unique_customer_profile_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from "dvd_rental"."dev"."customer_profile"
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-08-12 21:12:56.189306 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2020-08-12 21:12:56.190033 (Thread-1): finished collecting timing info
2020-08-12 21:12:56.190387 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: ROLLBACK
2020-08-12 21:12:56.190737 (Thread-1): On test.dbt_play.unique_customer_profile_customer_id: Close
2020-08-12 21:12:56.191199 (Thread-1): 17:12:56 | 5 of 5 PASS unique_customer_profile_customer_id...................... [PASS in 0.03s]
2020-08-12 21:12:56.191384 (Thread-1): Finished running node test.dbt_play.unique_customer_profile_customer_id
2020-08-12 21:12:56.279144 (MainThread): Acquiring new postgres connection "master".
2020-08-12 21:12:56.279430 (MainThread): Opening a new connection, currently in state closed
2020-08-12 21:12:56.279929 (MainThread): 17:12:56 | 
2020-08-12 21:12:56.280202 (MainThread): 17:12:56 | Finished running 5 tests in 0.89s.
2020-08-12 21:12:56.280443 (MainThread): Connection 'master' was properly closed.
2020-08-12 21:12:56.280666 (MainThread): Connection 'test.dbt_play.unique_customer_profile_customer_id' was properly closed.
2020-08-12 21:12:56.303733 (MainThread): 
2020-08-12 21:12:56.303940 (MainThread): Completed successfully
2020-08-12 21:12:56.304136 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2020-08-12 21:12:56.304391 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa14a97090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa14bb3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xa14bb3f10>]}
2020-08-12 21:12:56.304618 (MainThread): Flushing usage events
